<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Pytorchæ¡†æ¶å­¦ä¹ æŒ‡å— | SLie's Blog|ç´å¼¦ä¹‹è½®</title><meta name="author" content="Slie"><meta name="copyright" content="Slie"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æœ¬æ–‡æ¡£å±ä¸ªäººè‡ªç”¨æŒ‡å—ï¼Œä»…æ¶‰åŠPytorchç›¸å…³ä½¿ç”¨å’Œè¯­æ³•ï¼Œä¸åŒ…å«å„ç±»æ¨¡å‹å…·ä½“å®ç°"><link rel="shortcut icon" href="/img/%E7%A3%81%E5%B8%A6.png"><link rel="canonical" href="https://qslie.top/posts/381270c2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/pluginsSrc/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,top_n_per_article:1,unescape:!1,languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}",hits_stats:"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},translate:void 0,noticeOutdate:{limitDay:90,position:"top",messagePrev:"æœ¬æ–‡ç« è·ç¦»ä¸Šæ¬¡ä¿®æ”¹å·²ç»è¿‡äº†",messageNext:"å¤©ï¼Œç›¸å…³å†…å®¹å¯èƒ½ä¸å†é€‚ç”¨ï¼Œè¯·ç•™æ„."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!0},runtime:"å¤©",dateSuffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"mediumZoom",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-center"},source:{justifiedGallery:{js:"/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js",css:"/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Pytorchæ¡†æ¶å­¦ä¹ æŒ‡å—",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-03-11 22:44:06"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/fixed_comment.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/twikoo_beautify.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s1.ax1x.com/2022/04/09/Likong.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">182</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">98</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">45</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>å£°å½±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/films/"><i class="fa-fw fas fa-video"></i> <span>æ˜ åƒ</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>å›¾ä¹¦</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202310081727970.png')"><nav id="nav"><span id="blog-info"><a href="/" title="SLie's Blog|ç´å¼¦ä¹‹è½®"><span class="site-name">SLie's Blog|ç´å¼¦ä¹‹è½®</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>å£°å½±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>ç›¸å†Œ</span></a></li><li><a class="site-page child" href="/films/"><i class="fa-fw fas fa-video"></i> <span>æ˜ åƒ</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>å›¾ä¹¦</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Pytorchæ¡†æ¶å­¦ä¹ æŒ‡å—</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-09-13T05:31:33.000Z" title="å‘è¡¨äº 2023-09-13 13:31:33">2023-09-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-03-11T14:44:06.525Z" title="æ›´æ–°äº 2024-03-11 22:44:06">2024-03-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF/">è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ </a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%BA%E7%94%9F%E8%8B%A6%E7%9F%AD%E3%81%AEPython/">äººç”Ÿè‹¦çŸ­ã®Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BA%BA%E7%94%9F%E8%8B%A6%E7%9F%AD%E3%81%AEPython/Pytorch/">Pytorch</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">8.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>34åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Pytorchæ¡†æ¶å­¦ä¹ æŒ‡å—"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img gist" style="background-image:url(https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202310081727970.png)"></div><article class="post-content" id="article-container"><h2 id="å®‰è£…ç¯å¢ƒ">å®‰è£…ç¯å¢ƒ</h2><blockquote><p>Pytorch çš„å®‰è£…å¯å‚è€ƒ<a target="_blank" rel="noopener" href="https://pytorch.org/get-started/locally/">å®˜æ–¹æ•™ç¨‹</a></p></blockquote><p>æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="built_in">print</span>(torch.__version__) <span class="comment">#æ³¨æ„æ˜¯åŒä¸‹åˆ’çº¿</span></span><br></pre></td></tr></table></figure><h3 id="Cuda">Cuda</h3><p><strong>ç»Ÿä¸€è®¡ç®—è®¾å¤‡æ¶æ„</strong>ï¼ˆCompute Unified Device Architecture,Â <strong>CUDA</strong>ï¼‰ï¼Œæ˜¯ç”±<strong>NVIDIA</strong>æ¨å‡ºçš„é€šç”¨å¹¶è¡Œè®¡ç®—æ¶æ„ã€‚é€šè¿‡Cudaï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è®¾å¤‡çš„GPUå®ç°æ›´é«˜æ•ˆçš„å¹¶è¡Œè®¡ç®—ã€‚</p><p>pytorchæ”¯æŒcudaï¼Œå› æ­¤æˆ‘ä»¬å¦‚æœæœ‰æ­¤éœ€æ±‚åˆ™éœ€è¦ä¸ºæˆ‘ä»¬çš„è®¾å¤‡å®‰è£…cudaã€‚</p><p>ä½¿â½¤ <code>nvidia-smi</code> å‘½ä»¤æŸ¥çœ‹å½“å‰Cudaç‰ˆæœ¬ã€‚é€šè¿‡å¦‚ä¸‹ä»£ç æ£€éªŒGPUæ˜¯å¦å¯ç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="built_in">print</span>(torch.version.cuda)</span><br><span class="line"><span class="built_in">print</span>(torch.cuda.is_available())</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šPyTorchçš„å®‰è£…ç‰ˆæœ¬éœ€è¦ä¸ç³»ç»Ÿçš„ Cuda ç‰ˆæœ¬ç›¸åŒ¹é…ï¼Œè§å®˜æ–¹ç½‘ç«™ï¼š<a target="_blank" rel="noopener" href="https://pytorch.org/get-started/previous-versions/">Previous PyTorch Versions | PyTorch</a>ã€‚</p><div class="note default modern"><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/AirCL/p/16963463.html">ã€CUDAã€‘windowsä¸‹çš„CUDAå®‰è£… - AirCL - åšå®¢å›­</a></p><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/75956626/pytorch-installation-for-cuda-12-on-win10-64-bit">è§£å†³ CUDA 12 ç‰ˆæœ¬æ—  stable å®‰è£…é€”å¾„é—®é¢˜ - Stack Overflow</a></p></div><h2 id="Tensors">Tensors</h2><p>Tensorsï¼Œè¯‘ä¸º<strong>å¼ é‡</strong>ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå®ƒåœ¨ç»“æ„ä¸Šå’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> ç»´æ•°ç»„ååˆ†ç›¸ä¼¼ã€‚</p><p>å…·æœ‰â¼€ä¸ªè½´çš„å¼ é‡å¯¹åº”æ•°å­¦ä¸Šçš„å‘é‡ï¼ˆvectorï¼‰ï¼›å…·æœ‰ä¸¤ä¸ªè½´çš„å¼ é‡å¯¹åº”æ•°å­¦ä¸Šçš„çŸ©é˜µï¼ˆmatrixï¼‰ï¼›å…·æœ‰ä¸¤ä¸ªè½´ä»¥ä¸Šçš„å¼ é‡æ²¡æœ‰ç‰¹æ®Šçš„æ•°å­¦åç§°ã€‚</p><p>åœ¨ Pytorch ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ Tensors æ¥ç»™æ¨¡å‹çš„è¾“å…¥è¾“å‡ºä»¥åŠå‚æ•°è¿›è¡Œç¼–ç ï¼Œè¿˜å¯ä»¥è·Ÿè¸ªè®¡ç®—å›¾å’Œè®¡ç®—æ¢¯åº¦ï¼Œå¯ä»¥åœ¨ GPU æˆ–å…¶ä»–ä¸“ç”¨ç¡¬ä»¶ä¸Šè¿è¡Œä»è€ŒåŠ é€Ÿè®¡ç®—ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒçš„å…¶ä»–ç”¨æ³•åŸºæœ¬ç±»ä¼¼äº Numpy ä¸­çš„ ndarraysã€‚</p><h3 id="åˆ›å»º-Tensor">åˆ›å»º Tensor</h3><h4 id="ç›´æ¥åˆ›å»º">ç›´æ¥åˆ›å»º</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">torch.arange(n) <span class="comment"># åˆ›å»ºå…ƒç´ å†…å®¹ä¾æ¬¡æ˜¯ 0~n çš„1då‘é‡</span></span><br><span class="line">torch.zeros((m, n, l)) <span class="comment"># åˆ›å»º mÃ—nÃ—l å¤§å°çš„å…¨0å¼ é‡</span></span><br><span class="line">torch.ones((m, n, l)) <span class="comment"># åˆ›å»º mÃ—nÃ—l å¤§å°çš„å…¨1å¼ é‡</span></span><br><span class="line">torch.randn(m,n) <span class="comment"># åˆ›å»º mÃ—n å¤§å°çš„å¼ é‡, æ¯ä¸ªå…ƒç´ æœä»äºN(0,1)æ ‡å‡†â¾¼æ–¯åˆ†å¸ƒ</span></span><br><span class="line">torch.tensor([[<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]]) <span class="comment">#æ ¹æ®pythonåµŒå¥—åˆ—è¡¨ç›´æ¥åˆ›å»º</span></span><br></pre></td></tr></table></figure><h4 id="ä»Numpyä¸­åˆ›å»º">ä»Numpyä¸­åˆ›å»º</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">a = torch.from_numpy(x) <span class="comment"># è·Ÿéš numpy</span></span><br><span class="line">b = torch.Tensor(x) <span class="comment"># torch.Tensor()è¿”å›çš„æ˜¯Floatæ•°æ®ç±»å‹</span></span><br><span class="line">c = torch.tensor(x) <span class="comment"># torch.tensor()æ ¹æ®è¾“å…¥ç±»å‹ç”Ÿæˆç›¸åº”ç±»å‹(ä¹Ÿæ”¯æŒpandasæ•°æ®)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note primary modern"><p>ğŸ§¬ <code>torch.Tensor()</code> æ˜¯é»˜è®¤å¼ é‡ç±»å‹ <code>torch.FloatTensor()</code> çš„åˆ«åï¼Œä¸å°å†™ <code>t</code> ä½œåŒºåˆ†</p><p>ğŸ¤– é»˜è®¤ç±»å‹ä¹Ÿå¯è¿›è¡Œè‡ªå®šä¹‰ä¿®æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.set_default_tensor_type(torch.DoubleTensor)</span><br></pre></td></tr></table></figure></div><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ <code>numpy()</code> æ–¹æ³• æŠŠ Tensor è½¬æ¢ä¸º numpy ç±»å‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numpy_array = x.numpy() <span class="comment"># å¦‚æœtensoråœ¨CPUä¸Š</span></span><br><span class="line">numpy_array = x.cpu.numpy() <span class="comment"># å¦‚æœtensoråœ¨GPUä¸Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(numpy_array)) <span class="comment"># è¾“å‡º ï¼š &lt;class &#x27;numpy.ndarray&#x27;&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å¯¼å‡º-åŠ è½½-Tensor">å¯¼å‡º&amp;åŠ è½½ Tensor</h3><p>PyTorchä¸­çš„ <code>Tensor</code> å¯ä»¥ä¿å­˜æˆ <code>.pt</code> æˆ–è€… <code>.pth</code> æ ¼å¼çš„æ–‡ä»¶ï¼Œä½¿ç”¨ <code>torch.save()</code>æ–¹æ³•ä¿å­˜å¼ é‡ï¼Œä½¿ç”¨ <code>torch.load()</code>æ¥è¯»å–å¼ é‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x = torch.rand(<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">torch.save(x, <span class="string">&quot;./myTensor.pt&quot;</span>)</span><br><span class="line"></span><br><span class="line">y = torch.load(<span class="string">&quot;./myTensor.pt&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br></pre></td></tr></table></figure><blockquote><p>æ›´å¤šï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38962621/article/details/111148636">PyTorchæ•™ç¨‹ï¼šPyTorchä¸­ä¿å­˜ä¸åŠ è½½tensorå’Œæ¨¡å‹è¯¦è§£</a></p></blockquote><h3 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦</h3><h4 id="æŒ‰å…ƒç´ è¿ç®—">æŒ‰å…ƒç´ è¿ç®—</h4><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨PyTorch Tensorsé‡Œï¼Œå½¢å¦‚ <code>X = X+Y</code> çš„ä»£ç å®é™…ä¸Šä¼šç”Ÿæˆæ–°çš„å¼•ç”¨æŒ‡å‘æ–°å¼€è¾Ÿçš„å†…å­˜ <code>X</code> ï¼Œæ—§ <code>X</code> ä¾ç„¶å­˜åœ¨ã€‚è€Œ <code>X += Y</code> æˆ– <code>X[:] = X+Y</code> åˆ™ç›´æ¥<strong>å¯¹åŸå†…å­˜æ•°æ®è¿›è¡Œæ›´æ–°</strong>ã€‚</p><p>å¯ä»¥ç”¨ <code>id()</code> å‡½æ•°è¿›è¡ŒéªŒè¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">X = torch.tensor([<span class="number">10</span>])</span><br><span class="line">Y = torch.tensor([<span class="number">10</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span>,<span class="built_in">id</span>(X))</span><br><span class="line">X = X + Y</span><br><span class="line"><span class="built_in">print</span>(<span class="number">2</span>,<span class="built_in">id</span>(X))</span><br><span class="line">X[:] = X + Y</span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span>,<span class="built_in">id</span>(X))</span><br><span class="line">X += Y</span><br><span class="line"><span class="built_in">print</span>(<span class="number">4</span>,<span class="built_in">id</span>(X))</span><br></pre></td></tr></table></figure><p>å…¶ä»–è¿ç®—ç¬¦ï¼Œå¦‚ <code>+, -, *, /</code> å’Œ <code>**</code> ä»¥åŠ <code>.exp(x)</code>ï¼Œå‡é»˜è®¤æ˜¯å¯¹å¼ é‡æŒ‰å…ƒç´ è¿›è¡Œè®¡ç®—ï¼ˆè€ŒéçŸ©é˜µæ„ä¹‰ä¸Šçš„ï¼‰ã€‚</p><h4 id="åˆ¤æ–­è¯­å¥">åˆ¤æ–­è¯­å¥</h4><p>ç±»ä¼¼äº <code>X == Y</code> è¿™æ ·çš„åˆ¤æ–­è¯­å¥ï¼Œåˆ™è¿”å›å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X,Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.22222em">Y</span></span></span></span> å½¢çŠ¶ä¸€æ ·çš„äºŒå€¼å¼ é‡ï¼Œåœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i=y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> çš„ä½ç½®å€¼ä¸º <code>True</code>ã€‚</p><h4 id="æ±‚å’Œè¿ç®—">æ±‚å’Œè¿ç®—</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">x = torch.arange(<span class="number">12</span>, dtype=torch.float32)</span><br><span class="line">y = x.clone() <span class="comment">#æ·±æ‹·è´/å¼€è¾Ÿæ–°å†…å­˜ç»™y, yçš„å†…å®¹ä¸xä¸€è‡´</span></span><br><span class="line">y.reshape(<span class="number">3</span>,<span class="number">4</span>) <span class="comment"># yçš„å½¢çŠ¶å˜ä¸º 3Ã—4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æ‰€æœ‰å…ƒç´ æ±‚å’Œï¼Œè¿”å›æ ‡é‡</span></span><br><span class="line">x.<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æŒ‡å®šç»“æœæ˜¯0è½´ï¼Œç›¸å½“äºæŒ‰åˆ—æ±‚å’Œï¼Œæ¯ä¸€å…ƒç´ æ˜¯yåŸæ¯ä¸€åˆ—çš„å…ƒç´ ä¹‹å’Œï¼Œæœ€ç»ˆæ„æˆè¡Œå‘é‡</span></span><br><span class="line">y.<span class="built_in">sum</span>(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æŒ‰è¡Œæ±‚å’Œï¼Œæ¯ä¸€å…ƒç´ æ˜¯yåŸæ¯ä¸€è¡Œçš„å…ƒç´ ä¹‹å’Œï¼Œæœ€ç»ˆæ„æˆåˆ—å‘é‡ï¼Œä½†åœ¨torchä¸­éƒ½æ˜¯1då¼ é‡</span></span><br><span class="line">y.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. ç­‰ä»·äº y.sum()</span></span><br><span class="line">y.<span class="built_in">sum</span>(axis=[<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. ä¿æŒç»´åº¦ä¸å˜/ä¸é™ç»´</span></span><br><span class="line">y.<span class="built_in">sum</span>(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. æŒ‰è½´ç´¯åŠ ä¸é™ç»´</span></span><br><span class="line">y.cumsum(axis=<span class="number">0</span>)  <span class="comment">#ç›¸å½“äºç¬¬äºŒè¡Œçš„å€¼=åŸç¬¬äºŒè¡Œ+åŸç¬¬ä¸€è¡Œï¼Œç¬¬ä¸‰è¡Œçš„å€¼ç›¸å½“äºåŸå‰ä¸‰è¡Œç´¯åŠ </span></span><br></pre></td></tr></table></figure><h4 id="å‡å€¼è®¡ç®—">å‡å€¼è®¡ç®—</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x.mean() <span class="comment"># è®¡ç®—å‡å€¼</span></span><br><span class="line"></span><br><span class="line">x.<span class="built_in">sum</span>() / x.numel() <span class="comment"># äºŒè€…ç­‰ä»·</span></span><br></pre></td></tr></table></figure><p>åŒæ ·ä¹Ÿå¯ä»¥æ ¹æ®æŒ‡å®šå‚æ•° <code>axis</code> çš„å€¼æ¥å®ç°æŒ‰æŸä¸€è½´ï¼ˆaxisï¼‰/ç»´åº¦ æ±‚å‡å€¼ã€‚</p><h4 id="å‘é‡ç‚¹ç§¯">å‘é‡ç‚¹ç§¯</h4><p>å‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> ä¸å‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6389em;vertical-align:-.1944em"></span><span class="mord mathbf" style="margin-right:.01597em">y</span></span></span></span> çš„ç‚¹ç§¯å¯ä»¥è¡¨ç¤ºä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">x</mi><mi>T</mi></msup><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf x^T\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0358em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathbf" style="margin-right:.01597em">y</span></span></span></span> æˆ–<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf x,\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathbf" style="margin-right:.01597em">y</span><span class="mclose">)</span></span></span></span>ã€‚åœ¨æ•°å€¼ä¸Šç›¸å½“äºäºŒè€…æŒ‰å…ƒç´ ç›¸ä¹˜å¹¶æ±‚å’Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.dot(x, y) <span class="comment"># ç­‰ä»·äº torch.sum(x * y)</span></span><br></pre></td></tr></table></figure><h4 id="çŸ©é˜µç›¸ä¹˜">çŸ©é˜µç›¸ä¹˜</h4><p>åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼ŒçŸ©é˜µä¸å‘é‡çš„ä¹˜ç§¯ å’Œ çŸ©é˜µä¸çŸ©é˜µçš„ä¹˜ç§¯ åˆ«æ— äºŒè‡´ã€‚ä¹Ÿæ˜¯å› ä¸ºçº¿æ€§ä»£æ•°é‡Œä¸€èˆ¬é»˜è®¤å‘é‡æ˜¯æŒ‡åˆ—å‘é‡ã€‚</p><p>è€Œåœ¨ Torch ä¸­ï¼Œæ‰€è°“å‘é‡å°±æ˜¯æŒ‡ä¸€ç»´å¼ é‡ï¼Œé»˜è®¤è½´ <code>axis=0</code>ï¼Œæ‰€ä»¥å¯ä»¥çœ‹ä½œâ€œè¡Œå‘é‡â€ã€‚å› æ­¤ï¼Œåœ¨ Torch ä¸­ç‹¬ç«‹å‡ºä¸€ä¸ªè¿ç®—æ–¹æ³•ç»™<strong>çŸ©é˜µä¸å‘é‡çš„ä¹˜ç§¯</strong>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">torch.mv(A, x)</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">A @ x</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè¿”å›çš„ä¾ç„¶æ˜¯ä¸€ç»´å¼ é‡ã€‚</p><p>è€Œä¸€èˆ¬çš„<strong>çŸ©é˜µä¹˜æ³•</strong>æ‰€ç”¨çš„è¯­å¥æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">torch.mm(A, B)</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">A @ B</span><br></pre></td></tr></table></figure><p>æ­¤å¤–è¿˜æœ‰ï¼š</p><ul><li><code>torch.mul(a, b)</code> æ˜¯çŸ©é˜µ <code>a</code> å’Œ <code>b</code> å¯¹åº”ä½ç›¸ä¹˜ï¼Œå³<strong>é˜¿è¾¾ç›ç§¯</strong>ï¼Œ<code>a</code>å’Œ<code>b</code>çš„å½¢çŠ¶å¿…é¡»ç›¸åŒï¼›</li><li><code>torch.bmm(a, b)</code> a batch matrix-matrix productï¼Œé’ˆå¯¹ä¸‰ç»´å¼ é‡ <code>a</code>å’Œ<code>b</code> ï¼Œè¦æ±‚å®ƒä»¬çš„ç¬¬0ç»´ï¼ˆ<code>dim=0</code>ï¼‰çš„å¤§å°ç›¸ç­‰â€”â€”æ‰¹æ¬¡å¤§å°ï¼Œç„¶å<strong>å‰©ä¸‹çš„ä¸¤ä¸ªç»´åº¦ä½œçŸ©é˜µä¹˜æ³•</strong>ã€‚<code>a (b,m,n) * b (b,n,l) -&gt; output (b,m,l)</code>ï¼›</li><li><code>torch.matmul()</code> æ²¡æœ‰å¼ºåˆ¶è§„å®šç»´åº¦å’Œå¤§å°ï¼Œå¯ä»¥ç”¨åˆ©ç”¨<strong>å¹¿æ’­æœºåˆ¶</strong>è¿›è¡Œä¸åŒç»´åº¦çš„ç›¸ä¹˜æ“ä½œ</li></ul><blockquote><p>è¯¦è§ï¼š<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e277f7fc67b3">torch.mul() ã€ torch.mm() åŠtorch.matmul()çš„åŒºåˆ« - ç®€ä¹¦</a></p></blockquote><h4 id="L2èŒƒæ•°">L2èŒƒæ•°</h4><p>Torch ä¸­æä¾›äº†ç›´æ¥è®¡ç®—å‘é‡/ä¸€ç»´å¼ é‡ çš„ L2èŒƒæ•°çš„æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.norm(x)</span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šï¼Œå¯¹äºçŸ©é˜µçš„FrobeniusèŒƒæ•°ï¼Œä¹ŸåŒæ ·é€‚ç”¨ï¼Œå³å¯ä»¥ä½¿ç”¨ <code>torch.norm(A)</code> è®¡ç®—çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> çš„FrobeniusèŒƒæ•°ã€‚</p><p>æ­¤å¤–ï¼Œæ ¹æ®L1èŒƒæ•°çš„å®šä¹‰ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ <code>torch.abs(x).sum()</code> æ¥è®¡ç®—å‘é‡çš„ L1èŒƒæ•°ã€‚</p><h3 id="ğŸ””è¿ç»“-æ‹¼æ¥">ğŸ””è¿ç»“/æ‹¼æ¥</h3><p>å’Œ <code>Pandas.DataFrame</code> ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå¤šä¸ªå¼ é‡è¿ç»“ï¼ˆconcatenateï¼‰åœ¨â¼€èµ·ï¼ŒæŠŠå®ƒä»¬ç«¯å¯¹ç«¯åœ°å èµ·æ¥å½¢æˆâ¼€ä¸ªæ›´â¼¤çš„å¼ é‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X = torch.arange(<span class="number">12</span>, dtype=torch.float32).reshape((<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">Y = torch.tensor([[<span class="number">2.0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">torch.cat((X, Y), dim=<span class="number">0</span>), torch.cat((X, Y), dim=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">output</span></span><br><span class="line"></span><br><span class="line">(tensor([[ 0., 1., 2., 3.],</span><br><span class="line">[ 4., 5., 6., 7.],</span><br><span class="line">[ 8., 9., 10., 11.],</span><br><span class="line">[ 2., 1., 4., 3.],</span><br><span class="line">[ 1., 2., 3., 4.],</span><br><span class="line">[ 4., 3., 2., 1.]]), #æŒ‰è¡Œæ‹¼æ¥/dim=0</span><br><span class="line"></span><br><span class="line">tensor([[ 0., 1., 2., 3., 2., 1., 4., 3.],</span><br><span class="line">[ 4., 5., 6., 7., 1., 2., 3., 4.],</span><br><span class="line">[ 8., 9., 10., 11., 4., 3., 2., 1.]])) #æŒ‰åˆ—æ‹¼æ¥/dim=1</span><br></pre></td></tr></table></figure><h3 id="ğŸ””ç»´åº¦è½¬æ¢">ğŸ””ç»´åº¦è½¬æ¢</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">squeeze</span><br><span class="line"></span><br><span class="line">unsqueeze</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ï¼ˆæ¨èï¼‰<strong>ä½¿ç”¨ <code>einops</code> åŒ…</strong></p><blockquote><p>å¾…æ›´ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37297763/article/details/120348764">https://blog.csdn.net/qq_37297763/article/details/120348764</a></p></blockquote><h2 id="è‡ªåŠ¨æ±‚å¯¼">è‡ªåŠ¨æ±‚å¯¼</h2><p>å‡è®¾æ¬²å¯¹å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>2</mn><msup><mi mathvariant="bold">x</mi><mi>T</mi></msup><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">y = 2\mathbf x^T\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8413em"></span><span class="mord">2</span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathbf">x</span></span></span></span> å…³äºåˆ—å‘é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> æ±‚å¯¼ã€‚<br>äº‹å®ä¸Šæˆ‘ä»¬å·²ç»æœ‰å…ˆéªŒçŸ¥è¯†äº†ï¼Œå³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ‡</mi><mi>y</mi><mo>=</mo><mn>4</mn><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\nabla y=4\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord">âˆ‡</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">4</span><span class="mord mathbf">x</span></span></span></span>ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨ Torch è¿›è¡ŒéªŒè¯å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">x = torch.arange(<span class="number">4.0</span>)</span><br><span class="line">x.requires_grad_(<span class="literal">True</span>) <span class="comment"># ç­‰ä»·äºx=torch.arange(4.0,requires_grad=True)</span></span><br><span class="line">y = <span class="number">2</span>*torch.dot(x, x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x.grad) <span class="comment"># å¼€å§‹æ—¶é»˜è®¤å€¼æ˜¯None</span></span><br><span class="line"></span><br><span class="line">y.backward() <span class="comment"># è°ƒâ½¤åå‘ä¼ æ’­å‡½æ•°æ¥â¾ƒåŠ¨è®¡ç®—yå…³äºxæ¯ä¸ªåˆ†é‡çš„æ¢¯åº¦</span></span><br><span class="line"><span class="built_in">print</span>(x.grad)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒPyTorchä¼šç´¯ç§¯æ¢¯åº¦ï¼Œæˆ‘ä»¬éœ€è¦æ¸…é™¤ä¹‹å‰çš„å€¼ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è®¡ç®—</span></span><br><span class="line">x.grad.zero_()</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘ä»¬è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> å…³äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> çš„æ¢¯åº¦ä¹‹å‰ï¼Œéœ€è¦â¼€ä¸ªåœ°â½…æ¥å­˜å‚¨æ¢¯åº¦ï¼š<code>x.requires_grad_(True)</code>ã€‚</p><p>é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨æ¯æ¬¡å¯¹â¼€ä¸ªå‚æ•°æ±‚å¯¼æ—¶éƒ½åˆ†é…æ–°çš„å†…å­˜ã€‚å› ä¸ºæˆ‘ä»¬ç»å¸¸ä¼šæˆåƒä¸Šä¸‡æ¬¡åœ°æ›´æ–°ç›¸åŒçš„å‚æ•°ï¼Œæ¯æ¬¡éƒ½åˆ†é…æ–°çš„å†…å­˜å¯èƒ½å¾ˆå¿«å°±ä¼šå°†å†…å­˜è€—å°½ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬è°ƒç”¨çš„æ˜¯å¸¦æœ‰ä¸‹åˆ’çº¿ <code>_</code> åç¼€çš„å‡½æ•°ï¼Œè¿™ç§å¯ä»¥æ”¹å˜ tensor å˜é‡çš„æ“ä½œéƒ½å¸¦æœ‰åç¼€ï¼Œä¾‹å¦‚Â <code>x.copy_(y), x.t_()</code>Â éƒ½å¯ä»¥ç›´æ¥åœ¨åŸå†…å­˜ä¸Šæ”¹å˜ <code>x</code> å˜é‡ã€‚</p><h3 id="éæ ‡é‡åå‘ä¼ æ’­">éæ ‡é‡åå‘ä¼ æ’­</h3><p>åœ¨PyTorchä¸­æœ‰ä¸ªç®€å•çš„è§„å®šï¼Œä¸è®©å¼ é‡å¯¹å¼ é‡æ±‚å¯¼ï¼Œåªå…è®¸æ ‡é‡å¯¹å¼ é‡æ±‚å¯¼ã€‚<br>å› æ­¤ï¼Œç›®æ ‡é‡å¯¹ä¸€ä¸ªéæ ‡é‡è°ƒç”¨ <code>backward()</code>ï¼Œåˆ™éœ€è¦ä¼ å…¥ä¸€ä¸ª<code>gradient</code>å‚æ•°ç”¨äºæŠŠå¼ é‡å¯¹å¼ é‡çš„æ±‚å¯¼è½¬æ¢ä¸ºæ ‡é‡å¯¹å¼ é‡çš„æ±‚å¯¼ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå…¶è¿ä½œæœºåˆ¶å¦‚ä¸‹ï¼š<br>è‹¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mi mathvariant="bold-italic">f</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf y=\boldsymbol f(\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6389em;vertical-align:-.1944em"></span><span class="mord mathbf" style="margin-right:.01597em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:.11042em">f</span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span>ï¼Œå…¶ä¸­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo separator="true">,</mo><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf y,\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6389em;vertical-align:-.1944em"></span><span class="mord mathbf" style="margin-right:.01597em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathbf">x</span></span></span></span> å‡ä¸ºåˆ—å‘é‡ï¼Œåˆ™åœ¨ PyTorch ä¸­ï¼Œç»™å®š <code>gradient</code> è¿™ä¸ª0-1å‘é‡ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi><mo separator="true">,</mo><msub><mi>v</mi><mi>i</mi></msub><mo>âˆˆ</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathbf v,v_i\in\{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335em;vertical-align:-.1944em"></span><span class="mord mathbf" style="margin-right:.01597em">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> ï¼Œåœ¨ <code>y.backward(v)</code> ä¹‹åå¾—åˆ°çš„ <code>x.grad</code> ä¸ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">âˆ‡</mi><mo stretchy="false">(</mo><msup><mi mathvariant="bold">v</mi><mi>T</mi></msup><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">âˆ‡</mi><mrow><mo fence="true">(</mo><mo>âˆ‘</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">â‹…</mo><msub><mi>v</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\nabla(\mathbf v^T\mathbf y)=\nabla\left(\sum y_iÂ· v_i\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-.25em"></span><span class="mord">âˆ‡</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf" style="margin-right:.01597em">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathbf" style="margin-right:.01597em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-.65em"></span><span class="mord">âˆ‡</span><span class="mspace" style="margin-right:.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size2">(</span></span><span class="mop op-symbol large-op" style="position:relative;top:0">âˆ‘</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p><p>å› æ­¤ï¼Œè‹¥æƒ³è®¡ç®—éæ ‡é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6389em;vertical-align:-.1944em"></span><span class="mord mathbf" style="margin-right:.01597em">y</span></span></span></span> å…³äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> å®é™…çš„é›…å¯æ¯”çŸ©é˜µï¼Œåˆ™éœ€è¦ä¾æ¬¡å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œç½®1ï¼ˆå…¶ä½™ç½®0ï¼‰è®¡ç®—å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> çš„æ¢¯åº¦ï¼Œæœ€åæ‹¼æ¥èµ·æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">x = torch.tensor([<span class="number">2</span>, <span class="number">3</span>], dtype=torch.<span class="built_in">float</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = torch.zeros(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–é›…å…‹æ¯”çŸ©é˜µ</span></span><br><span class="line">J = torch.zeros(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰yä¸xä¹‹é—´çš„æ˜ å°„å…³ç³»</span></span><br><span class="line">y[<span class="number">0</span>, <span class="number">0</span>] = x[<span class="number">0</span>] ** <span class="number">2</span> + <span class="number">3</span> * x[<span class="number">1</span>]</span><br><span class="line">y[<span class="number">0</span>, <span class="number">1</span>] = x[<span class="number">1</span>] ** <span class="number">2</span> + <span class="number">2</span> * x[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆy1å¯¹xçš„æ¢¯åº¦</span></span><br><span class="line">y.backward(torch.Tensor([[<span class="number">1</span>, <span class="number">0</span>]]), retain_graph=<span class="literal">True</span>)</span><br><span class="line">J[<span class="number">0</span>] = x.grad</span><br><span class="line"></span><br><span class="line">x.grad.zero_()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆy2å¯¹xçš„æ¢¯åº¦</span></span><br><span class="line">y.backward(torch.Tensor([[<span class="number">0</span>, <span class="number">1</span>]]))</span><br><span class="line">J[<span class="number">1</span>] = x.grad</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºé›…å…‹æ¯”çŸ©é˜µçš„å€¼</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Jé›…å…‹æ¯”çŸ©é˜µçš„å€¼ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(J))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š<strong>è¿™é‡Œå› ä¸ºé‡å¤ä½¿ç”¨<code>backward()</code>ï¼Œéœ€è¦ä½¿å‚æ•°<code>retain_graph=True</code></strong> é¿å…è®¡ç®—å›¾è¢«æ¸…é™¤ã€‚</p><h3 id="åˆ†ç¦»è®¡ç®—">åˆ†ç¦»è®¡ç®—</h3><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æŸäº›è®¡ç®—ç§»åŠ¨åˆ°è®°å½•çš„è®¡ç®—å›¾ä¹‹å¤–ã€‚<br>ä¾‹å¦‚ï¼Œå‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span></span> åŒ…å«æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> ï¼Œè€Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> æœ¬èº«åˆæ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> çš„å‡½æ•°ã€‚æˆ‘ä»¬æƒ³è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span></span> å…³äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> çš„æ¢¯åº¦ï¼Œä½†ä¸å¸Œæœ›<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> ä½œä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span></span></span></span> çš„å‡½æ•°è¢«çº³å…¥è®¡ç®—ï¼Œè€Œæ˜¯ä½œä¸ºå¸¸æ•°è®¡ç®—ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼Œå‡è®¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>y</mi><mo>+</mo><mi>x</mi><mo separator="true">,</mo><mtext>â€…â€Š</mtext><mi>y</mi><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">z=y+x,\;y=x^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8141em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">x=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">3</span></span></span></span> æ—¶ï¼Œæœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">y=9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">9</span></span></span></span> ã€‚<br>æˆ‘ä»¬å¸Œæœ›è®¡ç®—å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>z</mi><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo>=</mo><mo stretchy="false">(</mo><mn>9</mn><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msub><mi mathvariant="normal">âˆ£</mi><mrow><mi>x</mi><mo>=</mo><mn>3</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">z&#x27;_x=(9+x)&#x27;|_{x=3}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9989em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-2.453em;margin-left:-.044em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">9</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">=</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> ï¼Œè€Œä¸æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>z</mi><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msubsup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msub><mi mathvariant="normal">âˆ£</mi><mrow><mi>x</mi><mo>=</mo><mn>3</mn></mrow></msub><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">z_x&#x27;=(x^2+x)&#x27;|_{x=3}=7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9989em;vertical-align:-.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-2.453em;margin-left:-.044em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord">âˆ£</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">=</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">7</span></span></span></span></p><p>ä¸ºäº†åº”å¯¹è¿™ç§é—®é¢˜ï¼ŒPyTorchæä¾›äº† <code>detach()</code> æ–¹æ³•ï¼Œåˆ†ç¦»<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> æ¥è¿”å›â¼€ä¸ªæ–°å˜é‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">u</span></span></span></span>ï¼Œè¯¥å˜é‡ä¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> å…·æœ‰ç›¸åŒçš„å€¼ï¼Œä½†ä¸¢å¼ƒäº†è®¡ç®—å›¾ä¸­å¦‚ä½•è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> çš„ä»»ä½•ä¿¡æ¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line">x = torch.tensor([<span class="number">3.</span>], requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = x**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">u = y.detach()</span><br><span class="line">z = u + x</span><br><span class="line"></span><br><span class="line">z.backward()</span><br><span class="line"><span class="built_in">print</span>(x.grad == torch.tensor([<span class="number">1.</span>])) <span class="comment"># è¿”å› True</span></span><br></pre></td></tr></table></figure><h3 id="æ§åˆ¶æµçš„æ¢¯åº¦">æ§åˆ¶æµçš„æ¢¯åº¦</h3><p>åœ¨ PyTorch ä¸­ï¼Œå‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=f(\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span> å³ä½¿æ˜¯å¾ˆéš¾å†™å‡ºæ¸…æ™°æ˜æœ—çš„å…¬å¼ï¼Œåªèƒ½åˆ©ç”¨ Python çš„åŸºæœ¬æ§åˆ¶æµè¯­å¥ï¼Œå¦‚<code>for, while ,if</code> ç­‰ï¼Œæ¥å¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span></span> è¿›è¡Œå®šä¹‰ï¼Œé‚£ä¹ˆä¹ŸåŒæ ·èƒ½è®¡ç®—æ¢¯åº¦ã€‚</p><p>ä¾‹å¦‚ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mn>114</mn><mo separator="true">,</mo><msub><mi>x</mi><mn>5</mn></msub><mo>&gt;</mo><mn>114514</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>5</mn></msubsup><mo separator="true">,</mo><msub><mi>x</mi><mn>5</mn></msub><mo>â‰¤</mo><mn>114514</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}f=\begin{cases}\sum_{i=0}^4 x_i+114,x_5&gt;114514\\\sum_{i=0}^5,x_5\leq 114514\end{cases}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.3em;vertical-align:-1.4em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9em"><span style="top:-3.9em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.954em"><span style="top:-2.4003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">114</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">114514</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.954em"><span style="top:-2.4003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.2997em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">114514</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4em"><span></span></span></span></span></span></span></span></span></span></span> è¿™ç±»å¤æ‚å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Pythonä¸­å®šä¹‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">	y = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">		y += x[i] <span class="comment">#å…ˆåŠ å‰ 0~4 é¡¹</span></span><br><span class="line">	<span class="keyword">if</span>(x[<span class="number">5</span>] &gt; <span class="number">114514</span>):</span><br><span class="line">		y += <span class="number">114</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		y += x[<span class="number">5</span>]</span><br><span class="line">	<span class="keyword">return</span> y</span><br></pre></td></tr></table></figure><p>å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>120000</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf x=(1,1,1,1,1,120000)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4444em"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">120000</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span></span></span></span></span></span></span></span> æ—¶ï¼Œæ‰‹å·¥è®¡ç®—æ¢¯åº¦å¯å¾—ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">âˆ‡</mi><mi>f</mi><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\nabla f=[1,1,1,1,1,0]\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-.5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em"><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">âˆ‡</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.5em"><span></span></span></span></span></span></span></span></span></span></span>ã€‚</p><p>è‡ªåŠ¨æ±‚å¯¼éªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">x = torch.tensor([<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">120000</span>], dtype=torch.float32, requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = f(x)</span><br><span class="line"></span><br><span class="line">y.backward()</span><br><span class="line">ans = (x.grad == torch.cat((torch.ones(<span class="number">5</span>),torch.zeros(<span class="number">1</span>)),dim=<span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(ans) <span class="comment"># è¿”å› True</span></span><br></pre></td></tr></table></figure><h2 id="æ•°æ®é›†å¤„ç†">æ•°æ®é›†å¤„ç†</h2><h3 id="æ‰¹é‡è¯»å–åŠ è½½å™¨">æ‰¹é‡è¯»å–åŠ è½½å™¨</h3><p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ä»å¤§é‡åŸå§‹æ•°æ®é›†ä¸­å–å‡ºæ ·æœ¬æ•°ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">B</mi></mrow><annotation encoding="application/x-tex">\cal B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord"><span class="mord mathcal" style="margin-right:.03041em">B</span></span></span></span></span> ï¼ˆbatch sizeï¼‰çš„å°æ‰¹é‡æ ·æœ¬æ•°æ®ï¼Œç”¨äºå±•ç¤ºã€æ¢¯åº¦ä¸‹é™ä¼˜åŒ–æŸå¤±å‡½æ•°ã€å¯è§†åŒ–ç­‰ç­‰ã€‚</p><blockquote><p>å¾…æ›´ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45634934/article/details/125408600">https://blog.csdn.net/qq_45634934/article/details/125408600</a></p></blockquote><h3 id="æ„å»ºæ•°æ®é›†å¯¹è±¡">æ„å»ºæ•°æ®é›†å¯¹è±¡</h3><p>ä¸ºäº†åº”å¯¹è‡ªå·±çš„ä»»åŠ¡ï¼ˆè€Œä¸æ˜¯åˆ©ç”¨ç°æœ‰çš„å¼€æºæ•°æ®é›†è¿›è¡Œå®éªŒï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºè‡ªå·±çš„æ•°æ®é›†ä»è€Œåœ¨PyTorchä¸­å®ç°æ‰¹é‡è¯»å–å’Œåç»­çš„æ¨¡å‹è®­ç»ƒã€‚</p><p>PyTorchçš„ <code>torch.utils.Data.DataSet</code> æ˜¯å¯ç”¨äºåç»­ä»»åŠ¡çš„æ•°æ®é›†<strong>æŠ½è±¡ç±»</strong>ã€‚å…¶æºç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Dataset</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">r&quot;&quot;&quot;An abstract class representing a :class:`Dataset`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    All datasets that represent a map from keys to data samples should subclass</span></span><br><span class="line"><span class="string">    it. All subclasses should overwrite :meth:`__getitem__`, supporting fetching a</span></span><br><span class="line"><span class="string">    data sample for a given key. Subclasses could also optionally overwrite</span></span><br><span class="line"><span class="string">    :meth:`__len__`, which is expected to return the size of the dataset by many</span></span><br><span class="line"><span class="string">    :class:`~torch.utils.data.Sampler` implementations and the default options</span></span><br><span class="line"><span class="string">    of :class:`~torch.utils.data.DataLoader`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    .. note::</span></span><br><span class="line"><span class="string">      :class:`~torch.utils.data.DataLoader` by default constructs a index</span></span><br><span class="line"><span class="string">      sampler that yields integral indices.  To make it work with a map-style</span></span><br><span class="line"><span class="string">      dataset with non-integral indices/keys, a custom sampler must be provided.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> ConcatDataset([self, other])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># No `def __len__(self)` default?</span></span><br><span class="line">    <span class="comment"># See NOTE [ Lack of Default `__len__` in Python Abstract Base Classes ]</span></span><br><span class="line">    <span class="comment"># in pytorch/torch/utils/data/sampler.py</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¦æƒ³æ„å»ºè‡ªå·±çš„æ•°æ®é›†ï¼Œå°±å¿…é¡»ç¼–å†™è‡ªå·±çš„æ•°æ®é›†ç±»ï¼Œå¹¶ä¸”ç»§æ‰¿è‡ª <code>Datasets</code> ã€‚</p><p>æºç è¿˜æŒ‡å‡ºï¼Œæˆ‘ä»¬å¿…é¡»åœ¨è‡ªå·±çš„æ•°æ®é›†ç±»é‡Œé‡è½½ <code>__init__()</code> å’Œ <code>__getitim__()</code> ï¼Œå‰è€…ä¸€èˆ¬ç”¨äºè¿æ¥æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶æœ¬èº«ï¼Œåè€… <code>__getitim__()</code> åº”è¯¥ç¼–å†™æ”¯æŒæ•°æ®é›†ç´¢å¼•çš„å‡½æ•°ï¼Œä½¿å¾—é€šè¿‡å®ƒå¯ä»¥ç›´æ¥è¯»å–æŒ‡å®šç´¢å¼•ä¸‹çš„æ•°æ®ã€‚ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®ç° <code>__len__()</code> è¿”å›æ•°æ®é›†çš„æ ·æœ¬æ•°ã€‚</p><p>ä»¥å›¾åƒæ•°æ®é›†ä¸ºä¾‹ï¼Œä¸‹é¢æ˜¯ CIFAR10 æ•°æ®é›†çš„æ„å»ºæ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset,DataLoader</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CIFAR10_IMG</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, root, train=<span class="literal">True</span>, transform = <span class="literal">None</span>, target_transform=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(CIFAR10_IMG, self).__init__()</span><br><span class="line">        self.train = train</span><br><span class="line">        self.transform = transform</span><br><span class="line">        self.target_transform = target_transform</span><br><span class="line"></span><br><span class="line">        <span class="comment">#å¦‚æœæ˜¯è®­ç»ƒåˆ™åŠ è½½è®­ç»ƒé›†ï¼Œå¦‚æœæ˜¯æµ‹è¯•åˆ™åŠ è½½æµ‹è¯•é›†</span></span><br><span class="line">        <span class="keyword">if</span> self.train :</span><br><span class="line">            file_annotation = root + <span class="string">&#x27;/annotations/cifar10_train.json&#x27;</span></span><br><span class="line">            img_folder = root + <span class="string">&#x27;/train_cifar10/&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            file_annotation = root + <span class="string">&#x27;/annotations/cifar10_test.json&#x27;</span></span><br><span class="line">            img_folder = root + <span class="string">&#x27;/test_cifar10/&#x27;</span></span><br><span class="line">        fp = <span class="built_in">open</span>(file_annotation,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        data_dict = json.load(fp)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#å¦‚æœå›¾åƒæ•°å’Œæ ‡ç­¾æ•°ä¸åŒ¹é…è¯´æ˜æ•°æ®é›†æ ‡æ³¨ç”Ÿæˆæœ‰é—®é¢˜ï¼ŒæŠ¥é”™æç¤º</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(data_dict[<span class="string">&#x27;images&#x27;</span>])==<span class="built_in">len</span>(data_dict[<span class="string">&#x27;categories&#x27;</span>])</span><br><span class="line">        num_data = <span class="built_in">len</span>(data_dict[<span class="string">&#x27;images&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        self.filenames = []</span><br><span class="line">        self.labels = []</span><br><span class="line">        self.img_folder = img_folder</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_data):</span><br><span class="line">            self.filenames.append(data_dict[<span class="string">&#x27;images&#x27;</span>][i])</span><br><span class="line">            self.labels.append(data_dict[<span class="string">&#x27;categories&#x27;</span>][i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        img_name = self.img_folder + self.filenames[index]</span><br><span class="line">        label = self.labels[index]</span><br><span class="line"></span><br><span class="line">        img = plt.imread(img_name)</span><br><span class="line">        img = self.transform(img)   <span class="comment">#å¯ä»¥æ ¹æ®æŒ‡å®šçš„è½¬åŒ–å½¢å¼å¯¹æ•°æ®é›†è¿›è¡Œè½¬æ¢</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#returnå›å“ªäº›å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è®­ç»ƒæ—¶å¾ªç¯è¯»å–æ¯ä¸ªbatchæ—¶ï¼Œå°±èƒ½è·å¾—å“ªäº›å†…å®¹</span></span><br><span class="line">        <span class="keyword">return</span> img, label</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.filenames)</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶è¯»å†™">æ–‡ä»¶è¯»å†™</h2><p>ä¿å­˜è®­ç»ƒçš„æ¨¡å‹å¯ä»¥ä½¿å¾—å°†æ¥åœ¨å„ç§ç¯å¢ƒä¸­æ¨¡å‹å¾—ä»¥ä½¿â½¤ï¼ˆâ½å¦‚åœ¨éƒ¨ç½²ä¸­è¿›â¾é¢„æµ‹ï¼‰ã€‚<br>æ­¤å¤–ï¼Œå½“è¿â¾â¼€ä¸ªè€—æ—¶è¾ƒâ»“çš„è®­ç»ƒè¿‡ç¨‹æ—¶ï¼Œæœ€ä½³çš„åšæ³•æ˜¯å®šæœŸä¿å­˜ä¸­é—´ç»“æœï¼Œä»¥ç¡®ä¿åœ¨æœåŠ¡å™¨ç”µæºè¢«ä¸â¼©â¼¼æ–­æ‰æ—¶ï¼Œä¸ä¼šæŸå¤±â¼å¤©çš„è®¡ç®—ç»“æœã€‚</p><p>å› æ­¤ï¼Œ PyTorch åŒæ ·æä¾›äº†å¯¹å¼ é‡ã€å‚æ•°ã€ä»¥åŠæ•´ä¸ªæ¨¡å‹çš„<strong>ä¿å­˜ä¸åŠ è½½</strong>åŠŸèƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x = torch.arange(<span class="number">4</span>)</span><br><span class="line">y = torch.zeros(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜å’ŒåŠ è½½å•ä¸ªå¼ é‡</span></span><br><span class="line">torch.save(x, <span class="string">&#x27;x-file&#x27;</span>)</span><br><span class="line">x2 = torch.load(<span class="string">&#x27;x-file&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ é‡åˆ—è¡¨</span></span><br><span class="line">torch.save([x, y],<span class="string">&#x27;x-files&#x27;</span>)</span><br><span class="line">x2, y2 = torch.load(<span class="string">&#x27;x-files&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—å…¸</span></span><br><span class="line">mydict = &#123;<span class="string">&#x27;x&#x27;</span>: x, <span class="string">&#x27;y&#x27;</span>: y&#125;</span><br><span class="line">torch.save(mydict, <span class="string">&#x27;mydict&#x27;</span>)</span><br><span class="line">mydict2 = torch.load(<span class="string">&#x27;mydict&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ¨¡å‹çš„è¯»å†™">æ¨¡å‹çš„è¯»å†™</h3><p>ä¿å­˜å•ä¸ªæƒé‡å‘é‡ï¼ˆæˆ–å…¶ä»–å¼ é‡ï¼‰ç¡®å®æœ‰â½¤ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³ä¿å­˜æ•´ä¸ªæ¨¡å‹ï¼Œå¹¶åœ¨ä»¥ååŠ è½½å®ƒä»¬ï¼Œå•ç‹¬ä¿å­˜æ¯ä¸ªå‘é‡åˆ™ä¼šå˜å¾—å¾ˆâ¿‡çƒ¦ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬å¯èƒ½æœ‰æ•°ç™¾ä¸ªå‚æ•°æ•£å¸ƒåœ¨å„å¤„ã€‚å› æ­¤ï¼Œæ·±åº¦å­¦ä¹ æ¡†æ¶æä¾›äº†å†…ç½®å‡½æ•°æ¥ä¿å­˜å’ŒåŠ è½½æ•´ä¸ªâ½¹ç»œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥è‡ªå®šä¹‰çš„ MLP æ¨¡å‹ä¸ºä¾‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MLP</span>(nn.Module):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="built_in">super</span>().__init__()</span><br><span class="line">		</span><br><span class="line">		self.hidden = nn.Linear(<span class="number">20</span>, <span class="number">256</span>)</span><br><span class="line">		self.out = nn.Linear(<span class="number">256</span>, <span class="number">10</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, X</span>):</span><br><span class="line">		<span class="keyword">return</span> self.out(F.relu(self.hidden(X)))</span><br><span class="line"></span><br><span class="line">net = MLP() <span class="comment"># å®ä¾‹åŒ–ä¸€æ¬¡æ¨¡å‹</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">X = torch.randn(size=(<span class="number">2</span>, <span class="number">20</span>))</span><br><span class="line">Y = net(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ¨¡å‹çš„å‚æ•°å­˜å‚¨åœ¨â¼€ä¸ªå«åšâ€œmlp.paramsâ€çš„â½‚ä»¶ä¸­</span></span><br><span class="line">torch.save(net.state_dict(), <span class="string">&#x27;mlp.params&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–æ¨¡å‹ï¼Œç›´æ¥å¯¼å…¥åˆšåˆšä¿å­˜çš„å‚æ•°</span></span><br><span class="line">clone = MLP()</span><br><span class="line">clone.load_state_dict(torch.load(<span class="string">&#x27;mlp.params&#x27;</span>))</span><br><span class="line">clone.<span class="built_in">eval</span>() <span class="comment"># è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ¤æ–­ç»“æœæ˜¯å¦ä¸€è‡´</span></span><br><span class="line">Y_clone = clone(X)</span><br><span class="line">Y_clone == Y <span class="comment"># è¿”å›true</span></span><br></pre></td></tr></table></figure><h2 id="æ·±åº¦å­¦ä¹ è®­ç»ƒæ¨¡æ¿">æ·±åº¦å­¦ä¹ è®­ç»ƒæ¨¡æ¿</h2><h3 id="æ€»ä½“æ¡†æ¶">æ€»ä½“æ¡†æ¶</h3><h3 id="è‡ªå®šä¹‰ç½‘ç»œ">è‡ªå®šä¹‰ç½‘ç»œ</h3><p>ä¸ºäº†å®ç°å¤æ‚çš„ç¥ç»ç½‘ç»œæ­å»ºï¼Œæ·±åº¦å­¦ä¹ ä¸­å¼•â¼Šäº†ç¥ç»â½¹ç»œå—çš„æ¦‚å¿µã€‚å—ï¼ˆblockï¼‰å¯ä»¥æè¿°å•ä¸ªå±‚ã€ç”±å¤šä¸ªå±‚ç»„æˆçš„ç»„ä»¶æˆ–æ•´ä¸ªæ¨¡å‹æœ¬â¾ã€‚</p><p>æ¯ä¸ªå—å¿…é¡»æä¾›çš„åŸºæœ¬åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ol><li>å°†è¾“â¼Šæ•°æ®ä½œä¸ºå…¶å‰å‘ä¼ æ’­å‡½æ•°çš„å‚æ•°ã€‚</li><li>é€šè¿‡å‰å‘ä¼ æ’­å‡½æ•°æ¥â½£æˆè¾“å‡ºã€‚è¯·æ³¨æ„ï¼Œè¾“å‡ºçš„å½¢çŠ¶å¯èƒ½ä¸è¾“â¼Šçš„å½¢çŠ¶ä¸åŒã€‚</li><li>è®¡ç®—å…¶è¾“å‡ºå…³äºè¾“â¼Šçš„æ¢¯åº¦ï¼Œå¯é€šè¿‡å…¶åå‘ä¼ æ’­å‡½æ•°è¿›â¾è®¿é—®ã€‚é€šå¸¸è¿™æ˜¯â¾ƒåŠ¨å‘â½£çš„ã€‚</li><li>å­˜å‚¨å’Œè®¿é—®å‰å‘ä¼ æ’­è®¡ç®—æ‰€éœ€çš„å‚æ•°ã€‚</li><li>æ ¹æ®éœ€è¦åˆå§‹åŒ–æ¨¡å‹å‚æ•°</li></ol><p>ä»¥ <code>MLP</code> ä¸ºä¾‹è¿›è¡Œè‡ªå®šä¹‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰å±‚</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyLinear</span>(nn.Module):</span><br><span class="line"></span><br><span class="line">	<span class="comment"># æ¥æ”¶è¾“å…¥æ•°in_unitsã€è¾“å‡ºæ•°units</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_units, units</span>):</span><br><span class="line">		<span class="comment"># è°ƒâ½¤â½—ç±»Moduleçš„æ„é€ å‡½æ•°æ¥æ‰§â¾å¿…è¦çš„åˆå§‹åŒ–</span></span><br><span class="line">		<span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">		<span class="comment"># å®šä¹‰å‚æ•°</span></span><br><span class="line">		self.weight = nn.Parameter(torch.randn(in_units, units))</span><br><span class="line">		self.bias = nn.Parameter(torch.randn(units,))</span><br><span class="line"></span><br><span class="line">	<span class="comment"># å®šä¹‰æ¨¡å‹çš„å‰å‘ä¼ æ’­ï¼Œå³å¦‚ä½•æ ¹æ®è¾“â¼ŠXè¿”å›æ‰€éœ€çš„æ¨¡å‹è¾“å‡º</span></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, X</span>):</span><br><span class="line">		linear = torch.matmul(X, self.weight.data) + self.bias.data</span><br><span class="line">		<span class="keyword">return</span> F.relu(linear)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰å—</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MLP</span>(nn.Module):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">		<span class="built_in">super</span>().__init__()</span><br><span class="line">		</span><br><span class="line">		self.hidden = MyLinear(<span class="number">20</span>, <span class="number">256</span>) <span class="comment"># éšè—å±‚</span></span><br><span class="line">		self.out = MyLinear(<span class="number">256</span>, <span class="number">10</span>) <span class="comment"># è¾“å‡ºå±‚</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, X</span>):</span><br><span class="line">		<span class="keyword">return</span> self.out(F.relu(self.hidden(X)))</span><br></pre></td></tr></table></figure><h3 id="è®¿é—®å‚æ•°">è®¿é—®å‚æ•°</h3><p>å½“é€šè¿‡ <code>Sequential</code> ç±»å®šä¹‰æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç´¢å¼•æ¥è®¿é—®æ¨¡å‹çš„ä»»æ„å±‚ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(net[<span class="number">2</span>].state_dict()) <span class="comment">#æ£€æŸ¥ç¬¬ä¸‰ä¸ªç½‘ç»œå±‚çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(net[<span class="number">2</span>].bias))</span><br><span class="line"><span class="built_in">print</span>(net[<span class="number">2</span>].bias)</span><br><span class="line"><span class="built_in">print</span>(net[<span class="number">2</span>].bias.data) <span class="comment">#æ£€æŸ¥åç½®</span></span><br><span class="line"><span class="built_in">print</span>(net.state_dict()[<span class="string">&#x27;2.bias&#x27;</span>].data) <span class="comment">#ä¸ä¸Šä¸€è¡Œç­‰ä»·</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(net[<span class="number">2</span>].weight.grad) <span class="comment">#æ£€æŸ¥æƒé‡æ¢¯åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(*[(name, param.shape) <span class="keyword">for</span> name, param <span class="keyword">in</span> net.named_parameters()]) <span class="comment">#â¼€æ¬¡æ€§è®¿é—®æ‰€æœ‰å‚æ•°</span></span><br></pre></td></tr></table></figure><h3 id="å‚æ•°çš„å¸¸è§åˆå§‹åŒ–">å‚æ•°çš„å¸¸è§åˆå§‹åŒ–</h3><p>é€šè¿‡ <code>net.apply()</code> å¯ä»¥å®ç°å¾ˆå¤šä¸ªæ€§åŒ–çš„å‚æ•°åˆå§‹åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> init</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_normal</span>(<span class="params">m</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">type</span>(m) == nn.Linear: <span class="comment"># å¯¹ç‰¹å®šç±»å‹çš„ç½‘ç»œè¿›è¡Œå¤„ç†</span></span><br><span class="line">		nn.init.normal_(m.weight, mean=<span class="number">0</span>, std=<span class="number">0.01</span>) <span class="comment"># é«˜æ–¯åˆ†å¸ƒ</span></span><br><span class="line">		nn.init.zeros_(m.bias) <span class="comment">#ç½®0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_constant</span>(<span class="params">m</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">type</span>(m) == nn.Linear:</span><br><span class="line">		nn.init.constant_(m.weight, <span class="number">1</span>) <span class="comment"># å¸¸æ•°</span></span><br><span class="line">		nn.init.zeros_(m.bias)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_xavier</span>(<span class="params">m</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">type</span>(m) == nn.Linear:</span><br><span class="line">		nn.init.xavier_uniform_(m.weight) <span class="comment"># Xavieråˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line">net.apply(init_normal) <span class="comment"># ä»¥ä¸Šå‡½æ•°å‡å¯é€‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“ç„¶ä¾ç„¶å¯ä»¥ç›´æ¥èµ‹å€¼</span></span><br><span class="line">net[<span class="number">0</span>].weight.data[:] += <span class="number">1</span></span><br><span class="line">net[<span class="number">0</span>].weight.data[<span class="number">0</span>, <span class="number">0</span>] = <span class="number">42</span></span><br></pre></td></tr></table></figure><h3 id="å‚æ•°ç»‘å®š">å‚æ•°ç»‘å®š</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å…±äº«æ¨¡å‹å‚æ•°ï¼Œæ¯”å¦‚åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­åŒä¸€ä¸ªå±‚å¾ªç¯ä½¿ç”¨ã€‚äº‹å®ä¸Šï¼Œæ¨¡å‹å‚æ•°å…¶å®å°±æ˜¯ä¸€ä¸ª Tensor çš„å­ç±»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¼ é‡ï¼Œè¦å…±äº«å®ƒï¼Œåªéœ€è¦å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªå±‚å³å¯ã€‚<br>å› ä¸ºè°ƒç”¨åŒä¸€ä¸ªå±‚ï¼Œè®¡ç®—çš„æ—¶å€™å°±æ˜¯ä½¿ç”¨çš„è¿™ä¸ªå±‚ä»£è¡¨çš„å¼ é‡ï¼Œæ‰€ä»¥å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªå±‚ç›¸å½“äºå…±äº«äº†æ¨¡å‹å‚æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># æˆ‘ä»¬éœ€è¦ç»™å…±äº«å±‚â¼€ä¸ªåç§°ï¼Œä»¥ä¾¿å¯ä»¥å¼•â½¤å®ƒçš„å‚æ•°</span></span><br><span class="line">shared = nn.Linear(<span class="number">8</span>, <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">net = nn.Sequential(nn.Linear(<span class="number">4</span>, <span class="number">8</span>), nn.ReLU(),</span><br><span class="line">					shared, nn.ReLU(),</span><br><span class="line">					shared, nn.ReLU(),</span><br><span class="line">					nn.Linear(<span class="number">8</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">net(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥å‚æ•°æ˜¯å¦ç›¸åŒ</span></span><br><span class="line"><span class="built_in">print</span>(net[<span class="number">2</span>].weight.data[<span class="number">0</span>] == net[<span class="number">4</span>].weight.data[<span class="number">0</span>])</span><br><span class="line">net[<span class="number">2</span>].weight.data[<span class="number">0</span>, <span class="number">0</span>] = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¡®ä¿å®ƒä»¬å®é™…ä¸Šæ˜¯åŒâ¼€ä¸ªå¯¹è±¡ï¼Œâ½½ä¸åªæ˜¯æœ‰ç›¸åŒçš„å€¼</span></span><br><span class="line"><span class="built_in">print</span>(net[<span class="number">2</span>].weight.data[<span class="number">0</span>] == net[<span class="number">4</span>].weight.data[<span class="number">0</span>]) <span class="comment"># è¿”å›å…¨true</span></span><br></pre></td></tr></table></figure><blockquote><p>å½“å‚æ•°ç»‘å®šæ—¶ï¼Œæ¢¯åº¦ä¼šå‘â½£ä»€ä¹ˆæƒ…å†µï¼Ÿ<br>ç­”æ¡ˆæ˜¯ç”±äºæ¨¡å‹å‚æ•°åŒ…å«æ¢¯åº¦ï¼Œå› æ­¤åœ¨åå‘ä¼ æ’­æœŸé—´ç¬¬â¼†ä¸ªéšè—å±‚ï¼ˆå³ç¬¬ä¸‰ä¸ªç¥ç»â½¹ç»œå±‚ï¼‰å’Œç¬¬ä¸‰ä¸ªéšè—å±‚ï¼ˆå³ç¬¬äº”ä¸ªç¥ç»â½¹ç»œå±‚ï¼‰çš„<strong>æ¢¯åº¦ä¼šåŠ åœ¨â¼€èµ·</strong>ã€‚</p></blockquote><h3 id="ä¼˜åŒ–å™¨é€‰å–">ä¼˜åŒ–å™¨é€‰å–</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xian0710830114/article/details/128658682">Pytorchä¼˜åŒ–å™¨å…¨æ€»ç»“ï¼ˆå››ï¼‰å¸¸ç”¨ä¼˜åŒ–å™¨æ€§èƒ½å¯¹æ¯” å«ä»£ç _ä¼˜åŒ–å™¨æ¯”è¾ƒ-CSDNåšå®¢</a></p><h3 id="GPUåŠ é€Ÿ">GPUåŠ é€Ÿ</h3><p>é¦–å…ˆç¡®ä¿â¾„å°‘å®‰è£…äº†â¼€ä¸ª<strong>NVIDIA GPU</strong> å¹¶ä¸”ä¸‹è½½å®‰è£…äº† NVIDIA é©±åŠ¨ å’Œ <strong>CUDA</strong>ï¼ˆæœ¬æ–‡å¼€å¤´å·²æåŠï¼‰</p><p>ç»ˆç«¯ä¸­å¯ä»¥ä½¿â½¤ <code>nvidia-smi</code> å‘½ä»¤æŸ¥çœ‹æ˜¾å¡ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 535.98                 Driver Version: 535.98       CUDA Version: 12.2     |</span><br><span class="line">|-----------------------------------------+----------------------+----------------------+</span><br><span class="line">| GPU  Name                     TCC/WDDM  | Bus-Id        Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                                         |                      |               MIG M. |</span><br><span class="line">|=========================================+======================+======================|</span><br><span class="line">|   0  NVIDIA GeForce RTX 4070      WDDM  | 00000000:01:00.0 Off |                  N/A |</span><br><span class="line">|  0%   41C    P8               6W / 200W |      0MiB / 12282MiB |      0%      Default |</span><br><span class="line">|                                         |                      |                  N/A |</span><br><span class="line">+-----------------------------------------+----------------------+----------------------+</span><br><span class="line"></span><br><span class="line">+---------------------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                            |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |</span><br><span class="line">|        ID   ID                                                             Usage      |</span><br><span class="line">|=======================================================================================|</span><br><span class="line">|  No running processes found                                                           |</span><br><span class="line">+---------------------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure><p>åœ¨PyTorchä¸­ï¼Œæ¯ä¸ªæ•°ç»„éƒ½æœ‰â¼€ä¸ªè®¾å¤‡ï¼ˆdeviceï¼‰ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶ç§°ä¸ºç¯å¢ƒï¼ˆcontextï¼‰ã€‚<strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å˜é‡å’Œç›¸å…³çš„è®¡ç®—éƒ½åˆ†é…ç»™CPUã€‚</strong></p><p>CPU å’Œ GPU å¯ä»¥â½¤ <code>torch.device('cpu')</code> å’Œ <code>torch.device('cuda')</code>è¡¨â½°ï¼›<br>å¦‚æœæœ‰å¤šä¸ª GPUï¼Œæˆ‘ä»¬ä½¿â½¤ <code>torch.device(f'cuda:&#123;i&#125;')</code> æ¥è¡¨â½°ç¬¬<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span></span></span></span> å—GPUï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span></span></span></span> ä»0å¼€å§‹ï¼‰ï¼Œå…¶ä¸­ <code>cuda:0</code> å’Œ <code>cuda</code> ç­‰ä»·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å¯ç”¨ GPU çš„æ•°é‡</span></span><br><span class="line">torch.cuda.device_count()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ä¸¤ä¸ªå‡½æ•°ä»¥ä¾¿äºdeviceçš„è·å–</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_gpu</span>(<span class="params">i=<span class="number">0</span></span>): </span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;&quot;&quot;å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›gpu(i)ï¼Œå¦åˆ™è¿”å›cpu()&quot;&quot;&quot;</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> torch.cuda.device_count() &gt;= i + <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">return</span> torch.device(<span class="string">f&#x27;cuda:<span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> torch.device(<span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_all_gpus</span>(): </span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;&quot;&quot;è¿”å›æ‰€æœ‰å¯â½¤çš„GPUï¼Œå¦‚æœæ²¡æœ‰GPUï¼Œåˆ™è¿”å›[cpu(),]&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">	devices = [torch.device(<span class="string">f&#x27;cuda:<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(torch.cuda.device_count())]</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">return</span> devices <span class="keyword">if</span> devices <span class="keyword">else</span> [torch.device(<span class="string">&#x27;cpu&#x27;</span>)]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>.to(device)</code> æ–¹æ³•å°†æ•°æ®å®‰æ’åœ¨ GPU ä¸‹è¿›è¡Œå¤„ç†å’Œè¿ç®—ã€‚</p><h2 id="å†…ç½®ç½‘ç»œå±‚">å†…ç½®ç½‘ç»œå±‚</h2><blockquote><p>å¾…æ›´ï¼š<a target="_blank" rel="noopener" href="https://pytorch.org/vision/stable/models.html">Models and pre-trained weights â€” Torchvision 0.16 documentation (pytorch.org)</a></p></blockquote><h3 id="é¢„è®­ç»ƒæ¨¡å‹ä¿®æ”¹">é¢„è®­ç»ƒæ¨¡å‹ä¿®æ”¹</h3><blockquote><p>å¾…æ›´ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/andyL_05/article/details/108930240">https://blog.csdn.net/andyL_05/article/details/108930240</a></p></blockquote><h2 id="Warm-Up-é¢„çƒ­å­¦ä¹ ç‡">Warm-Up é¢„çƒ­å­¦ä¹ ç‡</h2><p>å­¦ä¹ ç‡æ˜¯ç¥ç»ç½‘ç»œè®­ç»ƒä¸­æœ€é‡è¦çš„è¶…å‚æ•°ä¹‹ä¸€ï¼Œé’ˆå¯¹å­¦ä¹ ç‡çš„ä¼˜åŒ–æ–¹å¼å¾ˆå¤šï¼Œè€Œ Warmup å°±æ˜¯å…¶ä¸­çš„ä¸€ç§ã€‚</p><p>Warmupæ˜¯åœ¨ <strong>ResNet</strong> è®ºæ–‡ä¸­æåˆ°çš„ä¸€ç§å­¦ä¹ ç‡é¢„çƒ­çš„æ–¹æ³•ï¼Œå®ƒåœ¨è®­ç»ƒå¼€å§‹çš„æ—¶å€™å…ˆé€‰æ‹©ä½¿ç”¨ä¸€ä¸ªè¾ƒå°çš„å­¦ä¹ ç‡ï¼Œè®­ç»ƒäº†ä¸€äº› <code>epoches</code> æˆ–è€… <code>steps</code> (æ¯”å¦‚ ï¼š<code>4epoches,10000steps</code>) ä¹‹åå†ä¿®æ”¹ä¸ºé¢„å…ˆè®¾ç½®çš„å­¦ä¹ ç‡æ¥è¿›è¡Œè®­ç»ƒã€‚</p><p>ç”±äºåˆšå¼€å§‹è®­ç»ƒæ—¶ï¼Œæ¨¡å‹çš„æƒé‡æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œæ­¤æ—¶è‹¥é€‰æ‹©ä¸€ä¸ªè¾ƒå¤§çš„å­¦ä¹ ç‡å¯èƒ½å¸¦æ¥æ¨¡å‹çš„ä¸ç¨³å®š(æŒ¯è¡)ã€‚å¦‚æœé€‰æ‹©Warmupçš„æ–¹å¼ï¼Œå¯ä»¥ä½¿å¾—å¼€å§‹è®­ç»ƒçš„ä¸€æ®µæ—¶é—´å†…å­¦ä¹ ç‡è¾ƒå°ï¼Œæ¨¡å‹å¯ä»¥æ…¢æ…¢è¶‹äºç¨³å®šï¼›ç­‰æ¨¡å‹ç›¸å¯¹ç¨³å®šåå†é€‰æ‹©é¢„å…ˆè®¾ç½®çš„å­¦ä¹ ç‡è¿›è¡Œè®­ç»ƒï¼Œè¿™åˆä½¿å¾—æ¨¡å‹æ”¶æ•›é€Ÿåº¦å˜å¾—æ›´å¿«ï¼Œæ¨¡å‹æ•ˆæœæ›´ä½³ã€‚</p><blockquote><p>æ›´å¤šåŸç†ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/424373231">ä¸ºä»€ä¹ˆè®­ç»ƒçš„æ—¶å€™warm upè¿™ä¹ˆé‡è¦ï¼Ÿä¸€æ–‡ç†è§£warm upåŸç† - çŸ¥ä¹</a></p></blockquote><h3 id="å®ç°ç­–ç•¥">å®ç°ç­–ç•¥</h3><h4 id="constant-warmup">constant warmup</h4><p><strong>Resnet</strong> è®ºæ–‡ä¸­ä½¿ç”¨ä¸€ä¸ª110å±‚çš„ ResNet åœ¨ cifar10 ä¸Šè®­ç»ƒæ—¶ï¼Œå…ˆç”¨ <code>0.01</code> çš„å­¦ä¹ ç‡è®­ç»ƒç›´åˆ°è®­ç»ƒè¯¯å·®ä½äº80%(å¤§æ¦‚è®­ç»ƒäº†400ä¸ª<code>steps</code>)ï¼Œç„¶åä½¿ç”¨ <code>0.1</code> çš„å­¦ä¹ ç‡è¿›è¡Œè®­ç»ƒã€‚</p><h4 id="gradual-warmup">gradual warmup</h4><p>constant warmupçš„ä¸è¶³ä¹‹å¤„åœ¨äºä»ä¸€ä¸ªå¾ˆå°çš„å­¦ä¹ ç‡ä¸€ä¸‹å˜ä¸ºæ¯”è¾ƒå¤§çš„å­¦ä¹ ç‡å¯èƒ½ä¼šå¯¼è‡´è®­ç»ƒè¯¯å·®çªç„¶å¢å¤§ã€‚<br>äºæ˜¯2018å¹´ <strong>Facebook</strong> æå‡ºäº†gradual warmupæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå³<strong>ä»æœ€åˆçš„å°å­¦ä¹ ç‡å¼€å§‹ï¼Œæ¯ä¸ª<code>step</code>å¢å¤§ä¸€ç‚¹ç‚¹ï¼Œç›´åˆ°è¾¾åˆ°æœ€åˆè®¾ç½®çš„æ¯”è¾ƒå¤§çš„å­¦ä¹ ç‡</strong>æ—¶ï¼Œå†é‡‡ç”¨æœ€åˆè®¾ç½®çš„å­¦ä¹ ç‡è¿›è¡Œè®­ç»ƒã€‚<br>æ¥ç€ï¼Œéšç€è®­ç»ƒçš„è¿›è¡Œï¼Œæˆ‘ä»¬å¸Œæœ›å†é€æ¸å‡å°å­¦ä¹ ç‡ï¼Œä¹Ÿå°±æ˜¯å­¦ä¹ ç‡æ­¤åæ˜¯<strong>è¡°å‡</strong>çš„ï¼Œè¿™æœ‰åŠ©äºä½¿æ¨¡å‹æ”¶æ•›é€Ÿåº¦å˜å¿«ï¼Œæ•ˆæœæ›´ä½³ã€‚</p><p>è¿™é‡Œçš„è¡°å‡ç­–ç•¥åˆå¯ä»¥åˆ†ä¸ºï¼š<strong>æŒ‡æ•°è¡°å‡è°ƒæ•´</strong>(Exponential) å’Œ <strong>ä½™å¼¦é€€ç«</strong>(CosineAnnealing)ã€‚</p><h3 id="lr-scheduleræ¨¡å—"><code>lr_scheduler</code>æ¨¡å—</h3><p>PyTorch ä¸­çš„å­¦ä¹ ç‡è°ƒæ•´ç­–ç•¥é€šè¿‡ <code>torch.optim.lr_scheduler</code> æ¨¡å—å®ç°ã€‚</p><h4 id="torch-optim-lr-scheduler-LambdaLR"><code>torch.optim.lr_scheduler.LambdaLR</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.optim.lr_scheduler.LambdaLR(optimizer, lr_lambda, last_epoch=-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸‹åˆ—å…¬å¼é€æ­¥æ›´æ–°å­¦ä¹ ç‡ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>Î»</mi><mo>Ã—</mo><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\eta^{(t)}=\lambda\times\eta^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal">Î»</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\eta^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.888em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> æ˜¯åˆå§‹å­¦ä¹ ç‡ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><code>optimizer</code> ï¼ˆOptimizerï¼‰ï¼šè¦æ›´æ”¹å­¦ä¹ ç‡çš„ä¼˜åŒ–å™¨ï¼›</li><li><code>lr_lambda</code>ï¼ˆfunction or listï¼‰ï¼šæä¾›å…³äº <code>epoch</code>çš„å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">Î»</span></span></span></span> ï¼›æˆ–è€…æ˜¯ä¸€ä¸ª <code>List</code> ç»™å‡ºå„ä¸ªparameter groups çš„å­¦ä¹ ç‡æ›´æ–°ç”¨åˆ°çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">Î»</span></span></span></span>ï¼›</li><li><code>last_epoch</code> ï¼ˆintï¼‰ï¼šæœ€åä¸€ä¸ª <code>epoch</code> çš„ <code>index</code>ï¼Œå¦‚æœæ˜¯è®­ç»ƒäº†å¾ˆå¤šä¸ª <code>epoch</code> åä¸­æ–­äº†ï¼Œç»§ç»­è®­ç»ƒï¼Œè¿™ä¸ªå€¼å°±ç­‰äºåŠ è½½çš„æ¨¡å‹çš„ <code>epoch</code>ã€‚é»˜è®¤ä¸º <code>-1</code> è¡¨ç¤ºä»å¤´å¼€å§‹è®­ç»ƒï¼Œå³ä»<code>epoch=1</code>å¼€å§‹ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example</span></span><br><span class="line"></span><br><span class="line">optimizer_1 = torch.optim.Adam(net_1.parameters(), lr = initial_lr)</span><br><span class="line">scheduler_1 = LambdaLR(optimizer_1, lr_lambda=<span class="keyword">lambda</span> epoch: <span class="number">1</span>/(epoch+<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åˆå§‹åŒ–çš„å­¦ä¹ ç‡ï¼š&quot;</span>, optimizer_1.defaults[<span class="string">&#x27;lr&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    <span class="comment"># other train operation</span></span><br><span class="line">    optimizer_1.zero_grad()</span><br><span class="line">    optimizer_1.step()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç¬¬%dä¸ªepochçš„å­¦ä¹ ç‡ï¼š%f&quot;</span> % (epoch, optimizer_1.param_groups[<span class="number">0</span>][<span class="string">&#x27;lr&#x27;</span>]))</span><br><span class="line">    scheduler_1.step() <span class="comment">#å¿…é¡»</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="torch-optim-lr-scheduler-StepLR"><code>torch.optim.lr_scheduler.StepLR</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.optim.lr_scheduler.StepLR(optimizer, step_size, gamma=<span class="number">0.1</span>, last_epoch=-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>æ¯è¿‡ <code>step_size</code> ä¸ª <code>epoch</code>ï¼Œåšä¸€æ¬¡æ›´æ–°ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>Î³</mi><mrow><mo stretchy="false">âŒŠ</mo><mfrac><mrow><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi></mrow><mrow><mi>s</mi><mi>t</mi><mi>e</mi><mi>p</mi><mi mathvariant="normal">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></mfrac><mo stretchy="false">âŒ‹</mo></mrow></msup><mo>Ã—</mo><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\eta^{(t)}=\gamma^{\lfloor{\frac{epoch}{step\_size}}\rfloor}\times\eta^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.3689em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05556em">Î³</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1744em"><span style="top:-3.5036em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">âŒŠ</span><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9584em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">p</span><span class="mord mtight" style="margin-right:.02778em">_</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span><span style="top:-3.2255em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4624em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">oc</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.5654em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span><span class="mclose mtight">âŒ‹</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>ä½¿ç”¨æ–¹æ³•åŒä¸Šï¼Œæ­¤åä¸å†ç»™å‡ºç¤ºä¾‹ã€‚</p><h4 id="torch-optim-lr-scheduler-MultiStepLR"><code>torch.optim.lr_scheduler.MultiStepLR</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">torch.optim.lr_scheduler.MultiStepLR(optimizer, milestones, gamma=<span class="number">0.1</span>, last_epoch=-<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªæŒ‰éœ€è°ƒæ•´å­¦ä¹ ç‡çš„æ–¹æ³•ã€‚ä¸ <code>StepLR</code>åªèƒ½æ¯é—´éš” <code>step_size</code> ä¸ª <code>epoch</code> å†å˜æ›´å­¦ä¹ ç‡ä¸åŒï¼Œè¯¥æ–¹æ³•å˜æ¢å­¦ä¹ ç‡çš„æ—¶é—´æ˜¯å¯ä»¥çµæ´»è‡ªå®šä¹‰è°ƒèŠ‚çš„â€”â€”é€šè¿‡ä¼ å…¥ <code>milestiones</code> å‚æ•°ï¼ˆåˆ—è¡¨ç±»å‹ï¼‰ï¼Œå¾ˆé€‚åˆåæœŸè°ƒè¯•ä½¿ç”¨ï¼šè§‚å¯Ÿ <code>loss</code> æ›²çº¿ï¼Œä¸ºæ¯ä¸ªå®éªŒå®šåˆ¶å­¦ä¹ ç‡è°ƒæ•´æ—¶æœºã€‚</p><p>ä¾‹å¦‚ï¼Œå–<code>milestiones=[10,20,50,80]</code>ï¼Œè‹¥å½“å‰ <code>epoch=34</code>ï¼Œå®ƒåè½åœ¨åŒºé—´<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>20</mn><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[20,50)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord">20</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">50</span><span class="mclose">)</span></span></span></span> å†…ï¼Œé‚£ä¹ˆå› å­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05556em">Î³</span></span></span></span> çš„æŒ‡æ•°å°±æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">2</span></span></span></span> ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">2</span></span></span></span> æ˜¯ <code>milestiones[x]==20</code> çš„ç´¢å¼• <code>x</code>ã€‚</p><p>äº‹å®ä¸Šï¼Œä¸Šè¿°æŸ¥æ‰¾ <code>epoch</code> å¤„äºç¬¬å‡ ä¸ªåŒºé—´çš„æ–¹æ³•å¯ä»¥ç”¨ Python çš„ <code>bisect.bisect_right(a, x)</code> å®ç°â€”â€”è¿™ä¸ªå‡½æ•°è¡¨ç¤ºåˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ³•æŸ¥æ‰¾å…ƒç´ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span></span></span></span> åœ¨<strong>æœ‰åºåºåˆ—</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">a</span></span></span></span> ä¸­çš„æ’å…¥ä½ç½®ã€‚</p><p>æ•…æ›´æ–°å…¬å¼å¯ä»¥å†™ä¸ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>Î³</mi><mrow><mtext>bisect_right</mtext><mo stretchy="false">(</mo><mi>m</mi><mi>i</mi><mi>l</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>e</mi><mi>s</mi><mo separator="true">,</mo><mtext>â€…â€Š</mtext><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi><mo stretchy="false">)</mo></mrow></msup><mo>Ã—</mo><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\eta^{(t)}=\gamma^{\text{bisect\_right}(milestones,\;epoch)}\times\eta^{(0)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05556em">Î³</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bisect_right</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">mi</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">es</span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:.3253em"></span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">oc</span><span class="mord mathnormal mtight">h</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><h4 id="ExponentialLR-CosineAnnealingLR">ExponentialLR &amp; CosineAnnealingLR</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">torch.optim.lr_scheduler.ExponentialLR(optimizer, gamma, last_epoch=-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max, eta_min=<span class="number">0</span>, last_epoch=-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>å³ æŒ‡æ•°è¡°å‡æ³• å’Œ ä½™å¼¦é€€ç«æ³•ã€‚</p><p>æŒ‡æ•°è¡°å‡æ³•ç›¸å½“äºæ¯éš”ä¸€ä¸ª <code>epoch</code> å°±è¡°å‡ä¸€æ¬¡ï¼Œç­‰åŒäº <code>StepLR</code> æ–¹æ³•ä¸­å– <code>step_size=1</code>ã€‚</p><p>ä½™å¼¦é€€ç«æ³•çš„æ›´æ–°å…¬å¼å¦‚ä¸‹ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msub><mi>Î·</mi><mi>min</mi><mo>â¡</mo></msub><mo>+</mo><mo stretchy="false">(</mo><msup><mi>Î·</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup><mo>âˆ’</mo><msub><mi>Î·</mi><mi>min</mi><mo>â¡</mo></msub><mo stretchy="false">)</mo><mo>Ã—</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>âˆ’</mo><mi>cos</mi><mo>â¡</mo><mrow><mfrac><mrow><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi></mrow><msub><mi>T</mi><mi>max</mi><mo>â¡</mo></msub></mfrac><mi>Ï€</mi></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta^{(t)}=\eta_{\min}+(\eta^{(0)}-\eta_{\min})\times\left(1-\cos{\frac{epoch}{T_{\max}}\pi}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1324em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3175em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">Î·</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3175em"><span style="top:-2.55em;margin-left:-.0359em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-.95em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:.2222em"></span><span class="mop">cos</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">a</span><span class="mtight">x</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span><span class="mord mathnormal">oc</span><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:.03588em">Ï€</span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ\eta_\min å³å‚æ•° <code>eta_min</code> è¡¨ç¤ºæœ€å°å­¦ä¹ ç‡ï¼ŒT_\max å³å‚æ•° <code>T_max</code> ä»£è¡¨æ¯éš” <code>T_max</code> ä¸ª <code>epoch</code> èµ°è¿‡ä¸€ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>â¡</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">\cos x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mop">cos</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">x</span></span></span></span> å‡½æ•°çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1/2</span></span></span></span> å‘¨æœŸï¼Œå³å­¦ä¹ ç‡ä¸‹é™åˆ°æœ€å°å€¼ï¼Œç„¶åå†è¿‡ <code>T_max</code> ä¸ª <code>epoch</code> ä¸Šå‡åˆ°å­¦ä¹ ç‡çš„æœ€å¤§å€¼ã€‚ï¼ˆå¯å›å¿†ä½™å¼¦å‡½æ•°çš„å›¾åƒï¼‰</p><h4 id="è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡">è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.optim.lr_scheduler.ReduceLROnPlateau(optimizer, mode=<span class="string">&#x27;min&#x27;</span>, factor=<span class="number">0.1</span>, patience=<span class="number">10</span>, verbose=<span class="literal">False</span>, threshold=<span class="number">0.0001</span>, threshold_mode=<span class="string">&#x27;rel&#x27;</span>, cooldown=<span class="number">0</span>, min_lr=<span class="number">0</span>, eps=<span class="number">1e-08</span>)</span><br></pre></td></tr></table></figure><p>ä¸ä¾èµ– <code>epoch</code> çš„å­¦ä¹ ç‡è°ƒæ•´æ–¹æ³•åªæœ‰ <code>ReduceLROnPlateau</code>ã€‚</p><p>å½“<strong>æŸæŒ‡æ ‡</strong>ä¸å†å˜åŒ–ï¼ˆä¸‹é™æˆ–å‡é«˜ï¼‰æ—¶æ‰å¼€å§‹è°ƒæ•´å­¦ä¹ ç‡ï¼Œè¿™æ˜¯éå¸¸å®ç”¨çš„å­¦ä¹ ç‡è°ƒæ•´ç­–ç•¥ã€‚<br>ä¾‹å¦‚ï¼Œå½“éªŒè¯é›†çš„ <code>loss</code> ä¸å†ä¸‹é™æ—¶ï¼Œè¿›è¡Œå­¦ä¹ ç‡è°ƒæ•´ï¼›æˆ–è€…ç›‘æµ‹éªŒè¯é›†çš„ <code>accuracy</code>ï¼Œå½“å…¶ä¸å†ä¸Šå‡æ—¶ï¼Œæ‰è°ƒæ•´å­¦ä¹ ç‡ã€‚</p><p>éƒ¨åˆ†å‚æ•°è§£é‡Šï¼š</p><ul><li><code>mode</code>ï¼ˆstrï¼‰ï¼šåªèƒ½æ˜¯ <code>min</code> æˆ– <code>max</code>ï¼ŒæŒ‡å®šæ˜¯çœ‹æŒ‡æ ‡ä¸Šå‡è¿˜æ˜¯ä¸‹é™ï¼›</li><li><code>factor</code>ï¼ˆfloatï¼‰ï¼šç­‰åŒäºå…¶ä»–æ–¹æ³•ä¸­çš„ <code>gamma</code>ï¼›</li><li><code>patience</code>ï¼ˆintï¼‰ï¼šåœ¨æŒ‡æ ‡åœæ­¢ä¼˜åŒ– <code>patience</code> ä¸ª <code>epoch</code> åå‡å°<code>lr</code>ï¼›</li><li><code>verbose</code>ï¼ˆboolï¼‰ï¼šå¦‚æœä¸º <code>True</code>ï¼Œåœ¨æ›´æ–° <code>lr</code>å <code>print</code>ä¸€ä¸ªæ›´æ–°ä¿¡æ¯ï¼Œé»˜è®¤ä¸º<code>False</code>ï¼›</li><li><code>threshold_mode</code> ï¼ˆstrï¼‰ï¼šé€‰æ‹©åˆ¤æ–­æŒ‡æ ‡æ˜¯å¦è¾¾æœ€ä¼˜çš„æ¨¡å¼ï¼Œæœ‰ä¸¤ç§æ¨¡å¼ï¼Œ <code>rel</code> å’Œ <code>abs</code>ã€‚</li></ul><h3 id="pytorch-warmupæ¨¡å—"><code>pytorch_warmup</code>æ¨¡å—</h3><div class="note default modern"><p>ğŸ‘¾<a target="_blank" rel="noopener" href="https://github.com/Tony-Y/pytorch_warmup">Tony-Y/pytorch_warmup: Learning Rate Warmup in PyTorch</a></p></div><p>è™½ç„¶ PyTorch å®˜æ–¹æä¾›äº†å­¦ä¹ ç‡å„ç§è°ƒæ•´çš„æ–¹æ³•ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è‡ªå¸¦ Warmup çš„æ–¹æ³•ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>pip install -U pytorch_warmup</code> å¯å®‰è£…æ­¤æ¨¡å—ã€‚</p><p>ä½œè€…ä¹Ÿæä¾›äº†ä¸åŒçš„é¢„çƒ­æ–¹æ³•ï¼Œå¯å‚è§ä»“åº“ <code>README.md</code>ã€‚ä¸‹é¢æˆ‘ä»¬ç»™å‡ºç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼ˆæ­é… scheduler ä½¿ç”¨ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> pytorch_warmup <span class="keyword">as</span> warmup</span><br><span class="line"></span><br><span class="line">optimizer = torch.optim.AdamW(params, lr=<span class="number">0.001</span>, betas=(<span class="number">0.9</span>, <span class="number">0.999</span>), weight_decay=<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line">num_steps = <span class="built_in">len</span>(dataloader) * num_epochs</span><br><span class="line"></span><br><span class="line">lr_scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=num_steps)</span><br><span class="line"></span><br><span class="line">warmup_scheduler = warmup.UntunedLinearWarmup(optimizer) <span class="comment">#Here</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,num_epochs+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> dataloader:</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss = ...</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">        <span class="keyword">with</span> warmup_scheduler.dampening(): <span class="comment"># Here</span></span><br><span class="line">            lr_scheduler.step()</span><br></pre></td></tr></table></figure><h2 id="è¶…å‚æ•°ä¼˜åŒ–">è¶…å‚æ•°ä¼˜åŒ–</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/590823641">è¶…å‚æ•°ä¼˜åŒ–å®Œæ•´æŒ‡å— (è¶…é•¿æ–‡ï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p><h2 id="PyTorch-Lightning">PyTorch Lightning</h2><p>PyTorch Lightning (PL) æ˜¯é¢å‘ä¸“ä¸šäººå·¥æ™ºèƒ½ç ”ç©¶äººå‘˜å’Œæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚å®ƒç»§æ‰¿è‡ª PyTorchï¼Œæ˜¯ PyTorch å†ä¸€æ¬¡ç»è¿‡å°è£…åå¾—åˆ°çš„ã€æ›´<strong>æ˜“äºå¿«é€Ÿæ­å»ºæ¨¡å‹</strong>çš„åº“ã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿæ›´æ˜“äºåœ¨å¤šå¡è®­ç»ƒæ—¶è¿›è¡Œè°ƒè¯•å·¥ä½œã€‚</p><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://lightning.ai/docs/pytorch/stable/">Welcome to âš¡ PyTorch Lightning â€” PyTorch Lightning documentation</a></p></blockquote><p>æ­¤å¤–ï¼Œæœ‰å­¦è€…é’ˆå¯¹ From PyTorch to PyTorchLightning åšäº†ä¸€äº›æ›´åŠ ä¾¿äº PL æ–°æ‰‹å¿«é€Ÿè¿ç§» PyTorch ä»£ç å’Œæ­å»ºé¡¹ç›®çš„å·¥ä½œã€‚æœ¬ç« ä¹Ÿå°†æ ¹æ®è¯¥æ–¹æ³•è¿›è¡Œç®€å•æ€»ç»“ã€‚</p><div class="note default modern"><p>ğŸ‘¾<a target="_blank" rel="noopener" href="https://github.com/miracleyoo/pytorch-lightning-template/tree/master">An easy/swift-to-adapt PyTorch-Lighting template. å¥—å£³æ¨¡æ¿ï¼Œç®€å•æ˜“ç”¨ï¼Œç¨æ”¹åŸæ¥Pytorchä»£ç ï¼Œå³å¯é€‚é…Lightning</a></p></div><h3 id="LightningModule">LightningModule</h3><p>PL ä¸­çš„ <code>LightningModule</code> ç›´æ¥å°† PyTorch çš„ä¸‹åˆ—å¯¹åº”çš„ç›¸å…³ä»£ç ç»Ÿåˆèµ·æ¥äº†ã€‚</p><ol><li>åˆå§‹åŒ– Initialization (<code>__init__()</code>Â andÂ <code>setup()</code>)</li><li>å‰å‘ä¼ æ’­ Forwardï¼ˆ<code>forward()</code>)</li><li>è®­ç»ƒå¾ªç¯ä½“ Train Loop (<code>training_step()</code>)</li><li>éªŒè¯å¾ªç¯ä½“ Validation Loop (<code>validation_step()</code>)</li><li>æµ‹è¯•å¾ªç¯ä½“ Test Loop (<code>test_step()</code>)</li><li>é¢„æµ‹å¾ªç¯ä½“ Prediction Loop (<code>predict_step()</code>)</li><li>ä¼˜åŒ–å™¨ä¸å­¦ä¹ ç‡ Optimizers and LR Schedulers (<code>configure_optimizers()</code>)</li></ol><h4 id="æ¨¡å‹æ„å»º">æ¨¡å‹æ„å»º</h4><p>ç±» <code>LightningModule</code> ä¸­çš„ <code>__init__(), steup(), forward()</code> æ–¹æ³•éƒ½æ˜¯ä¸ºæ¨¡å‹æœåŠ¡çš„ã€‚</p><p>äº‹å®ä¸Šï¼Œå®ƒä»¬çš„ä»£ç å¡«å†™æ–¹å¼å’Œ PyTorch å‡ ä¹æ²¡æœ‰åŒºåˆ«ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> lightning <span class="keyword">as</span> pl</span><br><span class="line"><span class="keyword">from</span> lightning.pytorch.demos <span class="keyword">import</span> Transformer</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LightningTransformer</span>(pl.LightningModule):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, vocab_size</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># (å¯é€‰) ä¿å­˜è®­ç»ƒè¿‡ç¨‹ä¸­çš„è¶…å‚æ•°åˆ° self.hparams å±æ€§ä¸­</span></span><br><span class="line">        self.save_hyperparameters() </span><br><span class="line">        <span class="comment"># å®šä¹‰æ¨¡å‹. </span></span><br><span class="line">        self.model = ...</span><br><span class="line"></span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">		<span class="keyword">return</span> self.model(x)</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯ä½“">å¾ªç¯ä½“</h4><p>åœ¨<code>LightningModule</code>ç±»ä¸­å®ç°<code>training_step()</code>æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">training_step</span>(<span class="params">self, batch, batch_idx</span>):</span><br><span class="line">	inputs, target = batch</span><br><span class="line">	output = self(inputs)</span><br><span class="line">	loss = self.loss_function(output, target) <span class="comment">#å®ç°å®šä¹‰å¥½çš„æŸå¤±å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># (å¯é€‰) æ˜¾ç¤ºepochä¸‹çš„lossæƒ…å†µ</span></span><br><span class="line">	self.log(<span class="string">&quot;train_loss&quot;</span>, loss, on_step=<span class="literal">True</span>, on_epoch=<span class="literal">True</span>, prog_bar=<span class="literal">True</span>, logger=<span class="literal">True</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> loss <span class="comment">#è‡³å°‘å¿…é¡»è¿”å›lossç”¨äºåç»­çš„åå‘ä¼ æ’­</span></span><br></pre></td></tr></table></figure><p>åœ¨è®­ç»ƒæ—¶ï¼ŒPLä¼šæ ¹æ®<code>training_step()</code>è‡ªåŠ¨é€šè¿‡ä¸‹é¢è¿™æ®µä¼ªä»£ç è¿›è¡Œè®­ç»ƒï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># enable gradient calculation</span></span><br><span class="line">torch.set_grad_enabled(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> batch_idx, batch <span class="keyword">in</span> <span class="built_in">enumerate</span>(train_dataloader):</span><br><span class="line">    loss = training_step(batch, batch_idx)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># clear gradients</span></span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># backward</span></span><br><span class="line">    loss.backward()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># update parameters</span></span><br><span class="line">    optimizer.step()</span><br></pre></td></tr></table></figure><h3 id="Trainer">Trainer</h3><p>Lightning çš„ <code>Trainer</code> çš„åŠŸèƒ½è¿œä¸æ­¢ â€œè®­ç»ƒâ€ è¿™ä¹ˆç®€å•ã€‚å®ƒè¿˜å¯ä»¥èƒ½å¤„ç†æ‰€æœ‰å¾ªç¯ä½“ä¸­çš„å…¶ä»–ç»†èŠ‚ï¼Œæ¯”å¦‚ï¼š</p><ol><li>è‡ªåŠ¨å¼€å¯æˆ–å…³é—­æ¢¯åº¦<br>Automatically enabling/disabling grads</li><li>é©±åŠ¨è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†çš„è¿­ä»£å™¨<br>Running the training, validation and test dataloaders</li><li>åœ¨é€‚å½“çš„æ—¶æœºè°ƒç”¨å¯è‡ªå®šä¹‰çš„ CallBack å‡½æ•°<br>Calling the Callbacks at the appropriate times</li><li>å°†æ‰¹é‡æ•°æ®å’Œè®¡ç®—ç»“æœè¿è¡Œåœ¨é€‚å½“çš„ CPU/GPU/TPU ä¸Š<br>Putting batches and computations on the correct devices</li></ol><h4 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h4><p>æœ€åŸºæœ¬çš„ä½¿ç”¨æƒ…å½¢ä¸‹ï¼Œåœ¨ä¸»å‡½æ•°ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>.fit()</code> æ–¹å¼å¼€å¯æ¨¡å‹è®­ç»ƒï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model = MyLightningModule()</span><br><span class="line"></span><br><span class="line">trainer = Trainer()</span><br><span class="line">Trainer.fit(model, train_dataloader=..., val_dataloaders=<span class="literal">None</span>, datamodule=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>è¾“å…¥ç¬¬ä¸€å˜é‡ä¸€å®šæ˜¯<code>LightningModule</code>å¯¹è±¡ï¼Œç„¶åå¯ä»¥è·Ÿä¸€ä¸ª <code>LigntningDataModule</code> å¯¹è±¡ï¼Œæˆ–ä¸€ä¸ªæ™®é€šçš„<code>Train DataLoader</code>ç”¨äºè®­ç»ƒã€‚å¦‚æœå®šä¹‰äº†éªŒè¯å¾ªç¯ä½“ï¼Œä¹Ÿè¦æœ‰ç”¨äºéªŒè¯çš„ <code>Val DataLoader</code>ã€‚</p><h3 id="Tuner">Tuner</h3><p><a target="_blank" rel="noopener" href="https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.tuner.tuning.Tuner.html#lightning.pytorch.tuner.tuning.Tuner">Tuner â€” PyTorch Lightning 2.1.2 documentation</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tunerÂ =Â Tuner(trainer)</span><br><span class="line">tuner.lr_find(model=model,Â train_dataloaders=...)</span><br></pre></td></tr></table></figure><h3 id="LightningDataModule">LightningDataModule</h3><h3 id="CheckPoint">CheckPoint</h3><h4 id="Callback">Callback</h4><p>å¯ä»¥é€šè¿‡è‡ªå®šä¹‰å‡½æ•°ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å®šä¹‰å¥½çš„æ—¶é—´è§¦å‘è¯¥å‡½æ•°ã€‚ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> lightning.pytorch.callbacks <span class="keyword">import</span> Callback</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PrintCallback</span>(<span class="title class_ inherited__">Callback</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">on_train_start</span>(<span class="params">self, trainer, pl_module</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Training is started!&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">on_train_end</span>(<span class="params">self, trainer, pl_module</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Training is done.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># single callback</span></span><br><span class="line">trainer = Trainer(callbacks=PrintCallback())</span><br><span class="line"></span><br><span class="line"><span class="comment"># a list of callbacks</span></span><br><span class="line">trainer = Trainer(callbacks=[PrintCallback()])</span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ¿æ¶æ„">æ¨¡æ¿æ¶æ„</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root-</span><br><span class="line">	|-data</span><br><span class="line">		|-__init__.py</span><br><span class="line">		|-data_interface.py</span><br><span class="line">		|-xxxdataset1.py</span><br><span class="line">		|-xxxdataset2.py</span><br><span class="line">		|-...</span><br><span class="line">	|-model</span><br><span class="line">		|-__init__.py</span><br><span class="line">		|-model_interface.py</span><br><span class="line">		|-xxxmodel1.py</span><br><span class="line">		|-xxxmodel2.py</span><br><span class="line">		|-...</span><br><span class="line">	|-main.py</span><br><span class="line">	|-utils.py</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿æ¶æ„ï¼š</p><ul><li><p>ä¸»ç›®å½•ä¸‹åªæ”¾ä¸€ä¸ª<code>main.py</code>æ–‡ä»¶å’Œä¸€ä¸ªç”¨äºè¾…åŠ©çš„<code>utils.py</code>ã€‚</p></li><li><p><code>data</code>å’Œ<code>modle</code>ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­æ”¾å…¥<code>__init__.py</code>æ–‡ä»¶ï¼ŒåšæˆåŒ…ã€‚è¿™æ ·æ–¹ä¾¿å¯¼å…¥ã€‚ä¸¤ä¸ª<code>init</code>æ–‡ä»¶åˆ†åˆ«æ˜¯ï¼š</p><ul><li><code>from .data_interface import DInterface</code></li><li><code>from .model_interface import MInterface</code></li></ul></li><li><p>åœ¨<code>data_interface</code> ä¸­å»ºç«‹ä¸€ä¸ª<code>class DInterface(pl.LightningDataModule):</code>ç”¨ä½œæ‰€æœ‰æ•°æ®é›†æ–‡ä»¶çš„æ¥å£ã€‚<code>__init__()</code>å‡½æ•°ä¸­importç›¸åº”Datasetç±»ï¼Œ<code>setup()</code>è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¹¶è€è€å®å®åŠ å…¥æ‰€éœ€è¦çš„çš„<code>train_dataloader</code>,Â <code>val_dataloader</code>,Â <code>test_dataloader</code>å‡½æ•°ã€‚è¿™äº›å‡½æ•°å¾€å¾€éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œå¯ä»¥ç”¨å‡ ä¸ªè¾“å…¥argsæ§åˆ¶ä¸åŒçš„éƒ¨åˆ†ã€‚</p></li><li><p>åŒç†ï¼Œåœ¨<code>model_interface</code> ä¸­å»ºç«‹<code>class MInterface(pl.LightningModule):</code>ç±»ï¼Œä½œä¸ºæ¨¡å‹çš„ä¸­é—´æ¥å£ã€‚<code>__init__()</code>å‡½æ•°ä¸­importç›¸åº”æ¨¡å‹ç±»ï¼Œç„¶åè€è€å®å®åŠ å…¥<code>configure_optimizers</code>,Â <code>training_step</code>,Â <code>validation_step</code>ç­‰å‡½æ•°ï¼Œç”¨ä¸€ä¸ªæ¥å£ç±»æ§åˆ¶æ‰€æœ‰æ¨¡å‹ã€‚ä¸åŒéƒ¨åˆ†ä½¿ç”¨è¾“å…¥å‚æ•°æ§åˆ¶ã€‚</p></li><li><p><code>main.py</code>å‡½æ•°åªè´Ÿè´£ï¼š</p><ul><li>å®šä¹‰parserï¼Œæ·»åŠ parseé¡¹ã€‚ï¼ˆæ³¨æ„å¦‚æœä½ çš„æ¨¡å‹æˆ–æ•°æ®é›†æ–‡ä»¶çš„<code>__init__</code>å‡½æ•°ä¸­æœ‰éœ€è¦å¤–éƒ¨æ§åˆ¶çš„å˜é‡ï¼Œå¦‚ä¸€ä¸ª<code>random_arg</code>ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨<code>main.py</code>çš„Parserä¸­æ·»åŠ è¿™æ ·ä¸€é¡¹ï¼Œå¦‚<code>parser.add_argument('--random_arg', default='test', type=str)</code>ï¼Œä¸¤ä¸ª<code>Interface</code>ç±»ä¼šè‡ªåŠ¨ä¼ å¯¼è¿™äº›å‚æ•°åˆ°ä½ çš„æ¨¡å‹æˆ–æ•°æ®é›†ç±»ä¸­ã€‚ï¼‰</li><li>é€‰å¥½éœ€è¦çš„<code>callback</code>å‡½æ•°ä»¬ï¼Œå¦‚è‡ªåŠ¨å­˜æ¡£ï¼ŒEarly Stopï¼ŒLR Schedulerç­‰ã€‚</li><li>å®ä¾‹åŒ–<code>MInterface</code>,Â <code>DInterface</code>,Â <code>Trainer</code>ã€‚</li></ul></li></ul><p>å®Œäº‹ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†å®ç°è‡ªåŠ¨åŠ å…¥æ–°modelå’Œdatasetè€Œä¸ç”¨æ›´æ”¹Interfaceï¼Œmodelæ–‡ä»¶å¤¹ä¸­çš„æ¨¡å‹æ–‡ä»¶ååº”è¯¥ä½¿ç”¨snake caseå‘½åï¼Œå¦‚<code>rdn_fuse.py</code>ï¼Œè€Œæ–‡ä»¶ä¸­çš„ä¸»ç±»åˆ™è¦ä½¿ç”¨å¯¹åº”çš„é©¼å³°å‘½åæ³•ï¼Œå¦‚<code>RdnFuse</code></strong>ã€‚</p><p>æ•°æ®é›†dataæ–‡ä»¶å¤¹ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><p>è™½ç„¶å¯¹å‘½åæå‡ºäº†è¾ƒç´§çš„è¦æ±‚ï¼Œä½†å®é™…ä¸Šå¹¶ä¸ä¼šå½±å“ä½¿ç”¨ï¼Œåè€Œè®©ä½ çš„ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ã€‚å¸Œæœ›ä½¿ç”¨æ—¶å€™å¯ä»¥æ³¨æ„è¿™ç‚¹ï¼Œä»¥å…æ— æ³•parseã€‚</p><h2 id="TensorBoard-å¯è§†åŒ–è®­ç»ƒ">TensorBoard å¯è§†åŒ–è®­ç»ƒ</h2><blockquote><p>å¾…æ›´ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/zeng001201/article/details/111309578">ã€pytorchã€‘ä½¿ç”¨tensorboardè¿›è¡Œå¯è§†åŒ–è®­ç»ƒ-CSDNåšå®¢</a><br><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/recipes/recipes/tensorboard_with_pytorch.html">How to use TensorBoard with PyTorch â€” PyTorch Tutorials 2.1.1+cu121 documentation</a></p></blockquote><h2 id="éƒ¨åˆ†æé€ŸæŠ€å·§">éƒ¨åˆ†æé€ŸæŠ€å·§</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/649721562">æ”¹åŠ¨ä¸€è¡Œä»£ç ï¼ŒPyTorchè®­ç»ƒä¸‰å€æé€Ÿï¼Œè¿™äº›ã€Œé«˜çº§æŠ€æœ¯ã€æ˜¯å…³é”® - æœºå™¨ä¹‹å¿ƒ</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/416310322">ç”¨ä¸ŠPytorch Lightningçš„è¿™å…­æ‹›ï¼Œæ·±åº¦å­¦ä¹ pipelineæé€Ÿ10å€ï¼ - çŸ¥ä¹</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/477457147">Pytorchå¦‚ä½•åŠ é€Ÿï¼Œè®©GPUåˆ©ç”¨ç‡ç»´æŒè¾ƒé«˜æ°´å¹³ï¼Ÿ - çŸ¥ä¹</a></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol><li><a target="_blank" rel="noopener" href="https://discuss.d2l.ai/">åŠ¨æ‰‹å­¦ä¹ æ·±åº¦å­¦ä¹ |D2L Discussion - Dive into Deep Learning</a></li><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/66543791">60åˆ†é’Ÿå¿«é€Ÿå…¥é—¨ PyTorch - çŸ¥ä¹</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43655233/article/details/112184267">PyTorchä¸­çš„éæ ‡é‡åå‘ä¼ æ’­-CSDNåšå®¢</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35091353/article/details/117322293">pytorchä¹‹warm-upé¢„çƒ­å­¦ä¹ ç­–ç•¥_pytorch warmup_è¿˜èƒ½åšæŒçš„åšå®¢-CSDNåšå®¢</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qyhaill/article/details/103043637">torch.optim.lr_schedulerï¼šè°ƒæ•´å­¦ä¹ ç‡-CSDNåšå®¢</a></li><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/353985363">Pytorch Lightning å®Œå…¨æ”»ç•¥ - çŸ¥ä¹</a></li></ol></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Pytorchæ¡†æ¶å­¦ä¹ æŒ‡å—</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://qslie.top/posts/381270c2/">https://qslie.top/posts/381270c2/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>Slie</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-09-13</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2024-03-11</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><a class="post-meta__tags" href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">ç¥ç»ç½‘ç»œ</a><a class="post-meta__tags" href="/tags/pytorch/">pytorch</a></div><div class="post_share"><div class="social-share" data-image="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202310081727970.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload='this.media="all"'><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æ‰“èµ</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png"></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/alipay.png"></a><div class="post-qr-code-desc"></div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3"></audio><script defer src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/d9cc7a33/" title="ç»“åˆé¥æ„Ÿä¸ç¤¾ä¼šæ„ŸçŸ¥çš„åŸå¸‚åŒºåŸŸåŠŸèƒ½è¯†åˆ«"><img class="cover" src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202309201647132.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ç»“åˆé¥æ„Ÿä¸ç¤¾ä¼šæ„ŸçŸ¥çš„åŸå¸‚åŒºåŸŸåŠŸèƒ½è¯†åˆ«</div></div></a></div><div class="next-post pull-right"><a href="/posts/f2d0fa09/" title="MRel-HGAN - åŸºäºæ—¶ç©ºAppä½¿ç”¨è¡Œä¸ºçš„ç”¨æˆ·ç”»åƒ"><img class="cover" src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202309121406416.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">MRel-HGAN - åŸºäºæ—¶ç©ºAppä½¿ç”¨è¡Œä¸ºçš„ç”¨æˆ·ç”»åƒ</div></div></a></div></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s1.ax1x.com/2022/04/09/Likong.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Slie</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">182</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">98</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">45</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sliefamily"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=1hPHFQqPhpkbBVYbFjRC4q8YQ-A72EFL&amp;noverify=0" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://github.com/SlieFamily" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:sliewdyinwhite@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ç§˜å¯†åŸºåœ°è¢«å‘ç°å•¦ï¼QAQ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">å®‰è£…ç¯å¢ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cuda"><span class="toc-number">1.1.</span> <span class="toc-text">Cuda</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tensors"><span class="toc-number">2.</span> <span class="toc-text">Tensors</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-Tensor"><span class="toc-number">2.1.</span> <span class="toc-text">åˆ›å»º Tensor</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.1.</span> <span class="toc-text">ç›´æ¥åˆ›å»º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8ENumpy%E4%B8%AD%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.2.</span> <span class="toc-text">ä»Numpyä¸­åˆ›å»º</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA-%E5%8A%A0%E8%BD%BD-Tensor"><span class="toc-number">2.2.</span> <span class="toc-text">å¯¼å‡º&amp;åŠ è½½ Tensor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">2.3.</span> <span class="toc-text">è¿ç®—ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%89%E5%85%83%E7%B4%A0%E8%BF%90%E7%AE%97"><span class="toc-number">2.3.1.</span> <span class="toc-text">æŒ‰å…ƒç´ è¿ç®—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.3.2.</span> <span class="toc-text">åˆ¤æ–­è¯­å¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E5%92%8C%E8%BF%90%E7%AE%97"><span class="toc-number">2.3.3.</span> <span class="toc-text">æ±‚å’Œè¿ç®—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%87%E5%80%BC%E8%AE%A1%E7%AE%97"><span class="toc-number">2.3.4.</span> <span class="toc-text">å‡å€¼è®¡ç®—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E7%82%B9%E7%A7%AF"><span class="toc-number">2.3.5.</span> <span class="toc-text">å‘é‡ç‚¹ç§¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%B9%98"><span class="toc-number">2.3.6.</span> <span class="toc-text">çŸ©é˜µç›¸ä¹˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#L2%E8%8C%83%E6%95%B0"><span class="toc-number">2.3.7.</span> <span class="toc-text">L2èŒƒæ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%94%E8%BF%9E%E7%BB%93-%E6%8B%BC%E6%8E%A5"><span class="toc-number">2.4.</span> <span class="toc-text">ğŸ””è¿ç»“&#x2F;æ‹¼æ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%94%E7%BB%B4%E5%BA%A6%E8%BD%AC%E6%8D%A2"><span class="toc-number">2.5.</span> <span class="toc-text">ğŸ””ç»´åº¦è½¬æ¢</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%B1%82%E5%AF%BC"><span class="toc-number">3.</span> <span class="toc-text">è‡ªåŠ¨æ±‚å¯¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%A0%87%E9%87%8F%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><span class="toc-number">3.1.</span> <span class="toc-text">éæ ‡é‡åå‘ä¼ æ’­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%A6%BB%E8%AE%A1%E7%AE%97"><span class="toc-number">3.2.</span> <span class="toc-text">åˆ†ç¦»è®¡ç®—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E6%B5%81%E7%9A%84%E6%A2%AF%E5%BA%A6"><span class="toc-number">3.3.</span> <span class="toc-text">æ§åˆ¶æµçš„æ¢¯åº¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%A4%84%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">æ•°æ®é›†å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E8%AF%BB%E5%8F%96%E5%8A%A0%E8%BD%BD%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">æ‰¹é‡è¯»å–åŠ è½½å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E6%95%B0%E6%8D%AE%E9%9B%86%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.2.</span> <span class="toc-text">æ„å»ºæ•°æ®é›†å¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">5.</span> <span class="toc-text">æ–‡ä»¶è¯»å†™</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AF%BB%E5%86%99"><span class="toc-number">5.1.</span> <span class="toc-text">æ¨¡å‹çš„è¯»å†™</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%AE%AD%E7%BB%83%E6%A8%A1%E6%9D%BF"><span class="toc-number">6.</span> <span class="toc-text">æ·±åº¦å­¦ä¹ è®­ç»ƒæ¨¡æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E4%BD%93%E6%A1%86%E6%9E%B6"><span class="toc-number">6.1.</span> <span class="toc-text">æ€»ä½“æ¡†æ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="toc-number">6.2.</span> <span class="toc-text">è‡ªå®šä¹‰ç½‘ç»œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%8F%82%E6%95%B0"><span class="toc-number">6.3.</span> <span class="toc-text">è®¿é—®å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%9A%84%E5%B8%B8%E8%A7%81%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">6.4.</span> <span class="toc-text">å‚æ•°çš„å¸¸è§åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A"><span class="toc-number">6.5.</span> <span class="toc-text">å‚æ•°ç»‘å®š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%99%A8%E9%80%89%E5%8F%96"><span class="toc-number">6.6.</span> <span class="toc-text">ä¼˜åŒ–å™¨é€‰å–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPU%E5%8A%A0%E9%80%9F"><span class="toc-number">6.7.</span> <span class="toc-text">GPUåŠ é€Ÿ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">7.</span> <span class="toc-text">å†…ç½®ç½‘ç»œå±‚</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%E4%BF%AE%E6%94%B9"><span class="toc-number">7.1.</span> <span class="toc-text">é¢„è®­ç»ƒæ¨¡å‹ä¿®æ”¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Warm-Up-%E9%A2%84%E7%83%AD%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-number">8.</span> <span class="toc-text">Warm-Up é¢„çƒ­å­¦ä¹ ç‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%AD%96%E7%95%A5"><span class="toc-number">8.1.</span> <span class="toc-text">å®ç°ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#constant-warmup"><span class="toc-number">8.1.1.</span> <span class="toc-text">constant warmup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gradual-warmup"><span class="toc-number">8.1.2.</span> <span class="toc-text">gradual warmup</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lr-scheduler%E6%A8%A1%E5%9D%97"><span class="toc-number">8.2.</span> <span class="toc-text">lr_scheduleræ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#torch-optim-lr-scheduler-LambdaLR"><span class="toc-number">8.2.1.</span> <span class="toc-text">torch.optim.lr_scheduler.LambdaLR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#torch-optim-lr-scheduler-StepLR"><span class="toc-number">8.2.2.</span> <span class="toc-text">torch.optim.lr_scheduler.StepLR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#torch-optim-lr-scheduler-MultiStepLR"><span class="toc-number">8.2.3.</span> <span class="toc-text">torch.optim.lr_scheduler.MultiStepLR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ExponentialLR-CosineAnnealingLR"><span class="toc-number">8.2.4.</span> <span class="toc-text">ExponentialLR &amp; CosineAnnealingLR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E9%80%82%E5%BA%94%E8%B0%83%E6%95%B4%E5%AD%A6%E4%B9%A0%E7%8E%87"><span class="toc-number">8.2.5.</span> <span class="toc-text">è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pytorch-warmup%E6%A8%A1%E5%9D%97"><span class="toc-number">8.3.</span> <span class="toc-text">pytorch_warmupæ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96"><span class="toc-number">9.</span> <span class="toc-text">è¶…å‚æ•°ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PyTorch-Lightning"><span class="toc-number">10.</span> <span class="toc-text">PyTorch Lightning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LightningModule"><span class="toc-number">10.1.</span> <span class="toc-text">LightningModule</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA"><span class="toc-number">10.1.1.</span> <span class="toc-text">æ¨¡å‹æ„å»º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E4%BD%93"><span class="toc-number">10.1.2.</span> <span class="toc-text">å¾ªç¯ä½“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Trainer"><span class="toc-number">10.2.</span> <span class="toc-text">Trainer</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="toc-number">10.2.1.</span> <span class="toc-text">æ¨¡å‹è®­ç»ƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tuner"><span class="toc-number">10.3.</span> <span class="toc-text">Tuner</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LightningDataModule"><span class="toc-number">10.4.</span> <span class="toc-text">LightningDataModule</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CheckPoint"><span class="toc-number">10.5.</span> <span class="toc-text">CheckPoint</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Callback"><span class="toc-number">10.5.1.</span> <span class="toc-text">Callback</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%9E%B6%E6%9E%84"><span class="toc-number">10.6.</span> <span class="toc-text">æ¨¡æ¿æ¶æ„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TensorBoard-%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AE%AD%E7%BB%83"><span class="toc-number">11.</span> <span class="toc-text">TensorBoard å¯è§†åŒ–è®­ç»ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E6%8F%90%E9%80%9F%E6%8A%80%E5%B7%A7"><span class="toc-number">12.</span> <span class="toc-text">éƒ¨åˆ†æé€ŸæŠ€å·§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">13.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/d3d469f8/" title="Docker - ä¸€æ­¥åˆ°ä½çš„åº”ç”¨éƒ¨ç½²ä¸ä¸Šçº¿"><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/docker.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Docker - ä¸€æ­¥åˆ°ä½çš„åº”ç”¨éƒ¨ç½²ä¸ä¸Šçº¿"></a><div class="content"><a class="title" href="/posts/d3d469f8/" title="Docker - ä¸€æ­¥åˆ°ä½çš„åº”ç”¨éƒ¨ç½²ä¸ä¸Šçº¿">Docker - ä¸€æ­¥åˆ°ä½çš„åº”ç”¨éƒ¨ç½²ä¸ä¸Šçº¿</a><time datetime="2024-03-05T07:11:45.000Z" title="å‘è¡¨äº 2024-03-05 15:11:45">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c1bb1ae1/" title="GFS - è°·æ­Œçš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ"><img src="http://img.49you.com/20170303/58b8d6f32d651.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="GFS - è°·æ­Œçš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ"></a><div class="content"><a class="title" href="/posts/c1bb1ae1/" title="GFS - è°·æ­Œçš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ">GFS - è°·æ­Œçš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ</a><time datetime="2024-03-05T04:04:07.000Z" title="å‘è¡¨äº 2024-03-05 12:04:07">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f21b6bc8/" title="HuskyLab Servers 0x519 æ“ä½œæŒ‡å—ã€è‡ªç”¨ã€‘"><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/husklab_bg.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="HuskyLab Servers 0x519 æ“ä½œæŒ‡å—ã€è‡ªç”¨ã€‘"></a><div class="content"><a class="title" href="/posts/f21b6bc8/" title="HuskyLab Servers 0x519 æ“ä½œæŒ‡å—ã€è‡ªç”¨ã€‘">HuskyLab Servers 0x519 æ“ä½œæŒ‡å—ã€è‡ªç”¨ã€‘</a><time datetime="2024-03-04T13:29:31.000Z" title="å‘è¡¨äº 2024-03-04 21:29:31">2024-03-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f7dae821/" title="ã€å¿«é€Ÿå…¥é—¨ã€‘é›†ç¾¤èµ„æºç®¡ç†è°ƒåº¦ç³»ç»Ÿ - Slurm"><img src="https://gitee.com/sliewdy/ImageURL-slie/raw/master/imagesNoT/QQ%E5%9B%BE%E7%89%8720210414005713.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="ã€å¿«é€Ÿå…¥é—¨ã€‘é›†ç¾¤èµ„æºç®¡ç†è°ƒåº¦ç³»ç»Ÿ - Slurm"></a><div class="content"><a class="title" href="/posts/f7dae821/" title="ã€å¿«é€Ÿå…¥é—¨ã€‘é›†ç¾¤èµ„æºç®¡ç†è°ƒåº¦ç³»ç»Ÿ - Slurm">ã€å¿«é€Ÿå…¥é—¨ã€‘é›†ç¾¤èµ„æºç®¡ç†è°ƒåº¦ç³»ç»Ÿ - Slurm</a><time datetime="2024-03-04T12:50:38.000Z" title="å‘è¡¨äº 2024-03-04 20:50:38">2024-03-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8cb817a9/" title="ã€æœ€ä¼˜åŒ–ã€‘Levenberg-Marquardt ç®—æ³•"><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202401051550627.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="ã€æœ€ä¼˜åŒ–ã€‘Levenberg-Marquardt ç®—æ³•"></a><div class="content"><a class="title" href="/posts/8cb817a9/" title="ã€æœ€ä¼˜åŒ–ã€‘Levenberg-Marquardt ç®—æ³•">ã€æœ€ä¼˜åŒ–ã€‘Levenberg-Marquardt ç®—æ³•</a><time datetime="2023-12-22T03:07:39.000Z" title="å‘è¡¨äº 2023-12-22 11:07:39">2023-12-22</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url('https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202310081727970.png')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By Slie</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Welcome to Chaos World!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/pluginsSrc/medium-zoom/dist/medium-zoom.min.js"></script><script src="/pluginsSrc/instant.page/instantpage.js" type="module"></script><script src="/pluginsSrc/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("/pluginsSrc/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><link rel="stylesheet" href="/pluginsSrc/katex/dist/katex.min.css"><script src="/pluginsSrc/katex/dist/contrib/copy-tex.min.js"></script><script>document.querySelectorAll("#article-container span.katex-display").forEach((a=>{btf.wrap(a,"div",{class:"katex-wrap"})}))</script><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then((({svg:e})=>{d.insertAdjacentHTML("afterend",e)}))}))},n=()=>{window.loadMermaid?t():getScript("/pluginsSrc/mermaid/dist/mermaid.min.js").then(t)};btf.addModeChange("mermaid",t),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.qslie.top/",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://twikoo.qslie.top/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.textContent=o[0].count})).catch((function(t){console.error(t)}))})()},o=()=>{"object"!=typeof twikoo?getScript("/pluginsSrc/twikoo/dist/twikoo.all.min.js").then(t):setTimeout(t,0)};btf.loadComment(document.getElementById("twikoo-wrap"),o)})()</script></div><script async src="/js/diytitle.js"></script><script async src="//at.alicdn.com/t/font_2264842_3izu8i5eoc2.js"></script><script async src="/js/diytitle.js"></script><script data-pjax defer src="/js/fixed_comment.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="/pluginsSrc/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"===location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/ç®—æ³•/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“š ç®—æ³•ç›¸å…³ï¼Œç¼–ç¨‹å®ç° (60)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/æ•…äº‹/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ“’ æ‚è°ˆæ—¥å¿—ï¼Œå…‰å½±è®°å½• (6)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/æ—¥å¸¸/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ’¡ è®°å¿†ç¢ç‰‡ï¼Œæ¢¦å¢ƒæ˜¾å½± (36)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/æœºå™¨å­¦ä¹ /"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ’» æœºå™¨å­¦ä¹ ï¼Œæ•°å­¦è§„åˆ’ (35)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://qslie.top/tags" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';console.log("å·²æŒ‚è½½magnet"),parent.insertAdjacentHTML("afterbegin",child)}</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(50% - 5px);background:#f2f2f2;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:#b30070}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style><script data-pjax>function butterfly_swiper_injector_config(){var s=document.getElementById("recent-posts");console.log("å·²æŒ‚è½½butterfly_swiper"),s.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/4f5fd499/" alt=""><img width="48" height="48" src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/20231030204417.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/4f5fd499/" alt="">Deep Neural Net | å¤šå±‚æ„ŸçŸ¥æœºä¸ç¥ç»ç½‘ç»œå…¥é—¨</a><div class="blog-slider__text">å†æ€ä¹ˆçœ‹æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæè¿°å®ƒçš„å•¦ï¼</div><a class="blog-slider__button" href="posts/4f5fd499/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/9a95977b/" alt=""><img width="48" height="48" src="math-cover.jfif" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/9a95977b/" alt="">SLieçš„&quot;æ•°å­¦åŸºç¡€&quot;é›†è£…ç®±|Perhaps.Ver1.04</a><div class="blog-slider__text">å¥½äº†ï¼Œä½ å·²ç»å­¦ä¼š1+1=2äº†ï¼Œä¸‹é¢æ¥è¯æ˜ä¸€ä¸‹å¹¿ä¹‰é»æ›¼çŒœæƒ³å§~</div><a class="blog-slider__button" href="posts/9a95977b/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/4ea9ab3c/" alt=""><img width="48" height="48" src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main/Auto/202202232045587.jpeg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/4ea9ab3c/" alt="">ç®—æ³•åˆ†æä¸è®¾è®¡ &amp; æœ¬ç«™ç®—æ³•ç»¼è¿°</a><div class="blog-slider__text">æœ¬æ–‡ç½—åˆ—äº†å¸¸è§çš„ç»å…¸é—®é¢˜å’Œç®—æ³•ï¼Œä»¥åŠä¸»è¦çš„ç®—æ³•åˆ†ææ–¹æ³•å’Œè®¾è®¡æ–¹æ³•</div><a class="blog-slider__button" href="posts/4ea9ab3c/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/5ebaa4d9/" alt=""><img width="48" height="48" src="https://gitee.com/sliewdy/ImageURL-slie/raw/master/imagesNoT/QQ%E5%9B%BE%E7%89%8720210414005713.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/5ebaa4d9/" alt="">æ£é¼“ç¨‹åºæ—¶çš„å„ç§ã€è¸©å‘ã€‘ã€æŠ¥é”™ã€‘å…¨æ”¶å½•</a><div class="blog-slider__text">é…ç½®ç¯å¢ƒã€å®‰è£…åº“åŒ…ç­‰ç½‘ä¸Šå†²æµªæ—¶é‡è§åˆ°çš„å„å¼å„æ ·å¥‡å¥‡æ€ªæ€ªçš„Warningå’ŒErrorï¼Œä»¥åŠå„ç§æ²»æ ‡ä¸æ²»æœ¬æˆ–è€…åˆæ²»æ ‡åˆæ²»æœ¬çš„è§£å†³æ–¹æ¡ˆå…¨è®°å½•ï¼ˆä¸ªäººå‘ï¼‰</div><a class="blog-slider__button" href="posts/5ebaa4d9/" alt="">è¯¦æƒ…   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="/",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script></body></html>