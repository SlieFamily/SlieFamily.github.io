<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Huffman、Optimal-BST &amp; MST| 算法之于树 | SLie's Blog|琴弦之轮</title><meta name="author" content="Slie"><meta name="copyright" content="Slie"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="哈夫曼树，最优二叉检索树和最小生成树？！数据结构树的拓展，树的种类增加力！"><link rel="shortcut icon" href="/img/%E7%A3%81%E5%B8%A6.png"><link rel="canonical" href="https://qslie.top/posts/900eb6a6/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/pluginsSrc/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,noticeOutdate:{limitDay:90,position:"top",messagePrev:"本文章距离上次修改已经过了",messageNext:"天，相关内容可能不再适用，请留意."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"mediumZoom",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-center"},source:{justifiedGallery:{js:"/pluginsSrc/flickr-justified-gallery/dist/fjGallery.min.js",css:"/pluginsSrc/flickr-justified-gallery/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Huffman、Optimal-BST & MST| 算法之于树",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-03-11 22:44:06"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,n)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=e,t&&(a.id=t),a.onerror=n,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,o())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/fixed_comment.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/twikoo_beautify.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s1.ax1x.com/2022/04/09/Likong.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">182</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">98</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">45</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>声影</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>相册</span></a></li><li><a class="site-page child" href="/films/"><i class="fa-fw fas fa-video"></i> <span>映像</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>图书</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/MST_Sample.png')"><nav id="nav"><span id="blog-info"><a href="/" title="SLie's Blog|琴弦之轮"><span class="site-name">SLie's Blog|琴弦之轮</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i> <span>声影</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>相册</span></a></li><li><a class="site-page child" href="/films/"><i class="fa-fw fas fa-video"></i> <span>映像</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>图书</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Huffman、Optimal-BST &amp; MST| 算法之于树</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-06T14:22:31.000Z" title="发表于 2022-01-06 22:22:31">2022-01-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-11T14:44:06.509Z" title="更新于 2024-03-11 22:44:06">2024-03-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF/">计算机科学与技术</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF/%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1/">算法分析与设计</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">11.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>53分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Huffman、Optimal-BST &amp; MST| 算法之于树"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img gist" style="background-image:url(https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/MST_Sample.png)"></div><article class="post-content" id="article-container"><h1>哈夫曼树|<sub>Huffman Tree</sub></h1><p>在数据通信中，如果允许对不同的字符采用不等长的二进制码进行表示，那么这种编码方式称为 <strong>可变长度编码（variable-length code）</strong>。该编码方式对使用频率较高的字符赋以短编码，从而使得字符的平均编码长度减小，实现了压缩数据的效果。</p><p><strong>哈夫曼编码</strong> 就是一种被广泛运用的数据压缩编码，通常可以节省 20%~90% 的空间。</p><p>如果没有一个编码是另一个编码的前缀，则称这样的编码是 <strong>前缀码（prefix code）</strong>。<br>例如 二进制串 <code>001011101</code>，如果根据前缀码的唯一性（没有二义性）的思路进行解码，那么可以得到<code>0,0,101,1101</code>，这个解码过程是没有歧义的。</p><p>前缀码被证明是可以保证达到最优数据压缩率的一种编码，而哈夫曼编码就是基于前缀码实现的。</p><h2 id="字符解码">字符解码</h2><p>在上面的例子中，我们并没有给出解码的过程。这里再展开阐述。<br>前缀码的解码依赖于二叉树，即我们可以通过构造二叉树的方式轻松对前缀码进行解码。</p><p>构造的二叉树应具有如下特点：</p><ol><li>叶子结点用于表示所给的的字符；</li><li>字符的二进制码通过根结点到对应的叶子结点的路径表示，“0”表示转向左子结点，“1”表示转向右子结点。</li></ol><div class="note default modern"><p>注：该二叉树并不是BST，其自己子结点并未有序排列，内部结点也不包含<code>key</code>.</p></div><p>如下图所示，按照这个解码逻辑以及给出的树，我们可以轻松解码刚刚的<code>001011101</code>为<code>aabe</code>。<br><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202203281215329.png" alt="解码示例"></p><p>文件的最优编码方案总是对应一棵 <strong>满二叉树</strong>。即任何树内的非叶子结点都有左右两个孩子。</p><h2 id="编码与形式化">编码与形式化</h2><p>我们为二叉树定义了一个衡量其是否最优的指标：<strong>带权路径长度</strong>。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">WPL=\sum_{i=1}^n w_il_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0269em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0197em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<strong>权</strong> 表示的是一棵树中结点被赋予某种意义的数值， <strong>路径长度</strong> 是从树根到任意结点经过的边数，而 <strong>WPL</strong> 就是我们定义的带权路径长度，由<strong>叶子结点</strong>与其上的权的乘积组成。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5806em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0269em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>就是第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span></span></span></span> 个叶子结点所带权值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">weight</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0197em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 就是第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span></span></span></span> 个叶子结点到根结点的路径长度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">length</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span></span>.</p><p>如果一棵二叉树使得 <strong>WPL</strong> 最小，那么这棵树我们就称为 <strong>最优二叉树</strong>。</p><p>根据前缀码的特点，以及二叉树的特性，我们引入 WPL 就可以得到类似的指标：<strong>平均传输位数</strong>。<br>二叉树的权用字符的出现频率表示，路径长度即是二进制码位数。</p><p>如果一棵二叉树的平均传输位数最小，那么其对应的编码方式我们就称为 <strong>最优前缀码</strong>。</p><hr><p>哈夫曼为了构造最优二叉树，利用了<strong>贪心算法</strong>的思想。</p><p>假定<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 是一个含有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 个字符的字符集合。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>c</mi><mo>∈</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">\forall c\in C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335em;vertical-align:-.0391em"></span><span class="mord">∀</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span>，用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">c.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">c</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 中的字符<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">c</span></span></span></span> 出现的<strong>频率</strong>。<br>于是，目标函数便是最优化 平均传输位数(WPL)：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo>=</mo><munder><mo>∑</mo><mrow><mi>c</mi><mo>∈</mo><mi>C</mi></mrow></munder><mi>c</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>×</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">WPL=\sum_{c\in C}c.freq\times d_T(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:.07153em">C</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">c</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_T(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span> 表示字符<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">c</span></span></span></span> 在二叉树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 中的深度。</p><p>算法伪代码如下：</p><ul><li>输入：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">C=\{c_1,c_2,...,c_n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></li><li>输出：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal">Q</span></span></span></span> 构造完成的二叉树</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>Algorithm: </mtext><mtext>  </mtext><mtext>HUFFMAN</mtext><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>1.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>n</mi><mo>←</mo><mi mathvariant="normal">∣</mi><mi>C</mi><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>2.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>Q</mi><mo>←</mo><mi>C</mi><mtext>  </mtext><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>Q</mi><mtext>为按频率 </mtext><mi>C</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mtext> 递增的优先队列</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>3.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mi>i</mi><mtext>  </mtext><mo>=</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi></mrow><mtext>  </mtext><mi>n</mi><mo>−</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>4.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>z</mi><mo>←</mo><mtext>Allocate-Node</mtext><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mtext>  </mtext><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext>生成一个新结点</mtext><mi>z</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>5.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>z</mi><mi mathvariant="normal">.</mi><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo>←</mo><mi>x</mi><mo>←</mo><mtext>Extract-min</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>6.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>z</mi><mi mathvariant="normal">.</mi><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>←</mo><mi>y</mi><mo>←</mo><mtext>Extract-min</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>7.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>z</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>←</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>+</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>7.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mtext>Insert</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>8.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">n</mi></mrow><mtext>  </mtext><mi>Q</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp;\text{Algorithm: }\;\text{HUFFMAN}(C)\\\\ 1.&amp;\;n\leftarrow|C|\\ 2.&amp;\;Q\leftarrow C\;//Q\text{为按频率 }C.freq\text{ 递增的优先队列}\\ 3.&amp;\;\mathbf{for}\;i\;=1\;\mathbf{to}\;n-1\;\mathbf{do}\\ 4.&amp;\;\qquad z\leftarrow \text{Allocate-Node}()\;//\text{生成一个新结点}z\\ 5.&amp;\;\qquad z.left\leftarrow x\leftarrow\text{Extract-min}(Q)\\ 6.&amp;\;\qquad z.right\leftarrow y\leftarrow\text{Extract-min}(Q)\\ 7.&amp;\;\qquad z.freq\leftarrow x.freq+y.freq\\ 7.&amp;\;\qquad \text{Insert}(Q,z)\\ 8.&amp;\;\mathbf{return}\;Q \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:16.5em;vertical-align:-8em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.5em"><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1.</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2.</span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3.</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4.</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">5.</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6.</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">7.</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">7.</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.5em"><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">Algorithm: </span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">HUFFMAN</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mclose">)</span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mord">∣</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">//</span><span class="mord mathnormal">Q</span><span class="mord text"><span class="mord cjk_fallback">为按频率</span><span class="mord"> </span></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord text"><span class="mord"> </span><span class="mord cjk_fallback">递增的优先队列</span></span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">to</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Allocate-Node</span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">//</span><span class="mord text"><span class="mord cjk_fallback">生成一个新结点</span></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Extract-min</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Extract-min</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord">Insert</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mclose">)</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">return</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>哈夫曼树的<strong>构造算法</strong>就是：自底向上地，将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>C</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|C|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mord">∣</span></span></span></span> 个叶子结点通过关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">c.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">c</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 的<strong>最小优先队列</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal">Q</span></span></span></span> 进行两两合并。合并得到的新对象，记其频率为构成该对象的原来两个对象的频率之和，放回队列中。<br>一共进行了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>C</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|C|-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 次合并后，得到结果。</p><p><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202203281238649.png" alt="算法流程示例"></p><p>如果优先队列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal">Q</span></span></span></span> 采用 <strong>最小二叉堆</strong> 实现，则每一次循环取出当前最小元的过程需要花费<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，循环次数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>，事先装载队列需要<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.<br>综合来看，该算法的时间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>，空间复杂度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>.</p><h2 id="正确性证明">正确性证明</h2><p>哈夫曼树的构造方法被证明完全能得到最优解，即其构造的二叉树的WPL一定最小。因此，我们<strong>也把最优二叉树叫做哈夫曼树</strong>。</p><p>下面给出其正确性的证明。</p><p>因为哈夫曼算法采用的是贪心策略，因此我们要证明其正确性需要从 <strong>贪心选择性质</strong> 和 <strong>最优子结构</strong> 两方面进行论证。</p><h3 id="贪心选择性质">贪心选择性质</h3><mark class="hl-label orange">贪心选择性质</mark> <mark class="hl-label green">引理1</mark><p>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∃</mi><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">\exists x,y \in C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord">∃</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">x.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">y.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 最小，则存在一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 的最优前缀码使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 的二进制码位数相等，且只有最后一位的数值不等。</p><details class="folding-tag" blue><summary>引理1的证明</summary><div class="content"><p><strong>证明</strong> 设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 是关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 的任意一个最优前缀码对应的最优二叉树。令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">b</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 中深度最大的两个叶结点（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo mathvariant="normal">≠</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a\neq b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">b</span></span></span></span>）<br>不妨设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mtext>  </mtext><mi mathvariant="normal">&amp;</mi><mi mathvariant="normal">&amp;</mi><mtext>  </mtext><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">a.freq \leq b.freq\;\&amp;\&amp;\; x.freq\leq y.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">&amp;&amp;</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span>.<br>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">b</span></span></span></span> 虽然深度最深，但其频率不一定最小，且一定不会比<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 还小。所以有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>a</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mtext>  </mtext><mtext>  </mtext><mtext>  </mtext><mspace linebreak="newline"></mspace><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">x.freq \leq a.freq\;\;\;\\y.freq \leq b.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></span></p><ul><li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">x.freq=b.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 时，由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">x.freq\leq y.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> ，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">x,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">b</span></span></span></span> 都是频率最低的，而已知<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 也是频率最低的两个字符中的一个，因此有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">b</span></span></span></span> 或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y=x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span></span></span></span> ，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">y.freq=x.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span>，最后有：</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>a</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>≤</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>⇒</mo><mi>a</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}x.freq \leq a.freq \leq b.freq =x.freq=y.freq\\\\\Rightarrow a.freq=b.freq=x.freq=y.freq\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mrel">⇒</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>这表明，如果将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">a,b,x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 的位置交换，不改变 WPL 的值，问题得证。</p><ul><li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo mathvariant="normal">≠</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">x.freq\neq b.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">b</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 时，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo mathvariant="normal">≠</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">x\neq b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal">b</span></span></span></span> 时，我们将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">x,a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">a</span></span></span></span> 进行交换，得到区别于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 的新树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">b</span></span></span></span> 进行交换，得到区别于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的新树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">T&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span>.<br>（注：如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>b</mi><mo separator="true">,</mo><mi>y</mi><mo mathvariant="normal">≠</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">x=b,y\neq a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">a</span></span></span></span> 那么上面的这个交换方法得到的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">T&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span> 中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 不是兄弟结点，即不会出现只有最后一位不等的情况）<br><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202203281407357.png" alt=""></li></ul><p>于是：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>−</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>c</mi><mo>∈</mo><mi>C</mi></mrow></munder><mi>c</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>×</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo>−</mo><munder><mo>∑</mo><mrow><mi>c</mi><mo>∈</mo><mi>C</mi></mrow></munder><mi>c</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>×</mo><msub><mi>d</mi><msup><mi>T</mi><mo>∗</mo></msup></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>−</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">[</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}WPL(T)-WPL(T&#x27;)&amp;=\sum_{c\in C}c.freq\times d_T(c)-\sum_{c\in C}c.freq\times d_{T^*}(c)\\&amp;=(a.freq-x.freq)[d_T(a)-d_T(x)]\\&amp;\geq 0\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.6717em;vertical-align:-2.5859em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0859em"><span style="top:-5.0859em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8019em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.6241em"><span class="pstrut" style="height:3.05em"></span><span class="mord"></span></span><span style="top:-1.1241em"><span class="pstrut" style="height:3.05em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5859em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0859em"><span style="top:-5.0859em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:.07153em">C</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">c</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:.07153em">C</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">c</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6183em"><span style="top:-2.786em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span style="top:-2.6241em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span><span style="top:-1.1241em"><span class="pstrut" style="height:3.05em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5859em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>类似地，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">)</mo><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">WPL(T&#x27;)-WPL(T&#x27;&#x27;)\geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">0</span></span></span></span>，从而得到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">WPL(T)\geq WPL(T&#x27;&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.<br>说明，交换后得到的新树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">T&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span> 的WPL 小于或等于 最优二叉树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span>。而最优二叉树的WPL是理论最小的，所以只有二者相等。即交换之后的新树仍为最优二叉树，问题得证。</p></div></details><h3 id="最优子结构">最优子结构</h3><mark class="hl-label orange">最优子结构性质</mark> <mark class="hl-label green">引理2</mark><p>令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo stretchy="false">(</mo><mi>C</mi><mo>−</mo><mo stretchy="false">{</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo>∪</mo><mi>z</mi><mo separator="true">,</mo><mspace width="1em"><mi>z</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>+</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">C&#x27;=(C-\{x,y\})\cup {z},\quad z.freq=x.freq+y.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">})</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">C&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的最优二叉树，则将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 中的结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span></span> 替换为以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 为左右子结点的内部节点从而生成的树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 的最优二叉树。</p><details class="folding-tag" blue><summary>引理2的证明</summary><div class="content"><p><strong>证明</strong> 根据题意，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>c</mi><mo>∈</mo><mi>C</mi><mo>−</mo><mo stretchy="false">{</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">}</mo><mo separator="true">,</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\forall c\in C-\{x,y\}, d_T(c)=d_{T&#x27;}(c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335em;vertical-align:-.0391em"></span><span class="mord">∀</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7667em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6828em"><span style="top:-2.786em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span> ，并且还有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d_T(x)=d_T(y)=d_{T&#x27;}(x)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6828em"><span style="top:-2.786em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span>.<br>于是就有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>+</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}WPL(T)&amp;=WPL(T&#x27;)+x.freq+y.freq\\WPL(T&#x27;)&amp;=WPL(T)-x.freq-y.freq\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8019em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em"><span style="top:-3.91em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8019em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>利用<strong>反证法</strong>。<br>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 不是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 的最优二叉树，则存在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>&lt;</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">WPL(T^*)\lt WPL(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span></span>.<br>由<mark class="hl-label green">定理1</mark> 可知，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 中存在频率最小的兄弟结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span></span></span></span> 。现将它们及其父结点替换为新的结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span></span></span></span>，并且令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>+</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">z.freq=x.freq+y.freq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span>，得到新的树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><msup><mo>∗</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">T^{*&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9425em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9425em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mbin mtight">∗</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8278em"><span style="top:-2.931em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>。<br>从而，有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><msup><mo>∗</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>&lt;</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>−</mo><mi>y</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo>=</mo><mi>W</mi><mi>P</mi><mi>L</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}WPL(T^{*&#x27;})&amp;=WPL(T^*)-x.freq-y.freq\\&amp;\lt WPL(T)-x.freq-y.freq=WPL(T&#x27;)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1525em;vertical-align:-1.3262em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8262em"><span style="top:-3.8338em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9925em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mbin mtight">∗</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8278em"><span style="top:-2.931em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.3338em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3262em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8262em"><span style="top:-3.8338em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7387em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span><span style="top:-2.3338em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8019em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3262em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>这说明，存在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><msup><mo>∗</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">T^{*&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9425em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9425em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mbin mtight">∗</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8278em"><span style="top:-2.931em;margin-right:.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">C&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的 WPL 最小，与已知条件矛盾。</p></div></details><hr><p><strong>哈夫曼算法的正确性</strong> 由 <mark class="hl-label green">引理1</mark> 和 <mark class="hl-label green">引理2</mark> 可知，哈夫曼算法能够得到最优解.</p><h2 id="编程实现">编程实现</h2><p>采用 <code>C++</code> 语言进行编程，此处利用了 <code>STL</code> 标准库中的<strong>优先队列</strong>（头文件<code>&lt;queue&gt;</code>）</p><p>因为哈夫曼树是二叉树的一种，因此考虑采用结构体的方式进行存储：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">HT</span>&#123;</span><br><span class="line">    <span class="type">int</span> freq; <span class="comment">//权重</span></span><br><span class="line">    <span class="type">char</span> key; <span class="comment">//字符内容</span></span><br><span class="line">    HT *left; <span class="comment">//左子结点 </span></span><br><span class="line">    HT *right; <span class="comment">//右子结点</span></span><br><span class="line">&#125;HuffmanTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span>&#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(HuffmanTree *a, HuffmanTree *b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a-&gt;freq &gt; b-&gt;freq;<span class="comment">//小的优先级高 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;; <span class="comment">//设置比较函数用于优先队列根据freq排序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line">    <span class="type">int</span> freq;</span><br><span class="line">&#125;CharSet; <span class="comment">//需要编码的字符结构体</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 优先队列</span></span><br><span class="line"><span class="keyword">typedef</span> priority_queue&lt;HuffmanTree*,vector&lt;HuffmanTree*&gt;,cmp&gt; HTqueue;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后是根据伪代码实现具体细则：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">CreateHuffmanTree</span><span class="params">(HTqueue &amp;Q, CharSet C[], <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 将字符集 C 导入 Q 并生成哈夫曼树</span></span><br><span class="line">    <span class="comment">// n 为字符个数</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        HuffmanTree *tmp = <span class="keyword">new</span> <span class="built_in">HuffmanTree</span>();</span><br><span class="line">        tmp-&gt;key = C[i].ch;</span><br><span class="line">        tmp-&gt;freq = C[i].freq;</span><br><span class="line">        tmp-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">        tmp-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        Q.<span class="built_in">push</span>(tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++)&#123;</span><br><span class="line">        HuffmanTree *tmp = <span class="keyword">new</span> <span class="built_in">HuffmanTree</span>();</span><br><span class="line">        HuffmanTree *left = Q.<span class="built_in">top</span>();  Q.<span class="built_in">pop</span>();</span><br><span class="line">        HuffmanTree *right = Q.<span class="built_in">top</span>();  Q.<span class="built_in">pop</span>();</span><br><span class="line">        tmp-&gt;left = left;</span><br><span class="line">        tmp-&gt;right = right;</span><br><span class="line">        tmp-&gt;freq = left-&gt;freq + right-&gt;freq;</span><br><span class="line">        tmp-&gt;key = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        Q.<span class="built_in">push</span>(tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编写函数实现哈夫曼编码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">OutputHuffmanCode</span><span class="params">(HuffmanTree *CodeTree, string code=<span class="string">&quot;&quot;</span>)</span></span>&#123;</span><br><span class="line">    <span class="comment">//先序遍历，并且利用code存储编码</span></span><br><span class="line">    <span class="keyword">if</span>(CodeTree-&gt;key != <span class="string">&#x27;\0&#x27;</span>)&#123;</span><br><span class="line">            cout &lt;&lt; CodeTree-&gt;key &lt;&lt; <span class="string">&quot;: (&quot;</span> &lt;&lt; CodeTree-&gt;freq &lt;&lt; <span class="string">&quot;)&quot;</span>;</span><br><span class="line">            cout &lt;&lt; code &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(CodeTree-&gt;left != <span class="literal">NULL</span> &amp;&amp; CodeTree-&gt;right != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">OutputHuffmanCode</span>(CodeTree-&gt;left,code+<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        <span class="built_in">OutputHuffmanCode</span>(CodeTree-&gt;right,code+<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实例演示</strong><br>考虑字符集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>a</mi><mo>:</mo><mn>45</mn><mo separator="true">,</mo><mi>b</mi><mo>:</mo><mn>13</mn><mo separator="true">,</mo><mi>c</mi><mo>:</mo><mn>12</mn><mo separator="true">,</mo><mi>d</mi><mo>:</mo><mn>16</mn><mo separator="true">,</mo><mi>e</mi><mo>:</mo><mn>9</mn><mo separator="true">,</mo><mi>f</mi><mo>:</mo><mn>5</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;a:45,b:13,c:12,d:16,e:9,f:5&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord">45</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">13</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord">12</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">16</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6835em;vertical-align:-.0391em"></span><span class="mord">5</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span></span></span></span><br>手工绘制得到如下哈夫曼结果：<br><svg id="SvgjsSvg1006" width="508.36248779296875" height="443.1875" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"></defs><g id="SvgjsG1008" transform="translate(152.28266033254158,25)"><path id="SvgjsPath1009" d="M0 30.900643316654754C0-10.300214438884918 62.00950118764846-10.300214438884918 62.00950118764846 30.900643316654754 62.00950118764846 72.10150107219442 0 72.10150107219442 0 30.900643316654754Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="43px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="19.150643316654754" transform="rotate(0)"></text></g></g><g id="SvgjsG1012" transform="translate(151.19477434679334,40.731236597569705)"><path id="SvgjsPath1013" d="M0 0 67.44893111638955 0 67.44893111638955 30.33881343817012 0 30.33881343817012Z" stroke="none" fill="none"></path><g id="SvgjsG1014"><text id="SvgjsText1015" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="68px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="3.4194067190850603" transform="rotate(0)"><tspan id="SvgjsTspan1016" dy="17" x="34"><tspan id="SvgjsTspan1017">100</tspan></tspan></text></g></g><g id="SvgjsG1018" transform="translate(51.10926365795723,123.3202287348106)"><path id="SvgjsPath1019" d="M0 0 65.27315914489311 0 65.27315914489311 52.8120085775554 0 52.8120085775554Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#c8e6c9"></path><g id="SvgjsG1020"><text id="SvgjsText1021" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="46px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="14.656004288777702" transform="rotate(0)"></text></g></g><g id="SvgjsG1022" transform="translate(46.75771971496437,135.6804860614725)"><path id="SvgjsPath1023" d="M0 0 72.88836104513064 0 72.88836104513064 29.215153681200857 0 29.215153681200857Z" stroke="none" fill="none"></path><g id="SvgjsG1024"><text id="SvgjsText1025" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="73px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.8575768406004283" transform="rotate(0)"><tspan id="SvgjsTspan1026" dy="17" x="36.5"><tspan id="SvgjsTspan1027">a: 45</tspan></tspan></text></g></g><g id="SvgjsG1028"><path id="SvgjsPath1029" d="M166.34677785179213 83.01085858324865 107.7293844357863 123.5363825887502" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1030" transform="translate(209.94061757719714,123.88205861329521)"><path id="SvgjsPath1031" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1032"><text id="SvgjsText1033" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1034" transform="translate(205.58907363420428,135.6804860614725)"><path id="SvgjsPath1035" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1036"><text id="SvgjsText1037" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1038" dy="17" x="30"><tspan id="SvgjsTspan1039">55</tspan></tspan></text></g></g><g id="SvgjsG1040"><path id="SvgjsPath1041" d="M201.73277130973156 82.35282685449761 226.0836078192109 125.0691839568918" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1042" transform="translate(109.85510688836104,203.38098641887063)"><path id="SvgjsPath1043" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1044"><text id="SvgjsText1045" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1046" transform="translate(105.50356294536817,215.17941386704786)"><path id="SvgjsPath1047" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1048"><text id="SvgjsText1049" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1050" dy="17" x="30"><tspan id="SvgjsTspan1051">25</tspan></tspan></text></g></g><g id="SvgjsG1052"><path id="SvgjsPath1053" d="M217.28023648641818 170.59209939644273 145.56702719018216 205.41193533899155" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1054" transform="translate(282.8289786223278,198.04360257326664)"><path id="SvgjsPath1055" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1056"><text id="SvgjsText1057" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1058" transform="translate(278.4774346793349,209.84203002144386)"><path id="SvgjsPath1059" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1060"><text id="SvgjsText1061" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1062" dy="17" x="30"><tspan id="SvgjsTspan1063">30</tspan></tspan></text></g></g><g id="SvgjsG1064"><path id="SvgjsPath1065" d="M252.19398909101892 172.4135059362826 296.090390888628 201.25221621868684" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1066" transform="translate(237.13776722090256,272.205146533238)"><path id="SvgjsPath1067" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1068"><text id="SvgjsText1069" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1070" transform="translate(232.7862232779098,284.0035739814153)"><path id="SvgjsPath1071" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1072"><text id="SvgjsText1073" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1074" dy="17" x="30"><tspan id="SvgjsTspan1075">14</tspan></tspan></text></g></g><g id="SvgjsG1076"><path id="SvgjsPath1077" d="M292.1251921683761 247.53108531762177 276.4762519375737 275.0179098110351" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1078" transform="translate(29.351543942992862,284.0035739814153)"><path id="SvgjsPath1079" d="M0 0 65.27315914489311 0 65.27315914489311 52.8120085775554 0 52.8120085775554Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#c8e6c9"></path><g id="SvgjsG1080"><text id="SvgjsText1081" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="46px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="14.656004288777702" transform="rotate(0)"></text></g></g><g id="SvgjsG1082" transform="translate(25,296.3638313080772)"><path id="SvgjsPath1083" d="M0 0 72.88836104513064 0 72.88836104513064 29.215153681200857 0 29.215153681200857Z" stroke="none" fill="none"></path><g id="SvgjsG1084"><text id="SvgjsText1085" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="73px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.8575768406004283" transform="rotate(0)"><tspan id="SvgjsTspan1086" dy="17" x="36.5"><tspan id="SvgjsTspan1087">c: 12</tspan></tspan></text></g></g><g id="SvgjsG1088" transform="translate(119.646080760095,284.56540385989996)"><path id="SvgjsPath1089" d="M0 0 65.27315914489311 0 65.27315914489311 52.8120085775554 0 52.8120085775554Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#c8e6c9"></path><g id="SvgjsG1090"><text id="SvgjsText1091" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="46px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="14.656004288777702" transform="rotate(0)"></text></g></g><g id="SvgjsG1092" transform="translate(115.29453681710214,296.92566118656185)"><path id="SvgjsPath1093" d="M0 0 72.88836104513064 0 72.88836104513064 29.215153681200857 0 29.215153681200857Z" stroke="none" fill="none"></path><g id="SvgjsG1094"><text id="SvgjsText1095" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="73px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.8575768406004283" transform="rotate(0)"><tspan id="SvgjsTspan1096" dy="17" x="36.5"><tspan id="SvgjsTspan1097">b: 13</tspan></tspan></text></g></g><g id="SvgjsG1098"><path id="SvgjsPath1099" d="M110.17645188388855 243.63218823532122 62.75466450566017 283.3613785981312" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1100"><path id="SvgjsPath1101" d="M149.5690391094143 253.1787658213584 152.19652381731066 283.5691205162954" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1102" transform="translate(168.60095011876479,364.62616154396)"><path id="SvgjsPath1103" d="M0 0 65.27315914489311 0 65.27315914489311 52.8120085775554 0 52.8120085775554Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#c8e6c9"></path><g id="SvgjsG1104"><text id="SvgjsText1105" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="46px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="14.656004288777702" transform="rotate(0)"></text></g></g><g id="SvgjsG1106" transform="translate(164.24940617577198,376.9864188706219)"><path id="SvgjsPath1107" d="M0 0 72.88836104513064 0 72.88836104513064 29.215153681200857 0 29.215153681200857Z" stroke="none" fill="none"></path><g id="SvgjsG1108"><text id="SvgjsText1109" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="73px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.8575768406004283" transform="rotate(0)"><tspan id="SvgjsTspan1110" dy="17" x="36.5"><tspan id="SvgjsTspan1111">f: 5</tspan></tspan></text></g></g><g id="SvgjsG1112" transform="translate(269.7743467933492,365.1879914224446)"><path id="SvgjsPath1113" d="M0 0 65.27315914489311 0 65.27315914489311 52.8120085775554 0 52.8120085775554Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#c8e6c9"></path><g id="SvgjsG1114"><text id="SvgjsText1115" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="46px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="14.656004288777702" transform="rotate(0)"></text></g></g><g id="SvgjsG1116" transform="translate(265.4228028503562,377.5482487491065)"><path id="SvgjsPath1117" d="M0 0 72.88836104513064 0 72.88836104513064 29.215153681200857 0 29.215153681200857Z" stroke="none" fill="none"></path><g id="SvgjsG1118"><text id="SvgjsText1119" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="73px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.8575768406004283" transform="rotate(0)"><tspan id="SvgjsTspan1120" dy="17" x="36.5"><tspan id="SvgjsTspan1121">e: 9</tspan></tspan></text></g></g><g id="SvgjsG1122"><path id="SvgjsPath1123" d="M243.01835015696736 317.6390123259072 210.50941748129696 364.6464304233787" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1124"><path id="SvgjsPath1125" d="M280.4618766896149 319.10590357125017 301.9809097689463 364.2851704399492" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1126" transform="translate(342.6627078384797,275.15475339528234)"><path id="SvgjsPath1127" d="M0 0 65.27315914489311 0 65.27315914489311 52.8120085775554 0 52.8120085775554Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#c8e6c9"></path><g id="SvgjsG1128"><text id="SvgjsText1129" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="46px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="14.656004288777702" transform="rotate(0)"></text></g></g><g id="SvgjsG1130" transform="translate(338.31116389548697,287.51501072194424)"><path id="SvgjsPath1131" d="M0 0 72.88836104513064 0 72.88836104513064 29.215153681200857 0 29.215153681200857Z" stroke="none" fill="none"></path><g id="SvgjsG1132"><text id="SvgjsText1133" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="73px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.8575768406004283" transform="rotate(0)"><tspan id="SvgjsTspan1134" dy="17" x="36.5"><tspan id="SvgjsTspan1135">d: 16</tspan></tspan></text></g></g><g id="SvgjsG1136"><path id="SvgjsPath1137" d="M332.53893834686073 238.0273147954939 374.54419704506313 274.4991326669793" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1138" transform="translate(351.36579572446556,40.731236597569705)"><path id="SvgjsPath1139" d="M0 0 131.63420427553444 0 131.63420427553444 146.49714081486775 0 146.49714081486775Z" stroke="none" fill="none"></path><g id="SvgjsG1140"><text id="SvgjsText1141" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="17px" width="132px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="17px" weight="700" font-style="" opacity="1" y="5.123570407433874" transform="rotate(0)"><tspan id="SvgjsTspan1142" dy="21" x="66"><tspan id="SvgjsTspan1143">a：0</tspan></tspan><tspan id="SvgjsTspan1144" dy="21" x="66"><tspan id="SvgjsTspan1145">b：101</tspan></tspan><tspan id="SvgjsTspan1146" dy="21" x="66"><tspan id="SvgjsTspan1147">c：100</tspan></tspan><tspan id="SvgjsTspan1148" dy="21" x="66"><tspan id="SvgjsTspan1149">d：111</tspan></tspan><tspan id="SvgjsTspan1150" dy="21" x="66"><tspan id="SvgjsTspan1151">e：1101</tspan></tspan><tspan id="SvgjsTspan1152" dy="21" x="66"><tspan id="SvgjsTspan1153">f：1100</tspan></tspan></text></g></g></svg></p><p>下面通过调用算法查看.</p><p>主函数：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    HTqueue Q;</span><br><span class="line">    CharSet C[<span class="number">6</span>]=&#123;&#123;<span class="string">&#x27;a&#x27;</span>,<span class="number">45</span>&#125;,&#123;<span class="string">&#x27;b&#x27;</span>,<span class="number">13</span>&#125;,&#123;<span class="string">&#x27;c&#x27;</span>,<span class="number">12</span>&#125;,&#123;<span class="string">&#x27;d&#x27;</span>,<span class="number">16</span>&#125;,&#123;<span class="string">&#x27;e&#x27;</span>,<span class="number">9</span>&#125;,&#123;<span class="string">&#x27;f&#x27;</span>,<span class="number">5</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">CreateHuffmanTree</span>(Q, C, <span class="number">6</span>);</span><br><span class="line">    <span class="built_in">OutputHuffmanCode</span>(Q.<span class="built_in">top</span>());</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;END&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a: (45)0</span><br><span class="line">c: (12)100</span><br><span class="line">b: (13)101</span><br><span class="line">f: (5)1100</span><br><span class="line">e: (9)1101</span><br><span class="line">d: (16)111</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>Prefect！</p><h1>最优二叉检索树|<sub>Optimal Binary Search Tree</sub></h1><p>哈夫曼树，也被称作最优二叉树，是通过建立一棵二叉树，对指定频率的字符进行编码，从而使得字符的平均编码长度达到最低，实现了数据的压缩。</p><p>而最优二叉检索树则是为了实现对于给定频率的字符，建立BST使得搜索效率最高。</p><p>例如想要实现对某英文文本中一个单词的快速查找并翻译，我们可以建立一棵 <strong>二叉搜索树</strong>（BST） 存储英文单词，而对于英文中出现频率很高的 <code>the</code> 这一单词，我们希望它在 BST 中更靠近根结点，这样可以很快检索到它。这种使得所有搜索过程中，访问结点个数最少（也就是搜索效率最高）的 BST，就被称为 <strong>最优二叉检索树</strong>（OBST）。</p><h2 id="形式化表达">形式化表达</h2><p>给定<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 个不同关键字（key）的<strong>已排序</strong>序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mo>&lt;</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>k</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>k</mi><mi>n</mi></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">K=&lt;k_1,k_2,...,k_n&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7224em;vertical-align:-.0391em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>k</mi><mn>2</mn></msub><mo>&lt;</mo><mo>⋯</mo><mo>&lt;</mo><msub><mi>k</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">k_1\lt k_2\lt\cdots\lt k_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>.<br>每个关键词附有一个属性<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">k_i.p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span></span> 表示该关键字的搜索频率，即一个待搜索的关键字<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的概率.<br>此外，还存在有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 个伪关键字<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">d_0,d_1,...,d_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 坐落在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 的<strong>空隙</strong>中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>i</mi><mo mathvariant="normal">≠</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo mathvariant="normal">≠</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\forall i\neq0,i\neq n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord">∀</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 表示在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k_i,k_{i+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 内的所有关键字，而<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>0</mn></msub><mo>:</mo><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo separator="true">,</mo><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>  </mtext><msub><mi>d</mi><mi>n</mi></msub><mo>:</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>n</mi></msub><mo separator="true">,</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">d_0:(-\infty,k_1),\;d_n:(k_n,+\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∞</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">+</span><span class="mord">∞</span></span></span></span>).<br>伪关键字也有属性<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">d_i.p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span></span> 表示它所表示的那个范围的搜索频率，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span></span></span></span> 在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 表示范围内的概率.</p><p>自然有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>k</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^nk_i.p+\sum_{i=0}^nd_i.p=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span></span></p><p>对上述关键字序列建立任意一棵 BST，显然代表空隙的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 始终作为<strong>叶子结点</strong>出现。一个示例如下图所示：</p><div width="100%" style="overflow-x:auto"><svg width="460.5" height="317.75" xmlns="http://www.w3.org/2000/svg"><path d="M174.696 51.45c0-35.266 54.708-35.266 54.708 0s-54.708 35.266-54.708 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M168.57 38.466h59.506v25.968H168.57Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(168.57 38.466)"><tspan dy="28" x="30"><tspan>k</tspan></tspan></text><path d="M192.467 41.319h29.96v25.969h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(192.467 41.319)"><tspan dy="18" x="15"><tspan>2</tspan></tspan></text><path d="M102.838 127.737c0-35.266 54.708-35.266 54.708 0 0 35.267-54.708 35.267-54.708 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M96.712 114.753h59.506v25.969H96.712Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(96.712 114.753)"><tspan dy="28" x="30"><tspan>k</tspan></tspan></text><path d="M120.609 117.606h29.96v25.969h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(120.609 117.606)"><tspan dy="18" x="15"><tspan>1</tspan></tspan></text><path d="M262.417 127.737c0-35.266 54.708-35.266 54.708 0 0 35.267-54.708 35.267-54.708 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M256.29 114.753h59.507v25.969h-59.506Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(256.29 114.753)"><tspan dy="28" x="30"><tspan>k</tspan></tspan></text><path d="M280.188 117.606h29.96v25.969h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(280.188 117.606)"><tspan dy="18" x="15"><tspan>4</tspan></tspan></text><path d="M188.558 204.746c0-35.266 54.708-35.266 54.708 0 0 35.267-54.708 35.267-54.708 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M182.432 191.762h59.506v25.969h-59.506Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(182.432 191.762)"><tspan dy="28" x="30"><tspan>k</tspan></tspan></text><path d="M206.329 194.615h29.96v25.969h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(206.329 194.615)"><tspan dy="18" x="15"><tspan>3</tspan></tspan></text><path d="M330.098 204.746c0-35.266 54.707-35.266 54.707 0 0 35.267-54.707 35.267-54.707 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M323.971 191.762h59.507v25.969H323.97Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(323.971 191.762)"><tspan dy="28" x="30"><tspan>k</tspan></tspan></text><path d="M347.869 194.615h29.959v25.969h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(347.869 194.615)"><tspan dy="18" x="15"><tspan>5</tspan></tspan></text><path d="m180.859 70.018-40.002 32.885M222.533 67.833l46.79 40.256M273.214 149.972l-37.5 35.272M307.058 149.771l37.717 27.628" stroke="#323232" stroke-width="2" fill="none"/><path d="M33.067 166.947H87.92v46.873H33.067Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="M25.001 178.553h59.507v25.969H25Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(25.001 178.553)"><tspan dy="28" x="30"><tspan>d</tspan></tspan></text><path d="M51.145 181.406h29.96v25.97h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(51.145 181.406)"><tspan dy="18" x="15"><tspan>0</tspan></tspan></text><path d="m104.968 140.502-36.193 26.445" stroke="#323232" stroke-width="2" fill="none"/><path d="M128.674 165.793h54.854v46.873h-54.854Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="M120.609 177.399h59.506v25.969H120.61Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(120.609 177.399)"><tspan dy="28" x="30"><tspan>d</tspan></tspan></text><path d="M146.753 180.252h29.96v25.969h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(146.753 180.252)"><tspan dy="18" x="15"><tspan>1</tspan></tspan></text><path d="m145.054 149.674 20.013 16.119" stroke="#323232" stroke-width="2" fill="none"/><path d="M133.704 245.752h54.854v46.872h-54.854Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="M125.639 257.358h59.506v25.968H125.64Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(125.639 257.358)"><tspan dy="28" x="30"><tspan>d</tspan></tspan></text><path d="M151.783 260.21h29.96v25.97h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(151.783 260.21)"><tspan dy="18" x="15"><tspan>2</tspan></tspan></text><path d="m201.261 227.49-29.63 17.905" stroke="#323232" stroke-width="2" fill="none"/><path d="M217.726 245.752h54.854v46.872h-54.854Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="M217.896 257.358h59.506v25.968h-59.506Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(217.896 257.358)"><tspan dy="28" x="30"><tspan>d</tspan></tspan></text><path d="M243.266 260.21h29.96v25.97h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(243.266 260.21)"><tspan dy="18" x="15"><tspan>3</tspan></tspan></text><path d="m234.318 225.496 10.363 19.374" stroke="#323232" stroke-width="2" fill="none"/><path d="M288.253 245.752h54.854v46.872h-54.854Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="M280.188 257.358h59.506v25.968h-59.506Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(280.188 257.358)"><tspan dy="28" x="30"><tspan>d</tspan></tspan></text><path d="M306.332 260.21h29.96v25.97h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(306.332 260.21)"><tspan dy="18" x="15"><tspan>4</tspan></tspan></text><path d="m338.732 225.154-12.866 19.918" stroke="#323232" stroke-width="2" fill="none"/><path d="M380.51 245.752h54.854v46.872H380.51Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="M372.445 257.358h59.506v25.968h-59.506Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(372.445 257.358)"><tspan dy="28" x="30"><tspan>d</tspan></tspan></text><path d="M398.589 260.21h29.96v25.97h-29.96Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(398.589 260.21)"><tspan dy="18" x="15"><tspan>5</tspan></tspan></text><path d="m380.231 221.64 26.952 23.455" stroke="#323232" stroke-width="2" fill="none"/></svg></div><p>通过 BST 搜索某个结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span></span></span></span> 时，需要访问的结点数就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d_T(x)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span>，我们就将访问结点数作为一个关键字的搜索代价。（其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_T(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span> 表示字符<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">x</span></span></span></span> 在二叉搜索树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 中的深度）</p><p>那么与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>P</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WPL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal">L</span></span></span></span> 类似，一个最优二叉检索树的<strong>期望代价</strong>：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>E</mi><mo stretchy="false">[</mo><mtext>Search cost in </mtext><mi>T</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">[</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>×</mo><msub><mi>k</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mo stretchy="false">[</mo><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><msub><mi>d</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>×</mo><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>×</mo><msub><mi>k</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>d</mi><mi>T</mi></msub><mo stretchy="false">(</mo><msub><mi>d</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>×</mo><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} E[\text{Search cost in }T]&amp;=\sum_{i=1}^n[d_T(k_i)+1]\times k_i.p+\sum_{i=0}^n[d_T(d_i)+1]\times d_i.p\\ &amp;=1+\sum_{i=1}^nd_T(k_i)\times k_i.p+\sum_{i=0}^nd_T(d_i)\times d_i.p \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.4581em;vertical-align:-2.9791em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.4791em"><span style="top:-5.4791em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mord text"><span class="mord">Search cost in </span></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">]</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9791em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.4791em"><span style="top:-5.4791em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.6514em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9791em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>求解最优二叉检索树就是找到这样一棵二叉搜索树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> ，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(T^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 最小.</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>T</mi></munder><mi>E</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T^*=\arg\max_{T}E(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7387em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7387em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.4943em;vertical-align:-.7443em"></span><span class="mop">ar<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.4306em"><span style="top:-2.3557em;margin-left:0"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.7443em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span></span></span></p><h2 id="问题分析">问题分析</h2><p>构造一棵任意的 BST 是简单的。我们只需对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 进行全排列，以排列后的序列第一个元素作为根结点，依照 BST 的构建方法逐步添加结点，直到所有的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 加入树中，然后再填补空隙<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 作为叶子结点即可。这样能得到所有可能的 BST（含重复），即便如此，搜索所有可能的解空间需要消耗的时间也十分巨大。</p><p>《算法导论》一书中指出，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 个结点的二叉树（虽然并不是BST）数量在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><msup><mn>4</mn><mi>n</mi></msup><mi mathvariant="normal">/</mi><msup><mi>n</mi><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(4^n/n^{3/2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-.25em"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6644em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.888em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ，所以暴力穷举求解是十分困难的，存在<strong>指数爆炸问题</strong>。因此下面将介绍一种使用<strong>动态规划</strong>求解 OBST 的算法。</p><h2 id="状态转移方程">状态转移方程</h2><p>现在我们<strong>从后往前</strong>思考，对于一棵以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为根结点的 BST，其搜索代价必然<strong>包含</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 本身的代价，以及由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 所划分的左右子树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext>  </mtext><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_1,\;T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的搜索代价.</p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是由全体小于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的关键字子序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mi>K</mi><mo>&lt;</mo><msub><mi>k</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>k</mi><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">K_1:=K&lt;k_1..k_{r-1}&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7224em;vertical-align:-.0391em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.9028em;vertical-align:-.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">..</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span></span></span></span> 构成，当然还包括伪关键字（空隙）的子序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>1</mn></msub><mo>=</mo><mi>D</mi><mo>&lt;</mo><msub><mi>d</mi><mn>0</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>d</mi><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">D_1=D&lt;d_0..d_{r-1}&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7224em;vertical-align:-.0391em"></span><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.9028em;vertical-align:-.2083em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">..</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span></span></span></span>；<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 是由全体大于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的关键字子序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mi>K</mi><mo>&lt;</mo><msub><mi>k</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>k</mi><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">K_2:=K&lt;k_1..k_{r-1}&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0715em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7224em;vertical-align:-.0391em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.9028em;vertical-align:-.2083em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">..</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span></span></span></span> 及其对应的空隙子序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">D_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0278em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 构成。</p><div width="100%" style="overflow-x:auto"><svg width="529" height="273" xmlns="http://www.w3.org/2000/svg"><path d="M25.01 29.01q0-4 4-4H500.24q4 0 4 4v214.848q0 4-4 4H29.01q-4 0-4-4Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M276.016 137.2q0-4 4-4h201.073q4 0 4 4v71.943q0 4-4 4H280.016q-4 0-4-4ZM52.999 137.2q0-4 4-4h201.073q4 0 4 4v71.943q0 4-4 4H56.999q-4 0-4-4Z" stroke-dasharray="10,6,3,6" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"/><path d="M240.999 96.828c0-35.266 54.707-35.266 54.707 0S241 132.094 241 96.828Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#fff"/><path d="M234.872 83.843h59.507v25.97h-59.507Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="400" font-style="italic" y="-7.391" transform="translate(234.872 83.843)"><tspan dy="28" x="30"><tspan>k</tspan></tspan></text><path d="M78.08 151.05h166.512v44.243H78.081Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="m253.409 120.237-32.265 30.78" stroke="#323232" stroke-width="2" fill="none"/><path d="M255.493 86.697h38.632v25.969h-38.632Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" font-style="italic" y=".609" transform="translate(255.493 86.697)"><tspan dy="18" x="19.5"><tspan>r</tspan></tspan></text><path d="M89.978 158.318h146.667v29.708H89.978Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="14" fill="#323232" font-weight="700" font-style="italic" y="-5.396" transform="translate(89.978 158.318)"><tspan dy="17" x="73.5"><tspan>K1:</tspan></tspan><tspan dy="17" x="73.5"><tspan>&lt;k1,k2,...,kr-1&gt;</tspan></tspan></text><path d="M291.969 151.05H458.48v44.243H291.97Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill="#c8e6c9"/><path d="m288.638 116.595 30.199 33.54" stroke="#323232" stroke-width="2" fill="none"/><path d="M306.087 161.383H445.09v23.577H306.087Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="14" fill="#323232" font-weight="700" font-style="italic" y="-8.462" transform="translate(306.087 161.383)"><tspan dy="17" x="70"><tspan>K2:</tspan></tspan><tspan dy="17" x="70"><tspan>&lt;kr+1,kr+2,...,kn&gt;</tspan></tspan></text><path d="M44.182 43.185h32.86v17.12h-32.86Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="19" fill="#323232" font-weight="700" font-style="italic" y="-7.815" transform="translate(44.182 43.185)"><tspan dy="23" x="16.5"><tspan>T</tspan></tspan></text><path d="M57.117 109.812h32.861v17.12h-32.86Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="19" fill="#323232" font-weight="700" font-style="italic" y="-7.815" transform="translate(57.117 109.812)"><tspan dy="23" x="16.5"><tspan>T1</tspan></tspan></text><path d="M437.145 109.812h32.86v17.12h-32.86Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="19" fill="#323232" font-weight="700" font-style="italic" y="-7.815" transform="translate(437.145 109.812)"><tspan dy="23" x="16.5"><tspan>T2</tspan></tspan></text></svg></div><p>并且，以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">k_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 作为根结点时的二叉树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 比之其左右子树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>2</mn></msub><mo separator="true">,</mo><mtext>  </mtext><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_2,\;T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 深度多了正好<strong>一个单位</strong>。<br>从而，有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">[</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><msub><mi>k</mi><mi>r</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">[</mo><mi>w</mi><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mi>r</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} E(T)&amp;=[E(T_1)+w(1,k-1)]+[E(T_2)+w(k+1,n)]+k_r.p\\ &amp;=E(T_1)+E(T_2)+[w(1,k-1)+w(k+1,n)+k_r.p]\\ &amp;=E(T_1)+E(T_2)+w(1,n) \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em"><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">)]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(1,k-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 是左子树深度增加一位之后，比起<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(T_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 来<strong>多出来的搜索代价</strong>，右子树同理。不难给出对于任意<strong>新增代价</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span> 的表达式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mi>i</mi></mrow><mi>j</mi></munderover><msub><mi>k</mi><mi>l</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mi>j</mi></munderover><msub><mi>d</mi><mi>l</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">w(i,j)=\sum_{l=i}^jk_l.p+\sum_{l=i-1}^jd_l.p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:3.1609em;vertical-align:-1.3021em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8588em"><span style="top:-1.8479em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3471em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:3.2192em;vertical-align:-1.3604em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8588em"><span style="top:-1.8479em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3471em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3604em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span></span></span></p><p>事实上，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext>  </mtext><msub><mi>T</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">T_1,\;T_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.1389em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 正是由我们需要解决的问题中划分出来的更小规模的<strong>子问题</strong>。我们只需要<strong>搜索</strong>从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 中，<strong>以哪一个结点作为根结点</strong>可以使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span></span> 最大，那么问题就可以解决。</p><p>更一般化地，如果需要从子序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msub><mi>k</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>k</mi><mi>j</mi></msub><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;k_i,k_{i+1},...,k_j&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.9805em;vertical-align:-.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span></span></span></span> 中求最小期望代价，那么可以将序列的起始点和终止点作为 <strong>状态</strong>，在该状态下的最优值记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dp(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span> 则有：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>i</mi><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>j</mi></mrow></munder><mo stretchy="false">{</mo><mi>d</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>≥</mo><mi>i</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>d</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">dp(i,j)=\begin{cases} \min\limits_{i\leq k\leq j}\{dp(i,k-1)+dp(k+1,j)+w(i,j)\},&amp;j\geq i\\ d_{i-1}.p,&amp;j=i-1 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-2.5em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em"><span class="pstrut" style="height:3.15em"></span><span style="height:.016em;width:.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0H504V16H384zM384 0H504V16H384z"/></svg></span></span><span style="top:-3.15em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em"><span class="pstrut" style="height:3.15em"></span><span style="height:.016em;width:.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0H504V16H384zM384 0H504V16H384z"/></svg></span></span><span style="top:-4.3em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9181em"><span style="top:-3.9181em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6679em"><span style="top:-2.3479em;margin-left:0"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">≤</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8882em"><span></span></span></span></span></span><span class="mopen">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)}</span><span class="mpunct">,</span></span></span><span style="top:-2.0219em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4181em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9181em"><span style="top:-3.9181em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span></span></span><span style="top:-2.0219em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4181em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>该状态方程指出，当划分出<strong>空子树</strong>时，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j=i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7429em;vertical-align:-.0833em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 时，其空隙的频率作为叶子结点出现，该频率就是唯一的搜索代价。<br>而<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>≥</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">j\geq i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span></span></span></span> 时，就从<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>→</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i\to j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span></span></span></span> 中搜索出以哪个结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 为根结点时的代价最小。</p><p>值得注意的是，我们的转移方程虽然建立起来了，但是我们还需关注<strong>自底向上</strong>的数据是如何建立的。</p><p>例如，想要计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[1,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span>，根据转移方程：<br>左边需要遍历<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>4</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[1,0],dp[1,1],d[1,2],dp[1,3],dp[1,4]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mclose">]</span></span></span></span> ；<br>右边需要遍历<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>3</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>5</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>6</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[2,5],dp[3,5],dp[4,5],dp[5,5],dp[6,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span>.</p><p>而这些都需要我们一开始计算并保存过。下面给出将动态规划表旋转后的结果，该旋转使得数组的对角线元素在水平线上。</p><div width="100%" style="overflow-x:auto"><svg width="362.775" height="314.962" xmlns="http://www.w3.org/2000/svg"><defs><marker id="a" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path d="m0 0 14 5-14 5V0" fill="#323232" stroke="#323232"/></marker><marker id="b" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path d="m0 0 14 5-14 5V0" fill="#323232" stroke="#323232"/></marker></defs><path d="m185.207 29.968 21.2 21.2-22.564 22.563-21.2-21.2Z" stroke="rgba(102, 102, 102,1)" fill="#fff"/><path d="m206.406 51.168 21.488 21.487-22.563 22.563-21.488-21.487Z" stroke="rgba(102, 102, 102,1)" fill="#f57c00"/><path d="m227.894 72.655 19.361 19.361-22.563 22.563-19.361-19.36Z" stroke="rgba(102, 102, 102,1)" fill="#ffb74d"/><path d="m247.268 92.029 20.874 20.875-22.563 22.563-20.874-20.875Z" stroke="rgba(102, 102, 102,1)" fill="#fff176"/><path d="m268.13 112.891 19.36 19.361-22.562 22.563-19.361-19.361Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m287.49 132.252 22.789 22.788-22.563 22.563-22.788-22.788Z" stroke="rgba(102, 102, 102,1)" fill="#fff9c4"/><path d="m162.644 52.531 21.2 21.2-22.564 22.563-21.2-21.2Z" stroke="rgba(102, 102, 102,1)" fill="#f57c00"/><path d="m183.843 73.73 21.488 21.488-22.563 22.563-21.488-21.487Z" stroke="rgba(102, 102, 102,1)" fill="#ffb74d"/><path d="m205.33 95.218 19.362 19.361-22.563 22.563-19.361-19.36Z" stroke="rgba(102, 102, 102,1)" fill="#fff176"/><path d="m224.705 114.592 20.874 20.875-22.563 22.563-20.874-20.875Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m245.567 135.454 19.36 19.361-22.562 22.563-19.361-19.361Z" stroke="rgba(102, 102, 102,1)" fill="#fff9c4"/><path d="m264.928 154.815 22.788 22.788-22.563 22.563-22.788-22.788Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m140.08 75.094 21.2 21.2-22.563 22.563-21.2-21.2Z" stroke="rgba(102, 102, 102,1)" fill="#ffb74d"/><path d="m161.28 96.294 21.488 21.487-22.563 22.563-21.488-21.487Z" stroke="rgba(102, 102, 102,1)" fill="#fff176"/><path d="m182.768 117.781 19.361 19.361-22.563 22.563-19.361-19.36Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m202.142 137.155 20.874 20.875-22.563 22.563-20.874-20.875Z" stroke="rgba(102, 102, 102,1)" fill="#fff9c4"/><path d="m223.004 158.017 19.36 19.361-22.562 22.563-19.361-19.361ZM242.365 177.378l22.788 22.788-22.563 22.563-22.788-22.788Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m117.518 97.657 21.2 21.2-22.564 22.563-21.2-21.2Z" stroke="rgba(102, 102, 102,1)" fill="#fff176"/><path d="m138.717 118.857 21.488 21.487-22.563 22.563-21.488-21.487Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m160.205 140.344 19.361 19.361-22.563 22.563-19.361-19.36Z" stroke="rgba(102, 102, 102,1)" fill="#fff9c4"/><path d="m179.579 159.718 20.874 20.875-22.563 22.563-20.874-20.875Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m200.44 180.58 19.362 19.361-22.563 22.563-19.361-19.361Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m219.802 199.941 22.788 22.788-22.563 22.563-22.788-22.788ZM94.955 120.22l21.2 21.2-22.564 22.563-21.2-21.2Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m116.154 141.42 21.488 21.487-22.563 22.563-21.488-21.487Z" stroke="rgba(102, 102, 102,1)" fill="#fff9c4"/><path d="m137.642 162.907 19.361 19.361-22.563 22.563-19.361-19.36ZM157.016 182.28l20.874 20.876-22.563 22.563-20.874-20.875Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m177.878 203.143 19.36 19.361-22.562 22.563-19.361-19.361ZM197.239 222.504l22.788 22.788-22.563 22.563-22.788-22.788Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m72.392 142.783 21.2 21.2-22.537 22.536-21.2-21.2Z" stroke="rgba(102, 102, 102,1)" fill="#fff9c4"/><path d="m93.591 163.983 21.488 21.487-22.536 22.536-21.488-21.487ZM115.079 185.47l19.361 19.361-22.536 22.536-19.361-19.36ZM134.453 204.844l20.874 20.875-22.536 22.535-20.874-20.874Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><path d="m155.315 225.706 19.36 19.361-22.535 22.536-19.361-19.361ZM174.676 245.067l22.788 22.788-22.536 22.536-22.788-22.788Z" stroke="rgba(102, 102, 102,1)" fill="#ffe0b2"/><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="1.954" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="15"><tspan>6</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="1.954" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="45.481"><tspan>5</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="1.954" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="74.369"><tspan>4</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="1.954" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="102.767"><tspan>3</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="1.954" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="131.271"><tspan>2</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="1.954" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="161.152"><tspan>1</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="33.863" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="15"><tspan>5</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="33.863" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="45.481"><tspan>4</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="33.863" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="74.369"><tspan>3</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="33.863" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="102.767"><tspan>2</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="33.863" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="131.271"><tspan>1</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="65.772" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="15"><tspan>4</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="65.772" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="45.481"><tspan>3</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="65.772" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="74.369"><tspan>2</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="65.772" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="102.767"><tspan>1</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="97.681" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="15"><tspan>3</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="97.681" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="45.481"><tspan>2</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="97.681" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="74.369"><tspan>1</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="129.59" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="15"><tspan>2</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="129.59" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="45.481"><tspan>1</tspan></tspan></text><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16" fill="#323232" font-weight="400" y="161.48" transform="rotate(45 56.429 238.548)"><tspan dy="20" x="15"><tspan>1</tspan></tspan></text><path d="M216.544 42.699h120v40h-120Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="700" font-style="italic" y="-.375" transform="translate(216.544 42.699)"><tspan dy="28" x="60"><tspan>i</tspan></tspan></text><path d="M25.006 48.853h120v40h-120Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="23" fill="#323232" font-weight="700" font-style="italic" y="-.375" transform="translate(25.006 48.853)"><tspan dy="28" x="60"><tspan>j</tspan></tspan></text><path d="m65.775 121.93 66.154-63.077" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#a)"/><path d="m229.621 51.16 70.77 66.154" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#b)"/><path d="M113.467 198.853h120v40h-120Z" fill="none"/><text font-family="Georgia" text-anchor="middle" font-size="26" fill="#323232" font-weight="700" font-style="italic" y="-18.75" transform="translate(113.467 198.853)"><tspan dy="32" x="60"><tspan> dp</tspan></tspan><tspan dy="32" x="60"><tspan>Table</tspan></tspan></text><path d="M25.006 115.007h72.307v23.846H25.006Z" fill="none"/><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" y="-.452" transform="translate(25.006 115.007)"><tspan dy="18" x="36.5"><tspan>0</tspan></tspan></text><path d="M101.16 35.776h72.307v23.846H101.16Z" fill="none"/><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" y="-.452" transform="translate(101.16 35.776)"><tspan dy="18" x="36.5"><tspan>5</tspan></tspan></text><path d="M204.067 31.16h72.308v23.847h-72.308Z" fill="none"/><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" y="-.452" transform="translate(204.067 31.16)"><tspan dy="18" x="36.5"><tspan>1</tspan></tspan></text><path d="M265.775 85.776h72.308v23.846h-72.308Z" fill="none"/><text font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="15" fill="#323232" font-weight="700" y="-.452" transform="translate(265.775 85.776)"><tspan dy="18" x="36.5"><tspan>6</tspan></tspan></text><path d="M38.875 29.007q0-4 4-4H317.26q4 0 4 4V177.93q0 4-4 4H42.875q-4 0-4-4Z" stroke-dasharray="10,6" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"/></svg></div><p>图中的数字并不是实际结果，而是一个标记。可见只有在先算完图中标记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 的数据之后，才能去计算标记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">2</span></span></span></span> 的数据，以此类推。<br>如果记<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span></span></span></span> 为上表中的 <code>标记值-1</code>，则：</p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">l=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">0</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>6.</mn><mtext>  </mtext><mi>j</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">i=1,2,3,4,5,6.\;j=0,1,2,3,4,5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">6.</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span></span></span></span> （此时<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j=i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7429em;vertical-align:-.0833em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> ，所以应提前处理）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5.</mn><mtext>  </mtext><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">i=1,2,3,4,5.\;j=1,2,3,4,5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5.</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">l=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">2</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4.</mn><mtext>  </mtext><mi>j</mi><mo>=</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">i=1,2,3,4.\;j=2,3,4,5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4.</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">l=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">3</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3.</mn><mtext>  </mtext><mi>j</mi><mo>=</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">i=1,2,3.\;j=3,4,5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">3.</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">l=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">4</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2.</mn><mtext>  </mtext><mi>j</mi><mo>=</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">i=1,2.\;j=4,5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">2.</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8389em;vertical-align:-.1944em"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">l=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">5</span></span></span></span> 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1.</mn><mtext>  </mtext><mi>j</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">i=1.\;j=5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1.</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">5</span></span></span></span> （<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[1,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span> 即为所求）</li></ol><p>根据以上自底向上的计算顺序，可总结出算法的循环体中应该有：<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>:</mo><mn>1</mn><mo>→</mo><mi>n</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mtext>  </mtext><mi>j</mi><mo>:</mo><mi>i</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i:1\to n-l+1,\;j:i-l+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7429em;vertical-align:-.0833em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span></p><h2 id="伪代码与复杂度">伪代码与复杂度</h2><p>在算法中，为了简单起见，避免<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo separator="true">,</mo><mtext>  </mtext><msub><mi>d</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">k_i.p,\;d_i.p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span></span></span></span> 这种多余的符号，我们规定输入关键字序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 的个数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span>，其频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">p[1..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>，空隙出现的频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">q[1..n+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>。</p><p>利用二维数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>0..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[1..n+1,0..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">0..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> 作为动态规划表（即备忘录）。根据转移方程可知，只在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>≥</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j\geq i-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7429em;vertical-align:-.0833em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 时，该数组的内容才会被用到。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[..]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">..</span><span class="mclose">]</span></span></span></span> 的行列数均是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 是因为存在伪关键字单独作为结点的情况，如<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[n+1,n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> 表示以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">k_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为根结点时，其右子树为空树，但补上空隙<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">d_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.1514em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 作为子结点。同理，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[1,0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span> 表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:-.0315em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 为根结点时，左子树为空树时，补上<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">d_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3011em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 。</p><p>与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">dp[..]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">..</span><span class="mclose">]</span></span></span></span> 类似，我们利用二维数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>0..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">w[1..n+1,0..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">0..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> 存储新增代价，避免后续的重复计算。新增代价的迭代更新也很简单：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>q</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>≥</mo><mi>i</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>d</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">.</mi><mi>p</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>j</mi><mo>=</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">w[i,j]=\begin{cases} w[i,j-1]+p[j]+q[j],&amp;j\geq i\\ d_{i-1}.p,&amp;j=i-1 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mpunct">,</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3117em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>为记录结果（<strong>追溯解</strong>），我们利用二维数组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo separator="true">,</mo><mn>1..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">root[1..n,1..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span> 存储在下标子域<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">root[i,j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span></span></span></span> 时使得代价最小时选取的根结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span></span></span></span>. 显然，只有在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1\leq i\leq j\leq n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7804em;vertical-align:-.136em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7955em;vertical-align:-.136em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.854em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 时，该数组的内容才有意义。</p><ul><li>输入：关键字序列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span> 的个数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span>，其频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">p[1..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>，空隙出现的频率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">q[1..n+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></li><li>输出：OBST的最小代价，根结点的选取表<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">[</mo><mn>1..</mn><mi>n</mi><mo separator="true">,</mo><mn>1..</mn><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">root[1..n,1..n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">1..</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>Algorithm: </mtext><mtext>  </mtext><mtext>Optimal-BST</mtext><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>p</mi><mo separator="true">,</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>1.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mtext>初始化二维数组 </mtext><mi>d</mi><mi>p</mi><mo separator="true">,</mo><mtext>  </mtext><mi>w</mi><mo separator="true">,</mo><mtext>  </mtext><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>2.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mi>i</mi><mtext>  </mtext><mo>=</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi></mrow><mtext>  </mtext><mi>n</mi><mo>+</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>3.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>←</mo><mi>q</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>4.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>←</mo><mi>q</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>5.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mi>l</mi><mtext>  </mtext><mo>=</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi></mrow><mtext>  </mtext><mi>n</mi><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>6.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mi>i</mi><mtext>  </mtext><mo>=</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi></mrow><mtext>  </mtext><mi>n</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>7.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mi>j</mi><mo>←</mo><mi>i</mi><mo>+</mo><mi>l</mi><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>8.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>9.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>p</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>q</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>10.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mi>r</mi><mtext>  </mtext><mo>=</mo><mi>i</mi><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">o</mi></mrow><mtext>  </mtext><mi>j</mi><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>11.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mspace width="2em"><mi>t</mi><mi>m</mi><mi>p</mi><mo>←</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>r</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>w</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>12.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mspace width="2em"><mrow><mi mathvariant="bold">i</mi><mi mathvariant="bold">f</mi></mrow><mtext>  </mtext><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>&gt;</mo><mi>t</mi><mi>m</mi><mi>p</mi><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>13.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mspace width="2em"><mspace width="2em"><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><mi>t</mi><mi>m</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>14.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mspace width="2em"><mspace width="2em"><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>←</mo><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>15.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">n</mi></mrow><mtext>  </mtext><mi>d</mi><mi>p</mi><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo><mtext>  </mtext><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">n</mi><mi mathvariant="bold">d</mi></mrow><mtext>  </mtext><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp;\text{Algorithm: }\;\text{Optimal-BST}(n,p,q)\\\\ 1.&amp;\;\text{初始化二维数组 }dp,\;w,\;root\\ 2.&amp;\;\mathbf{for}\;i\;=1\;\mathbf{to}\;n+1\;\mathbf{do}\\ 3.&amp;\;\qquad dp[i,i-1]\leftarrow q[i-1]\\ 4.&amp;\;\qquad w[i,i-1]\leftarrow q[i-1]\\ 5.&amp;\;\mathbf{for}\;l\;=1\;\mathbf{to}\;n\;\mathbf{do}\\ 6.&amp;\;\qquad\mathbf{for}\;i\;=1\;\mathbf{to}\;n-l+1\;\mathbf{do}\\ 7.&amp;\;\qquad\qquad j\leftarrow i+l-1\\ 8.&amp;\;\qquad\qquad dp[i,j]\leftarrow +\infty\\ 9.&amp;\;\qquad\qquad w[i,j]\leftarrow w[i,j-1]+p[j]+q[j]\\ 10.&amp;\;\qquad\qquad\mathbf{for}\;r\;=i\;\mathbf{to}\;j\;\mathbf{do}\\ 11.&amp;\;\qquad\qquad\qquad tmp\leftarrow dp[i,r-1]+dp[r+1,j]+w[i,j]\\ 12.&amp;\;\qquad\qquad\qquad\mathbf{if}\;dp[i,j]\gt tmp\;\mathbf{then}\\ 13.&amp;\;\qquad\qquad\qquad\qquad dp[i,j]\leftarrow tmp\\ 14.&amp;\;\qquad\qquad\qquad\qquad root[i,j]\leftarrow r\\ 15.&amp;\;\mathbf{return}\;dp[1,n]\;\mathbf{and}\;root \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:25.5em;vertical-align:-12.5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:13em"><span style="top:-15.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-13.66em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-12.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1.</span></span></span><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2.</span></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3.</span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4.</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">5.</span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6.</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">7.</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8.</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">9.</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">10.</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">11.</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">12.</span></span></span><span style="top:5.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">13.</span></span></span><span style="top:7.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">14.</span></span></span><span style="top:8.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">15.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.5em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:13em"><span style="top:-15.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">Algorithm: </span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Optimal-BST</span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span><span style="top:-12.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord cjk_fallback">初始化二维数组</span><span class="mord"> </span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span></span></span><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">to</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">to</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">to</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">+</span><span class="mord">∞</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">to</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord"><span class="mord mathbf" style="margin-right:.10903em">if</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">then</span></span></span></span><span style="top:5.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span></span></span><span style="top:7.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span></span></span><span style="top:8.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">return</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">and</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">roo</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.5em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>显然，算法嵌套了三层循环，每层执行的操作在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>，因此该算法的时间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Theta(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-.25em"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，而利用了3个近似为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 的的二维数组作为备忘和结果，所以空间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p><h2 id="实例与编程">实例与编程</h2><p>假设给定<strong>概率分布</strong>如下：</p><table><thead><tr><th style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6595em"></span><span class="mord mathnormal">i</span></span></span></span></th><th style="text-align:left">0</th><th style="text-align:left">1</th><th style="text-align:left">2</th><th style="text-align:left">3</th><th style="text-align:left">4</th><th style="text-align:left">5</th></tr></thead><tbody><tr><td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">p[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></td><td style="text-align:left"></td><td style="text-align:left">0.15</td><td style="text-align:left">0.10</td><td style="text-align:left">0.05</td><td style="text-align:left">0.10</td><td style="text-align:left">0.20</td></tr><tr><td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">q[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></td><td style="text-align:left">0.05</td><td style="text-align:left">0.10</td><td style="text-align:left">0.05</td><td style="text-align:left">0.05</td><td style="text-align:left">0.05</td><td style="text-align:left">0.10</td></tr></tbody></table><p>下给出 <code>c</code> 系列的编程实现：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 100</span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> dp[M][M];</span><br><span class="line"><span class="type">double</span> w[M][M];</span><br><span class="line"><span class="type">int</span> root[M][M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Optimal_BST</span><span class="params">(<span class="type">double</span> p[], <span class="type">double</span> q[], <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="comment">// 初始化</span></span><br><span class="line">	<span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">	<span class="built_in">memset</span>(root,<span class="number">0</span>,<span class="built_in">sizeof</span>(root));</span><br><span class="line">	<span class="built_in">memset</span>(w,<span class="number">0</span>,<span class="built_in">sizeof</span>(w));</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 单独处理最底层</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n+<span class="number">1</span>; i++)&#123;</span><br><span class="line">		dp[i][i<span class="number">-1</span>] = q[i<span class="number">-1</span>];</span><br><span class="line">		w[i][i<span class="number">-1</span>] = q[i<span class="number">-1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// 从 l=1 开始逐层填表</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> l = <span class="number">1</span>; l &lt;= n; l++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n-l+<span class="number">1</span>; i++)&#123;</span><br><span class="line">			<span class="type">int</span> j = i+l<span class="number">-1</span>;</span><br><span class="line">			dp[i][j] = INT32_MAX;</span><br><span class="line">			w[i][j] = w[i][j<span class="number">-1</span>]+p[j]+q[j];</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> r = i; r &lt;= j; r++)&#123;</span><br><span class="line">				<span class="type">double</span> tmp = dp[i][r<span class="number">-1</span>]+dp[r+<span class="number">1</span>][j]+w[i][j];</span><br><span class="line">				<span class="keyword">if</span>(dp[i][j] &gt; tmp)&#123;</span><br><span class="line">					dp[i][j] = tmp;</span><br><span class="line">					root[i][j] = r;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dp[<span class="number">1</span>][n];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">double</span> p[<span class="number">6</span>] = &#123;<span class="number">0</span>, <span class="number">0.15</span>, <span class="number">0.10</span>, <span class="number">0.05</span>, <span class="number">0.10</span>, <span class="number">0.20</span>&#125;;</span><br><span class="line">	<span class="type">double</span> q[<span class="number">6</span>] = &#123;<span class="number">0.05</span>, <span class="number">0.10</span>, <span class="number">0.05</span>, <span class="number">0.05</span>, <span class="number">0.05</span>, <span class="number">0.10</span>&#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;min E = &quot;</span> &lt;&lt; <span class="built_in">Optimal_BST</span>(p, q, <span class="number">5</span>) &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> l = <span class="number">0</span>; l &lt;= <span class="number">5</span>; l++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>-l+<span class="number">1</span>; i++)&#123;</span><br><span class="line">			<span class="type">int</span> j = i+l<span class="number">-1</span>;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="string">&quot;): dp = &quot;</span>; <span class="built_in">printf</span>(<span class="string">&quot;%.2f\t&quot;</span>,dp[i][j]);</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;w = &quot;</span>; <span class="built_in">printf</span>(<span class="string">&quot;%.2f\t&quot;</span>,w[i][j]);</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;root = &quot;</span> &lt;&lt; root[i][j] &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//while(1);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到如下旋转过后的各数组结果：</p><p><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202206072329933.png" alt="实例的求解结果"></p><p>从而得到对于该问题的最小代价为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2.75</mn></mrow><annotation encoding="application/x-tex">2.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">2.75</span></span></span></span>.</p><h1>最小生成树|<sub>Minimum Spanning Tree,MST</sub></h1><p>对于一个 <strong>无向带权连通图</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G=(V,E,W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mclose">)</span></span></span></span> ，我们需要寻找<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的一个<strong>无环子集</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>⊆</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">T\subseteq G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8193em;vertical-align:-.136em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 包含<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的所有顶点的同时又具有最小权重，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>T</mi></mrow></munder><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(T)=\sum\limits_{(u,v)\in T}w(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.966em;vertical-align:-1.216em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.75em"><span style="top:-2.059em;margin-left:0"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.03588em">v</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop op-symbol small-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.216em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span> 的值最小。</p><p>由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 无环且连通所有顶点可知，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 必然是一棵树，我们就称<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 是 图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的<strong>最小生成树</strong>Minimum Spanning Tree,MST。</p><h2 id="生成树的性质">生成树的性质</h2><p><strong>生成树具有如下性质</strong><br>设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(V,E,W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mclose">)</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 阶连通图，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">|V|=n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span>，那么：</p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的生成树 当且仅当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 无环且有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 条边；</li><li>若某条边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∈</mo><mi>E</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e\in E(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的一个生成树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 中不含有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo mathvariant="normal">∉</mo><mi>E</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e\notin E(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:.0556em"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span></span>，那么<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">{</mo><mi>e</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">E(T)\cup \{e\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">e</span><span class="mclose">}</span></span></span></span> 必含有一个回路，记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span>；（注：用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07847em">X</span><span class="mclose">)</span></span></span></span> 表示某个图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07847em">X</span></span></span></span> 的<strong>边集</strong>）</li><li>紧接第二点，如果去掉回路<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 中任意一条边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><mspace width="1em"><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo mathvariant="normal">≠</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">e&#x27;,\quad e&#x27;\neq e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.9463em;vertical-align:-.1944em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span>，最终得到的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 仍是生成树。</li></ol><p>如下图所示：</p><p><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202205231926662.png" alt="生成树的性质"></p><p>根据该性质，我们可以初步得出一种找到 MST 的策略：<br>首先得到一棵生成树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> ，然后对其加一条非树边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> 以形成回路<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span>.<br>如果能在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span></span></span></span> 中去掉一条边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">e&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，其中有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>&lt;</mo><mi>w</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(e&#x27;)\lt w(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span>，那么得到的新树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 就有：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mo stretchy="false">(</mo><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>w</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w(T&#x27;)-w(T)=w(e&#x27;)-w(e)\lt0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">0</span></span></span></span>，即是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>&lt;</mo><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(T&#x27;)\lt w(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span></span></span></span>.</p><p>从而可以根据该策略不断改进，最终得到 MST.</p><p>于是，求出一棵生成树的问题也就可以按照如下的通用算法进行描述：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>Algorithm: </mtext><mtext>  </mtext><mtext>Generic-MST</mtext><mo stretchy="false">(</mo><mi>G</mi><mo separator="true">,</mo><mi>E</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>1.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>A</mi><mo>←</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>2.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">w</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">e</mi></mrow><mtext>  </mtext><mi>A</mi><mtext> does not from a spanning tree</mtext><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>3.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mtext>find an edge </mtext><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mtext> that is safe for </mtext><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>4.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>A</mi><mo>←</mo><mi>A</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>5.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">n</mi></mrow><mtext>  </mtext><mi>A</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp;\text{Algorithm: }\;\text{Generic-MST}(G,E,w)\\\\ 1.&amp;\;A\leftarrow\varnothing\\ 2.&amp;\;\mathbf{while}\;A\text{ does not from a spanning tree}\;\mathbf{do}\\ 3.&amp;\;\qquad \text{find an edge }(u,v)\text{ that is safe for }A\\ 4.&amp;\;\qquad A\leftarrow A\cup\{(u,v)\}\\ 5.&amp;\;\mathbf{return}\;A \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.5em;vertical-align:-5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5em"><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1.</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2.</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3.</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4.</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">5.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.5em"><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">Algorithm: </span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Generic-MST</span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mclose">)</span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord amsrm">∅</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">while</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mord text"><span class="mord"> does not from a spanning tree</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord">find an edge </span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mord text"><span class="mord"> that is safe for </span></span><span class="mord mathnormal">A</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span><span class="mopen">{(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)}</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">return</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>此处的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 即是 MST 的边集.<br>此处的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>a</mi><mi>f</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">safe</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">e</span></span></span></span> 表示的是这样一条边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span> 使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A\cup\{(u,v)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)}</span></span></span></span> 仍然是 MST 边的子集，把这样的边称为 <strong>安全边</strong>.</p><p>下面将具体介绍两种算法用于求解最小生成树，并且二者均是利用了<strong>贪心策略</strong>的思想，但具体如何找到安全边的方法则不一样。</p><h2 id="Prim算法">Prim算法</h2><p><strong>Prim</strong> 算法的核心思想是将图的顶点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span></span></span></span> 划分为两个子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo separator="true">,</mo><mi>V</mi><mo>−</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">S,V-S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span>.<br>如果边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e=(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span> 中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>∈</mo><mi>S</mi><mo separator="true">,</mo><mi>v</mi><mo>∈</mo><mi>V</mi><mo>−</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">u\in S,v\in V-S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7667em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> 则称<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> <strong>横跨</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span></span></span></span> 的一个<strong>切割</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>V</mi><mo>−</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S,V-S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mclose">)</span></span></span></span>.</p><p>而 Prim算法 要求不断找到横跨某个切割的最小权重边，这样的边称为 <strong>轻量级边</strong>。可以证明这样的轻量级边就是一条<strong>安全边</strong>。</p><p>Prim算法 将当前的轻量级边划入子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> ，对应的端点加入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> 中，从而构造出下一个切割，再寻找下一条轻量级边，直到所有结点都划入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> ，最终的结果即为 MST.</p><div class="note info simple"><p>说人话就是，初始化最终 MST 的点集和边集为空。<br>先选定一个点，找与该点<strong>距离最近的边</strong>，然后将此边的连接的另一个端点加入点集，此边加入边集。<br>接下来，又继续找距离<strong>当前这个点集</strong>最近的边，依次加入，直到所有顶点都加入点集。</p></div><h3 id="算法伪码">算法伪码</h3><ul><li>输入：连通图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span>，边权<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span>，最小生成树的根结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span></span></span></span></li><li>输出：最小生成树的边集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span></li><li>其他：<ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">v.key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span></span></span></span> 表示树中与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 相连的边<strong>权重</strong>，若不存在则赋为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord">∞</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi mathvariant="normal">.</mi><mi>π</mi></mrow><annotation encoding="application/x-tex">v.\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span></span></span></span> 表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 在树中的父结点，有：<strong>边</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>v</mi><mi mathvariant="normal">.</mi><mi>π</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e=(v,v.\pi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span><span class="mclose">)</span></span></span></span> 的权值是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">v.key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi mathvariant="normal">.</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">G.V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.22222em">V</span></span></span></span> 表示图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的点集（数学中表示为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span></span></span></span>）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi mathvariant="normal">.</mi><mi>A</mi><mi>d</mi><mi>j</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">G.Adj[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">]</span></span></span></span> 表示图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 中与结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 相邻的结点的集合（数学中表示为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>G</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N_G(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3283em"><span style="top:-2.55em;margin-left:-.109em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span>）</li></ul></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>Algorithm: </mtext><mtext>  </mtext><mtext>MST-Prim</mtext><mo stretchy="false">(</mo><mi>G</mi><mo separator="true">,</mo><mi>w</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>r</mi><mtext>是起始点，最终作为树的根结点</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>1.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mtext>each </mtext><mi>u</mi><mo>∈</mo><mi>G</mi><mi mathvariant="normal">.</mi><mi>V</mi><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>2.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mtext>  </mtext><mi>u</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi><mo>←</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>3.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mtext>  </mtext><mi>u</mi><mi mathvariant="normal">.</mi><mi>π</mi><mo>←</mo><mi>N</mi><mi>I</mi><mi>L</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>4.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>r</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi><mo>←</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>5.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>Q</mi><mo>←</mo><mi>G</mi><mi mathvariant="normal">.</mi><mi>V</mi><mtext>  </mtext><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>Q</mi><mtext>为按权重 </mtext><mi>V</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi><mtext> 递增的优先队列</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>6.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>A</mi><mo>←</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>7.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">w</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">e</mi></mrow><mtext>  </mtext><mi>Q</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∅</mi><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>8.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>u</mi><mo>←</mo><mtext>Extract-min</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>9.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mi>A</mi><mo>←</mo><mi>A</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>u</mi><mi mathvariant="normal">.</mi><mi>π</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>10.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mtext>each </mtext><mi>v</mi><mo>∈</mo><mi>G</mi><mi mathvariant="normal">.</mi><mi>A</mi><mi>d</mi><mi>j</mi><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>11.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mrow><mi mathvariant="bold">i</mi><mi mathvariant="bold">f</mi></mrow><mtext>  </mtext><mi>v</mi><mo>∈</mo><mi>Q</mi><mtext> and </mtext><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>v</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>12.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mspace width="2em"><mi>v</mi><mi mathvariant="normal">.</mi><mi>π</mi><mo>←</mo><mi>u</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>13.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mspace width="2em"><mi>v</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi><mo>←</mo><mi>w</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>14.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">n</mi></mrow><mtext>  </mtext><mi>A</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp;\text{Algorithm: }\;\text{MST-Prim}(G,w,r)\\ &amp;//r\text{是起始点，最终作为树的根结点}\\\\ 1.&amp;\;\mathbf{for}\;\text{each }u\in G.V\;\mathbf{do}\\ 2.&amp;\;\qquad\;u.key\leftarrow+\infty\\ 3.&amp;\;\qquad\;u.\pi\leftarrow NIL\\ 4.&amp;\;r.key\leftarrow0\\ 5.&amp;\;Q\leftarrow G.V\;//Q\text{为按权重 }V.key\text{ 递增的优先队列}\\ 6.&amp;\;A\leftarrow\varnothing\\ 7.&amp;\;\mathbf{while}\;Q\neq\varnothing\;\mathbf{do}\\ 8.&amp;\;\qquad u\leftarrow\text{Extract-min}(Q)\\ 9.&amp;\;\qquad A\leftarrow A\cup\{(u,u.\pi)\}\\ 10.&amp;\;\qquad\mathbf{for}\;\text{each }v\in G.Adj[u]\;\mathbf{do}\\ 11.&amp;\;\qquad\qquad\mathbf{if}\;v\in Q\text{ and }w(u,v)\lt v.key\;\mathbf{then}\\ 12.&amp;\;\qquad\qquad\qquad v.\pi\leftarrow u\\ 13.&amp;\;\qquad\qquad\qquad v.key\leftarrow w(u,v)\\ 14.&amp;\;\mathbf{return}\;A \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:25.5em;vertical-align:-12.5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:13em"><span style="top:-15.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-13.66em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-12.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1.</span></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2.</span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3.</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4.</span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">5.</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6.</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">7.</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8.</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">9.</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">10.</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">11.</span></span></span><span style="top:5.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">12.</span></span></span><span style="top:7.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">13.</span></span></span><span style="top:8.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">14.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.5em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:13em"><span style="top:-15.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">Algorithm: </span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">MST-Prim</span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mclose">)</span></span></span><span style="top:-13.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord">//</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord text"><span class="mord cjk_fallback">是起始点，最终作为树的根结点</span></span></span></span><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">each </span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">u</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">+</span><span class="mord">∞</span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">u</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mord mathnormal">L</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">0</span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">//</span><span class="mord mathnormal">Q</span><span class="mord text"><span class="mord cjk_fallback">为按权重</span><span class="mord"> </span></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span><span class="mord text"><span class="mord"> </span><span class="mord cjk_fallback">递增的优先队列</span></span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord amsrm">∅</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">while</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord amsrm">∅</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Extract-min</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span><span class="mopen">{(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">u</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span><span class="mclose">)}</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">each </span></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mopen">[</span><span class="mord mathnormal">u</span><span class="mclose">]</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord"><span class="mord mathbf" style="margin-right:.10903em">if</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">Q</span><span class="mord text"><span class="mord"> and </span></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">then</span></span></span></span><span style="top:5.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">u</span></span></span><span style="top:7.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span><span style="top:8.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">return</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:12.5em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中，第10到13行是对队列中的结点的属性进行<strong>更新</strong>，使得每次循环都能保证队列中的结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 到MST子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 的权重<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi mathvariant="normal">.</mi><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">v.key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal" style="margin-right:.03588em">ey</span></span></span></span> 最小，此时保存好在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 中与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 相连的结点，即是其父结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi mathvariant="normal">.</mi><mi>π</mi></mrow><annotation encoding="application/x-tex">v.\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span></span></span></span>。</p><p>如果优先队列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8778em;vertical-align:-.1944em"></span><span class="mord mathnormal">Q</span></span></span></span> 采用 <strong>最小二叉堆</strong> 实现，则每一次循环取出当前最小元的过程（利用最小二叉堆实现时）需要花费<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log |V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>，<code>while</code> 循环次数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>，<code>for</code> 循环总次数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|E|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>，事先装载队列需要<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</p><p>综合来看，该算法的时间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|\log |V|+|E|\log |V|)=O(|E|\log |V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>，空间复杂度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</p><p>如果改用斐波那契堆，则时间复杂度还可以进一步优化为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|E|+|V|\log|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>.</p><h3 id="正确性证明-2">正确性证明</h3><p><strong>提出命题</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>k</mi><mo>&lt;</mo><mi>n</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\forall k\lt n=|V|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335em;vertical-align:-.0391em"></span><span class="mord">∀</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span></span></span></span>，存在一棵 MST 包含有算法前<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 步选择边而纳入的子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span>。</p><ol><li><p>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 时，假设最小生成树<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 不包含由选择的根结点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span></span></span></span> 组成的某条轻量级边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo mathvariant="normal">∉</mo><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">(r,i)\notin T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:.0556em"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>.<br>设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo>−</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">T=(T^*-\{(r,j)\})\cup\{(r,i)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)})</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mclose">)}</span></span></span></span> .<br>因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> 是一条轻量级边，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>E</mi></mrow></munder><mi>w</mi><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>w</mi><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(r,i)=\min\limits_{(r,t)\in E}w(r,t)\leq w(r,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.716em;vertical-align:-.966em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.6679em"><span style="top:-2.309em;margin-left:0"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:.02778em">r</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:.05764em">E</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.966em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span>，所以<strong>替换后得到的生成树仍然是最优解</strong></p></li><li><p>现 <strong>假设命题成立</strong>，证明命题对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 的情况也成立。</p></li></ol><p>设算法当前得到的子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 中的顶点集为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span>，那么第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 步将会从集合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>−</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">V-S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7667em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> 中选取下一个点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">i_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8679em;vertical-align:-.2083em"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span></span></span></span> 纳入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span>，且保证<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">i_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8679em;vertical-align:-.2083em"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span></span></span></span> 到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span></span></span></span> 有最小权边。如图所示：</p><div width="100%" style="overflow-x:auto"><svg id="SvgjsSvg1006" width="486.4124755859375" height="330" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1122" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1123" r="4" cx="8" cy="8" fill="#ffffff" stroke="#323232" stroke-width="2"></circle></marker><marker id="SvgjsMarker1124" markerWidth="16" markerHeight="16" refX="13" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1125" r="4" cx="8" cy="8" fill="#ffffff" stroke="#323232" stroke-width="2"></circle></marker></defs><g id="SvgjsG1008" transform="translate(121.1377519621135,88.20514844058664)"><path id="SvgjsPath1009" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1012" transform="translate(116.78620801912069,100.00357588876386)"><path id="SvgjsPath1013" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1014"><text id="SvgjsText1015" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1016" dy="17" x="30"><tspan id="SvgjsTspan1017">1</tspan></tspan></text></g></g><g id="SvgjsG1018" transform="translate(200.16388022814675,152.20514844058664)"><path id="SvgjsPath1019" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1020"><text id="SvgjsText1021" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1022" transform="translate(195.81233628515395,164.00357588876386)"><path id="SvgjsPath1023" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1024"><text id="SvgjsText1025" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"></text></g></g><g id="SvgjsG1026"><path id="SvgjsPath1027" d="M167.07430880444355 132.9169003328301 205.21855389679178 163.37602340356148" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1028" transform="translate(116.78620801912058,192.09506981299546)"><path id="SvgjsPath1029" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1030"><text id="SvgjsText1031" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1032" transform="translate(112.43466407612777,203.89349726117268)"><path id="SvgjsPath1033" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1034"><text id="SvgjsText1035" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1036" dy="17" x="30"><tspan id="SvgjsTspan1037">2</tspan></tspan></text></g></g><g id="SvgjsG1038"><path id="SvgjsPath1039" d="M146.61629068684164 143.13704410600928 142.4383106245587 191.09884248209744" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1040" transform="translate(24.999984741210938,81)"><path id="SvgjsPath1041" d="M0 0 120 0 120 40 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1042"><text id="SvgjsText1043" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="29px" width="120px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="29px" weight="700" font-style="" opacity="1" y="-4.625" transform="rotate(0)"><tspan id="SvgjsTspan1044" dy="36" x="60"><tspan id="SvgjsTspan1045">S</tspan></tspan></text></g></g><g id="SvgjsG1046" transform="translate(407.2660179953675,94.20514844058664)"><path id="SvgjsPath1047" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1048"><text id="SvgjsText1049" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1050" transform="translate(401.42278759156716,106.00357588876386)"><path id="SvgjsPath1051" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1052"><text id="SvgjsText1053" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1054" dy="17" x="30"><tspan id="SvgjsTspan1055">4</tspan></tspan></text></g></g><g id="SvgjsG1056" transform="translate(402.91447405237454,185.4220948345411)"><path id="SvgjsPath1057" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1058"><text id="SvgjsText1059" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1060" transform="translate(398.5629301093818,197.22052228271832)"><path id="SvgjsPath1061" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1062"><text id="SvgjsText1063" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="2.295746962115798" transform="rotate(0)"><tspan id="SvgjsTspan1064" dy="17" x="30"><tspan id="SvgjsTspan1065">5</tspan></tspan></text></g></g><g id="SvgjsG1066"><path id="SvgjsPath1067" d="M431.38447739244896 149.1376278477702 428.5595924957755 184.42528376188216" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1068" transform="translate(323.8052103944176,140.2848539481937)"><path id="SvgjsPath1069" d="M0 26.96783416726233C0-8.98927805575411 51.13064133016627-8.98927805575411 51.13064133016627 26.96783416726233 51.13064133016627 62.92494639027876 0 62.92494639027876 0 26.96783416726233Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1070"><text id="SvgjsText1071" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="32px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="15.217834167262328" transform="rotate(0)"></text></g></g><g id="SvgjsG1072" transform="translate(319.4536664514246,152.08328139637092)"><path id="SvgjsPath1073" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1074"><text id="SvgjsText1075" font-family="Georgia" text-anchor="middle" font-size="24px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="24px" weight="700" font-style="italic" opacity="1" y="-6.954253037884202" transform="rotate(0)"><tspan id="SvgjsTspan1076" dy="30" x="30"><tspan id="SvgjsTspan1077">i</tspan></tspan></text></g></g><g id="SvgjsG1078"><path id="SvgjsPath1079" d="M411.1866442392801 137.23423549506106 371.77356698826713 152.2267842964642" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1080" transform="translate(259.28739566757673,72)"><path id="SvgjsPath1081" d="M0 0 120 0 120 40 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1082"><text id="SvgjsText1083" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="29px" width="120px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="29px" weight="700" font-style="" opacity="1" y="-4.625" transform="rotate(0)"><tspan id="SvgjsTspan1084" dy="36" x="60"><tspan id="SvgjsTspan1085">V-S</tspan></tspan></text></g></g><g id="SvgjsG1086"><path id="SvgjsPath1087" d="M248.95061017577603 191.68967466660376 322.85458495985245 167.56302870764137" stroke="#e57373" stroke-width="4" fill="none"></path></g><g id="SvgjsG1088" transform="translate(325.23751443242236,163.02251036087034)"><path id="SvgjsPath1089" d="M0 0 48.26603325415658 0 48.26603325415658 28.9506924079094 0 28.9506924079094Z" stroke="none" fill="none"></path><g id="SvgjsG1090"><text id="SvgjsText1091" font-family="Georgia" text-anchor="middle" font-size="15px" width="49px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="15px" weight="400" font-style="italic" opacity="1" y="2.1003462039547003" transform="rotate(0)"><tspan id="SvgjsTspan1092" dy="18" x="24.5"><tspan id="SvgjsTspan1093">k+1</tspan></tspan></text></g></g><g id="SvgjsG1094" transform="translate(195.81233628515395,164.00357588876386)"><path id="SvgjsPath1095" d="M0 0 59.833729216152015 0 59.833729216152015 28.091493924231596 0 28.091493924231596Z" stroke="none" fill="none"></path><g id="SvgjsG1096"><text id="SvgjsText1097" font-family="Georgia" text-anchor="middle" font-size="24px" width="60px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="24px" weight="700" font-style="italic" opacity="1" y="-6.954253037884202" transform="rotate(0)"><tspan id="SvgjsTspan1098" dy="30" x="30"><tspan id="SvgjsTspan1099">i</tspan></tspan></text></g></g><g id="SvgjsG1100" transform="translate(211.02136241342015,174.94280485326328)"><path id="SvgjsPath1101" d="M0 0 48.26603325415658 0 48.26603325415658 28.9506924079094 0 28.9506924079094Z" stroke="none" fill="none"></path><g id="SvgjsG1102"><text id="SvgjsText1103" font-family="Georgia" text-anchor="middle" font-size="15px" width="49px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="15px" weight="400" font-style="italic" opacity="1" y="2.1003462039547003" transform="rotate(0)"><tspan id="SvgjsTspan1104" dy="18" x="24.5"><tspan id="SvgjsTspan1105">l</tspan></tspan></text></g></g><g id="SvgjsG1106" transform="translate(277.543927734085,178.87062378011478)"><path id="SvgjsPath1107" d="M0 0 43.37529691211404 0 43.37529691211404 21.0950545542064 0 21.0950545542064Z" stroke="none" fill="none"></path><g id="SvgjsG1108"><text id="SvgjsText1109" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="19px" width="44px" fill="#e57373" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="19px" weight="700" font-style="" opacity="1" y="-5.8274727228968" transform="rotate(0)"><tspan id="SvgjsTspan1110" dy="23" x="22"><tspan id="SvgjsTspan1111">e</tspan></tspan></text></g></g><g id="SvgjsG1112"><path id="SvgjsPath1113" d="M164.9996775267851 230.97522948724588 405.00029195563684 225.02480103033224" stroke="#1976d2" stroke-width="3" fill="none"></path></g><g id="SvgjsG1114" transform="translate(320.91922464619904,231.98499118540428)"><path id="SvgjsPath1115" d="M0 0 43.37529691211404 0 43.37529691211404 21.0950545542064 0 21.0950545542064Z" stroke="none" fill="none"></path><g id="SvgjsG1116"><text id="SvgjsText1117" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="19px" width="44px" fill="#1976d2" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="19px" weight="700" font-style="" opacity="1" y="-5.8274727228968" transform="rotate(0)"><tspan id="SvgjsTspan1118" dy="23" x="22"><tspan id="SvgjsTspan1119">e'</tspan></tspan></text></g></g><g id="SvgjsG1120"><path id="SvgjsPath1121" d="M112.99998474121094 25.000015258789062C215.99998474121094 41.00001525878906 360.99998474121094 188.00001525878906 219.29452155831302 305.00001525878906" stroke-dasharray="8,5" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#SvgjsMarker1122)" marker-end="url(#SvgjsMarker1124)"></path></g></svg></div><p>假设该最小权边记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>i</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>i</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e=(i_{k+1},i_l)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.2083em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361em"><span style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，则有：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>∈</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">e\in T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span>，若不然，则将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> 加入到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 中形成回路，这条回路中一定包含有横跨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>S</mi><mo separator="true">,</mo><mi>V</mi><mo>−</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(S,V-S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mclose">)</span></span></span></span> 的另一条边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">e&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，将其从回路中删除得到新的生成树：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo>−</mo><mo stretchy="false">{</mo><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo>∪</mo><mo stretchy="false">{</mo><mi>e</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">T=(T^*-\{e&#x27;\})\cup\{e\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7387em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8019em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">})</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">e</span><span class="mclose">}</span></span></span></span></span></p><p>因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> 是最小权边，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>w</mi><mo stretchy="false">(</mo><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>w</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(e)\leq w(e&#x27;),w(T)\leq w(T^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 仍然是最小生成树，即算法的第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7778em;vertical-align:-.0833em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 步仍然能够得到MST的子集。</p><p>当算法执行完毕后，结果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">A=T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 是图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的一个最小生成树。</p><h3 id="编程实现-2">编程实现</h3><p>采用 <code>C++</code> 进行编程实现.</p><p>首先创建给出结果的边集结构体(<code>Edge</code>)，以及由 <code>Node</code> 和 <code>Edge</code> 数组组合而成的图(<code>Graph</code>).</p><p>此外还有为Prim算法设计的优先队列，因为C++中没有特定的<code>Decrease-key()</code> 方法，因此直接采用 <code>vector</code> +遍历的方法模拟优先队列。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">NODE</span>&#123;</span><br><span class="line">    <span class="type">int</span> tag;</span><br><span class="line">    <span class="type">int</span> key; <span class="comment">//最小权重</span></span><br><span class="line">    <span class="type">int</span> pi; <span class="comment">//父结点</span></span><br><span class="line">&#125;Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">EDGE</span>&#123;</span><br><span class="line">    <span class="type">int</span> u,v;</span><br><span class="line">&#125;Edge;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">GRAPH</span>&#123;</span><br><span class="line">    <span class="type">int</span> num; <span class="comment">//图结点个数</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; nodes;</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">&#125;Graph;</span><br></pre></td></tr></table></figure><p>然后是具体的Prim算法实现：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Node <span class="title">PopMinKey</span><span class="params">(vector&lt;Node&gt; &amp;Q)</span></span>&#123;</span><br><span class="line">	<span class="comment">//找到key最小的结点从队列中删除，并返回该结点</span></span><br><span class="line">    <span class="type">int</span> min = INT32_MAX;</span><br><span class="line">    Node u;</span><br><span class="line">    <span class="type">int</span> index;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; Q.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(min &gt; Q[i].key)&#123;</span><br><span class="line">            min = Q[i].key;</span><br><span class="line">            u = Q[i];</span><br><span class="line">            index = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Q.<span class="built_in">erase</span>(Q.<span class="built_in">begin</span>()+index);</span><br><span class="line">    <span class="keyword">return</span> u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UpdateQueue</span><span class="params">(vector&lt;Node&gt; &amp;Q, <span class="type">int</span> target, <span class="type">int</span> sourse, <span class="type">int</span> weight)</span></span>&#123;</span><br><span class="line">	<span class="comment">//对队列 Q 中的结点 key值 进行更新</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; Q.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Q[i].tag == target)&#123;</span><br><span class="line">            Q[i].key = weight;</span><br><span class="line">            Q[i].pi = sourse;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;Edge&gt; <span class="title">MST_Prim</span><span class="params">(Graph G, <span class="type">int</span> w[], <span class="type">int</span> r = <span class="number">0</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    vector&lt;Node&gt; Q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; G.num; i++)&#123;</span><br><span class="line">        Q.<span class="built_in">push_back</span>(&#123;G.nodes[i], INT32_MAX, <span class="number">-1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    Q[<span class="number">0</span>].key = <span class="number">0</span>; Q[<span class="number">0</span>].pi = <span class="number">1</span>; <span class="comment">//初始化队列</span></span><br><span class="line"></span><br><span class="line">    vector&lt;Edge&gt; A;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        Node u = <span class="built_in">PopMinKey</span>(Q);</span><br><span class="line">        A.<span class="built_in">push_back</span>(&#123;u.tag, u.pi&#125;);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; G.edges.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(G.edges[i].u == u.tag)&#123;</span><br><span class="line">                <span class="built_in">UpdateQueue</span>(Q, G.edges[i].v, u.tag, w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(G.edges[i].v == u.tag)&#123;</span><br><span class="line">                <span class="built_in">UpdateQueue</span>(Q, G.edges[i].u, u.tag, w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实例演示</strong><br>考虑如下图所示的实例，其正确答案已给出。</p><div width="100%" style="overflow-x:auto"><svg id="SvgjsSvg1126" width="931.1875" height="532.25" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1127"></defs><g id="SvgjsG1128" transform="translate(114.19217887810521,102.09663215220519)"><path id="SvgjsPath1129" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1130"><text id="SvgjsText1131" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1132" transform="translate(118.74429849515104,113.26452769970899)"><path id="SvgjsPath1133" d="M0 0 35.08464730919109 0 35.08464730919109 21.712336364741102 0 21.712336364741102Z" stroke="none" fill="none"></path><g id="SvgjsG1134"><text id="SvgjsText1135" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="36px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.893831817629449" transform="rotate(0)"><tspan id="SvgjsTspan1136" dy="27" x="18"><tspan id="SvgjsTspan1137">3</tspan></tspan></text></g></g><g id="SvgjsG1138" transform="translate(114.1921788781051,25.003365504503563)"><path id="SvgjsPath1139" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1140"><text id="SvgjsText1141" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1142" transform="translate(110.43142257654915,34.6388933863235)"><path id="SvgjsPath1143" d="M0 0 51.710399146395474 0 51.710399146395474 22.94173305195242 0 22.94173305195242Z" stroke="none" fill="none"></path><g id="SvgjsG1144"><text id="SvgjsText1145" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="52px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.27913347402379" transform="rotate(0)"><tspan id="SvgjsTspan1146" dy="27" x="26"><tspan id="SvgjsTspan1147">1</tspan></tspan></text></g></g><g id="SvgjsG1148" transform="translate(25.003544034379956,103.01430147428346)"><path id="SvgjsPath1149" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1150"><text id="SvgjsText1151" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1152" transform="translate(31.71419488033348,112.6498293561034)"><path id="SvgjsPath1153" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1154"><text id="SvgjsText1155" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1156" dy="27" x="19"><tspan id="SvgjsTspan1157">2</tspan></tspan></text></g></g><g id="SvgjsG1158" transform="translate(203.90017580932738,103.01430147428334)"><path id="SvgjsPath1159" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1160"><text id="SvgjsText1161" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1162" transform="translate(206.33070826622838,112.6498293561034)"><path id="SvgjsPath1163" d="M0 0 40.09762050154925 0 40.09762050154925 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1164"><text id="SvgjsText1165" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="41px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1166" dy="27" x="20.5"><tspan id="SvgjsTspan1167">4</tspan></tspan></text></g></g><g id="SvgjsG1168" transform="translate(62.48177973170982,185.61242588238179)"><path id="SvgjsPath1169" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1170"><text id="SvgjsText1171" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1172" transform="translate(69.19243057766346,195.24795376420172)"><path id="SvgjsPath1173" d="M0 0 37.22369328360896 0 37.22369328360896 21.106394407796284 0 21.106394407796284Z" stroke="none" fill="none"></path><g id="SvgjsG1174"><text id="SvgjsText1175" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-9.196802796101858" transform="rotate(0)"><tspan id="SvgjsTspan1176" dy="27" x="19"><tspan id="SvgjsTspan1177">5</tspan></tspan></text></g></g><g id="SvgjsG1178" transform="translate(158.38106542138883,184.69475656030374)"><path id="SvgjsPath1179" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1180"><text id="SvgjsText1181" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1182" transform="translate(159.71128926604365,196.16562308627988)"><path id="SvgjsPath1183" d="M0 0 44.18888654328375 0 44.18888654328375 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1184"><text id="SvgjsText1185" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="45px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1186" dy="27" x="22.5"><tspan id="SvgjsTspan1187">6</tspan></tspan></text></g></g><g id="SvgjsG1188"><path id="SvgjsPath1189" d="M115.60369190853396 58.12054900904934 61.29719954877419 107.0858929133268" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1190"><path id="SvgjsPath1191" d="M155.30863126812199 58.529184639454456 209.14691347027178 108.92129620297067" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1192"><path id="SvgjsPath1193" d="M136.2866221497468 70.05149296425213 136.2866221497468 101.09663215220519" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1194"><path id="SvgjsPath1195" d="M113.19217887810521 124.12069588207953 70.19243057766346 124.12069588207953" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1196"><path id="SvgjsPath1197" d="M159.3810654213886 124.12069588207953 202.90017580932738 124.12069588207953" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1198"><path id="SvgjsPath1199" d="M47.611146195224705 147.92072256352708 71.98303371535678 188.68438511994407" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1200"><path id="SvgjsPath1201" d="M121.8737345132356 142.29258536856003 99.11584854688715 190.05495291507043" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1202"><path id="SvgjsPath1203" d="M149.4384053282372 143.15829140925246 168.99785891276008 187.07780390189714" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1204"><path id="SvgjsPath1205" d="M215.06841791156683 143.86282086742392 193.5767431255208 188.18535520754108" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1206"><path id="SvgjsPath1207" d="M107.67066627499332 208.55415893433417 158.71128926604365 208.55415893433417" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1208" transform="translate(55.048538155326696,63.64908960086461)"><path id="SvgjsPath1209" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1210"><text id="SvgjsText1211" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1212" dy="27" x="19"><tspan id="SvgjsTspan1213">6</tspan></tspan></text></g></g><g id="SvgjsG1214" transform="translate(28.358869457356718,172.30622071224957)"><path id="SvgjsPath1215" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1216"><text id="SvgjsText1217" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1218" dy="27" x="19"><tspan id="SvgjsTspan1219">3</tspan></tspan></text></g></g><g id="SvgjsG1220" transform="translate(81.26606279782118,147.06242893403214)"><path id="SvgjsPath1221" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1222"><text id="SvgjsText1223" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1224" dy="27" x="19"><tspan id="SvgjsTspan1225">6</tspan></tspan></text></g></g><g id="SvgjsG1226" transform="translate(76.71394318077512,97.26835898961076)"><path id="SvgjsPath1227" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1228"><text id="SvgjsText1229" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1230" dy="27" x="19"><tspan id="SvgjsTspan1231">5</tspan></tspan></text></g></g><g id="SvgjsG1232" transform="translate(118.74429849515104,212.83953456625238)"><path id="SvgjsPath1233" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1234"><text id="SvgjsText1235" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1236" dy="27" x="19"><tspan id="SvgjsTspan1237">6</tspan></tspan></text></g></g><g id="SvgjsG1238" transform="translate(146.65744138307753,149.3644876602973)"><path id="SvgjsPath1239" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1240"><text id="SvgjsText1241" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1242" dy="27" x="19"><tspan id="SvgjsTspan1243">4</tspan></tspan></text></g></g><g id="SvgjsG1244" transform="translate(192.461892996953,162.67069283042963)"><path id="SvgjsPath1245" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1246"><text id="SvgjsText1247" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1248" dy="27" x="19"><tspan id="SvgjsTspan1249">2</tspan></tspan></text></g></g><g id="SvgjsG1250" transform="translate(129.37274266086047,74.32662593765849)"><path id="SvgjsPath1251" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1252"><text id="SvgjsText1253" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1254" dy="27" x="19"><tspan id="SvgjsTspan1255">1</tspan></tspan></text></g></g><g id="SvgjsG1256" transform="translate(166.85097835819033,123.2030265600016)"><path id="SvgjsPath1257" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1258"><text id="SvgjsText1259" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1260" dy="27" x="19"><tspan id="SvgjsTspan1261">5</tspan></tspan></text></g></g><g id="SvgjsG1262" transform="translate(176.04142921084667,63.64908960086461)"><path id="SvgjsPath1263" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1264"><text id="SvgjsText1265" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1266" dy="27" x="19"><tspan id="SvgjsTspan1267">5</tspan></tspan></text></g></g><g id="SvgjsG1268" transform="translate(441.7270586442555,107.45058350940144)"><path id="SvgjsPath1269" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1270"><text id="SvgjsText1271" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1272" transform="translate(446.27917826130124,118.61847905690524)"><path id="SvgjsPath1273" d="M0 0 35.08464730919109 0 35.08464730919109 21.712336364741102 0 21.712336364741102Z" stroke="none" fill="none"></path><g id="SvgjsG1274"><text id="SvgjsText1275" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="36px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.893831817629449" transform="rotate(0)"><tspan id="SvgjsTspan1276" dy="27" x="18"><tspan id="SvgjsTspan1277">3</tspan></tspan></text></g></g><g id="SvgjsG1278" transform="translate(441.7270586442555,30.357316861699815)"><path id="SvgjsPath1279" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1280"><text id="SvgjsText1281" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1282" transform="translate(437.96630234269946,41.77973138148491)"><path id="SvgjsPath1283" d="M0 0 51.710399146395474 0 51.710399146395474 22.94173305195242 0 22.94173305195242Z" stroke="none" fill="none"></path><g id="SvgjsG1284"><text id="SvgjsText1285" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="52px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.27913347402379" transform="rotate(0)"><tspan id="SvgjsTspan1286" dy="27" x="26"><tspan id="SvgjsTspan1287">1</tspan></tspan></text></g></g><g id="SvgjsG1288" transform="translate(352.53842380053015,108.36825283147971)"><path id="SvgjsPath1289" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1290"><text id="SvgjsText1291" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1292" transform="translate(359.2490746464837,118.00378071329965)"><path id="SvgjsPath1293" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1294"><text id="SvgjsText1295" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1296" dy="27" x="19"><tspan id="SvgjsTspan1297">2</tspan></tspan></text></g></g><g id="SvgjsG1298" transform="translate(531.4350555754777,108.3682528314796)"><path id="SvgjsPath1299" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1300"><text id="SvgjsText1301" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1302" transform="translate(533.8655880323786,118.00378071329965)"><path id="SvgjsPath1303" d="M0 0 40.09762050154925 0 40.09762050154925 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1304"><text id="SvgjsText1305" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="41px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1306" dy="27" x="20.5"><tspan id="SvgjsTspan1307">4</tspan></tspan></text></g></g><g id="SvgjsG1308" transform="translate(390.01665949786,190.96637723957804)"><path id="SvgjsPath1309" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1310"><text id="SvgjsText1311" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1312" transform="translate(396.72731034381377,200.60190512139798)"><path id="SvgjsPath1313" d="M0 0 37.22369328360896 0 37.22369328360896 21.106394407796284 0 21.106394407796284Z" stroke="none" fill="none"></path><g id="SvgjsG1314"><text id="SvgjsText1315" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-9.196802796101858" transform="rotate(0)"><tspan id="SvgjsTspan1316" dy="27" x="19"><tspan id="SvgjsTspan1317">5</tspan></tspan></text></g></g><g id="SvgjsG1318" transform="translate(485.9159451875389,190.0487079175)"><path id="SvgjsPath1319" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1320"><text id="SvgjsText1321" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1322" transform="translate(487.24616903219385,201.51957444347613)"><path id="SvgjsPath1323" d="M0 0 44.18888654328375 0 44.18888654328375 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1324"><text id="SvgjsText1325" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="45px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1326" dy="27" x="22.5"><tspan id="SvgjsTspan1327">6</tspan></tspan></text></g></g><g id="SvgjsG1328"><path id="SvgjsPath1329" d="M443.11508665752103 65.23487185191937 388.843821823506 112.4531018466688" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1330"><path id="SvgjsPath1331" d="M482.8668987508604 65.6445989215473 536.6700993781283 114.28795941670126" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1332"><path id="SvgjsPath1333" d="M463.821501915897 75.40544432144839 463.821501915897 106.45058350940144" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1334"><path id="SvgjsPath1335" d="M440.7270586442555 129.47464723927578 397.72731034381377 129.47464723927578" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1336"><path id="SvgjsPath1337" d="M486.9159451875389 129.47464723927578 530.4350555754777 129.47464723927578" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1338"><path id="SvgjsPath1339" d="M375.146025961375 153.27467392072333 399.51791348150687 194.03833647714032" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1340"><path id="SvgjsPath1341" d="M449.4086142793858 147.64653672575628 426.65072831303723 195.40890427226668" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1342"><path id="SvgjsPath1343" d="M476.9732850943874 148.5122427664487 496.5327386789104 192.4317552590934" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1344"><path id="SvgjsPath1345" d="M542.6032976777171 149.21677222462017 521.111622891671 193.53930656473733" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1346"><path id="SvgjsPath1347" d="M435.2055460411434 213.90811029153042 486.24616903219385 213.90811029153042" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1348" transform="translate(382.5834179214769,69.00304095806086)"><path id="SvgjsPath1349" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1350"><text id="SvgjsText1351" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1352" dy="27" x="19"><tspan id="SvgjsTspan1353">6</tspan></tspan></text></g></g><g id="SvgjsG1354" transform="translate(355.8937492235068,177.66017206944582)"><path id="SvgjsPath1355" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1356"><text id="SvgjsText1357" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1358" dy="27" x="19"><tspan id="SvgjsTspan1359">3</tspan></tspan></text></g></g><g id="SvgjsG1360" transform="translate(408.8009425639716,152.4163802912284)"><path id="SvgjsPath1361" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1362"><text id="SvgjsText1363" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1364" dy="27" x="19"><tspan id="SvgjsTspan1365">6</tspan></tspan></text></g></g><g id="SvgjsG1366" transform="translate(404.24882294692543,102.62231034680701)"><path id="SvgjsPath1367" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1368"><text id="SvgjsText1369" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1370" dy="27" x="19"><tspan id="SvgjsTspan1371">5</tspan></tspan></text></g></g><g id="SvgjsG1372" transform="translate(446.27917826130124,218.19348592344863)"><path id="SvgjsPath1373" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1374"><text id="SvgjsText1375" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1376" dy="27" x="19"><tspan id="SvgjsTspan1377">6</tspan></tspan></text></g></g><g id="SvgjsG1378" transform="translate(474.1923211492276,154.71843901749355)"><path id="SvgjsPath1379" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1380"><text id="SvgjsText1381" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1382" dy="27" x="19"><tspan id="SvgjsTspan1383">4</tspan></tspan></text></g></g><g id="SvgjsG1384" transform="translate(519.9967727631033,168.02464418762588)"><path id="SvgjsPath1385" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1386"><text id="SvgjsText1387" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1388" dy="27" x="19"><tspan id="SvgjsTspan1389">2</tspan></tspan></text></g></g><g id="SvgjsG1390" transform="translate(456.90762242701066,79.68057729485474)"><path id="SvgjsPath1391" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1392"><text id="SvgjsText1393" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1394" dy="27" x="19"><tspan id="SvgjsTspan1395">1</tspan></tspan></text></g></g><g id="SvgjsG1396" transform="translate(494.38585812434076,128.55697791719786)"><path id="SvgjsPath1397" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1398"><text id="SvgjsText1399" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1400" dy="27" x="19"><tspan id="SvgjsTspan1401">5</tspan></tspan></text></g></g><g id="SvgjsG1402" transform="translate(503.5763089769971,69.00304095806086)"><path id="SvgjsPath1403" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1404"><text id="SvgjsText1405" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1406" dy="27" x="19"><tspan id="SvgjsTspan1407">5</tspan></tspan></text></g></g><g id="SvgjsG1408" transform="translate(273.2304084628777,105.00434562893429)"><path id="SvgjsPath1409" d="M0 14.233051185431238 41.11566512086273 14.233051185431238 41.11566512086273 0 62.68089418969794 21.565229068835208 41.11566512086273 43.130458137670416 41.11566512086273 28.89740695223918 0 28.89740695223918 0 14.233051185431238Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1410"><text id="SvgjsText1411" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.940229068835208" transform="rotate(0)"></text></g></g><g id="SvgjsG1412" transform="translate(769.1243783980906,107.90941817044063)"><path id="SvgjsPath1413" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1414"><text id="SvgjsText1415" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1416" transform="translate(773.6764980151363,119.07731371794443)"><path id="SvgjsPath1417" d="M0 0 35.08464730919109 0 35.08464730919109 21.712336364741102 0 21.712336364741102Z" stroke="none" fill="none"></path><g id="SvgjsG1418"><text id="SvgjsText1419" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="36px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.893831817629449" transform="rotate(0)"><tspan id="SvgjsTspan1420" dy="27" x="18"><tspan id="SvgjsTspan1421">3</tspan></tspan></text></g></g><g id="SvgjsG1422" transform="translate(769.1243783980906,30.816151522739005)"><path id="SvgjsPath1423" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1424"><text id="SvgjsText1425" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1426" transform="translate(765.3636220965345,42.2385660425241)"><path id="SvgjsPath1427" d="M0 0 51.710399146395474 0 51.710399146395474 22.94173305195242 0 22.94173305195242Z" stroke="none" fill="none"></path><g id="SvgjsG1428"><text id="SvgjsText1429" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="52px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.27913347402379" transform="rotate(0)"><tspan id="SvgjsTspan1430" dy="27" x="26"><tspan id="SvgjsTspan1431">1</tspan></tspan></text></g></g><g id="SvgjsG1432" transform="translate(679.9357435543652,108.8270874925189)"><path id="SvgjsPath1433" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1434"><text id="SvgjsText1435" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1436" transform="translate(686.6463944003187,118.46261537433884)"><path id="SvgjsPath1437" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1438"><text id="SvgjsText1439" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1440" dy="27" x="19"><tspan id="SvgjsTspan1441">2</tspan></tspan></text></g></g><g id="SvgjsG1442" transform="translate(858.8323753293128,108.82708749251879)"><path id="SvgjsPath1443" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1444"><text id="SvgjsText1445" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1446" transform="translate(861.2629077862136,118.46261537433884)"><path id="SvgjsPath1447" d="M0 0 40.09762050154925 0 40.09762050154925 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1448"><text id="SvgjsText1449" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="41px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1450" dy="27" x="20.5"><tspan id="SvgjsTspan1451">4</tspan></tspan></text></g></g><g id="SvgjsG1452" transform="translate(717.4139792516951,191.42521190061723)"><path id="SvgjsPath1453" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1454"><text id="SvgjsText1455" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1456" transform="translate(724.1246300976488,201.06073978243717)"><path id="SvgjsPath1457" d="M0 0 37.22369328360896 0 37.22369328360896 21.106394407796284 0 21.106394407796284Z" stroke="none" fill="none"></path><g id="SvgjsG1458"><text id="SvgjsText1459" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-9.196802796101858" transform="rotate(0)"><tspan id="SvgjsTspan1460" dy="27" x="19"><tspan id="SvgjsTspan1461">5</tspan></tspan></text></g></g><g id="SvgjsG1462" transform="translate(813.313264941374,190.5075425785392)"><path id="SvgjsPath1463" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1464"><text id="SvgjsText1465" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1466" transform="translate(814.6434887860289,201.97840910451532)"><path id="SvgjsPath1467" d="M0 0 44.18888654328375 0 44.18888654328375 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1468"><text id="SvgjsText1469" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="45px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1470" dy="27" x="22.5"><tspan id="SvgjsTspan1471">6</tspan></tspan></text></g></g><g id="SvgjsG1472"><path id="SvgjsPath1473" d="M770.5124064113561 65.69370651295856 716.2411415773411 112.91193650770799" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1474"><path id="SvgjsPath1475" d="M810.2642185046955 66.10343358258649 864.0674191319633 114.74679407774045" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1476"><path id="SvgjsPath1477" d="M791.218821669732 75.86427898248758 791.218821669732 106.90941817044063" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1478"><path id="SvgjsPath1479" d="M768.1243783980906 129.93348190031497 725.1246300976488 129.93348190031497" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1480"><path id="SvgjsPath1481" d="M814.313264941374 129.93348190031497 857.8323753293128 129.93348190031497" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1482"><path id="SvgjsPath1483" d="M702.5433457152101 153.73350858176252 726.9152332353419 194.4971711381795" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1484"><path id="SvgjsPath1485" d="M776.8059340332209 148.10537138679547 754.0480480668723 195.86773893330587" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1486"><path id="SvgjsPath1487" d="M804.3706048482225 148.9710774274879 823.9300584327455 192.89058992013258" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1488"><path id="SvgjsPath1489" d="M870.0006174315522 149.67560688565936 848.5089426455061 193.99814122577652" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1490"><path id="SvgjsPath1491" d="M762.6028657949785 214.3669449525696 813.6434887860289 214.3669449525696" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1492" transform="translate(709.980737675312,69.46187561910006)"><path id="SvgjsPath1493" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1494"><text id="SvgjsText1495" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1496" dy="27" x="19"><tspan id="SvgjsTspan1497">6</tspan></tspan></text></g></g><g id="SvgjsG1498" transform="translate(683.2910689773419,178.119006730485)"><path id="SvgjsPath1499" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1500"><text id="SvgjsText1501" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1502" dy="27" x="19"><tspan id="SvgjsTspan1503">3</tspan></tspan></text></g></g><g id="SvgjsG1504" transform="translate(736.1982623178067,152.87521495226758)"><path id="SvgjsPath1505" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1506"><text id="SvgjsText1507" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1508" dy="27" x="19"><tspan id="SvgjsTspan1509">6</tspan></tspan></text></g></g><g id="SvgjsG1510" transform="translate(731.6461427007605,103.0811450078462)"><path id="SvgjsPath1511" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1512"><text id="SvgjsText1513" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1514" dy="27" x="19"><tspan id="SvgjsTspan1515">5</tspan></tspan></text></g></g><g id="SvgjsG1516" transform="translate(773.6764980151363,218.65232058448782)"><path id="SvgjsPath1517" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1518"><text id="SvgjsText1519" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1520" dy="27" x="19"><tspan id="SvgjsTspan1521">6</tspan></tspan></text></g></g><g id="SvgjsG1522" transform="translate(801.5896409030627,155.17727367853274)"><path id="SvgjsPath1523" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1524"><text id="SvgjsText1525" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1526" dy="27" x="19"><tspan id="SvgjsTspan1527">4</tspan></tspan></text></g></g><g id="SvgjsG1528" transform="translate(847.3940925169384,168.48347884866507)"><path id="SvgjsPath1529" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1530"><text id="SvgjsText1531" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1532" dy="27" x="19"><tspan id="SvgjsTspan1533">2</tspan></tspan></text></g></g><g id="SvgjsG1534" transform="translate(784.3049421808457,80.13941195589393)"><path id="SvgjsPath1535" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1536"><text id="SvgjsText1537" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1538" dy="27" x="19"><tspan id="SvgjsTspan1539">1</tspan></tspan></text></g></g><g id="SvgjsG1540" transform="translate(821.7831778781758,129.01581257823705)"><path id="SvgjsPath1541" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1542"><text id="SvgjsText1543" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1544" dy="27" x="19"><tspan id="SvgjsTspan1545">5</tspan></tspan></text></g></g><g id="SvgjsG1546" transform="translate(830.9736287308322,69.46187561910006)"><path id="SvgjsPath1547" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1548"><text id="SvgjsText1549" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1550" dy="27" x="19"><tspan id="SvgjsTspan1551">5</tspan></tspan></text></g></g><g id="SvgjsG1552" transform="translate(606.9910584726622,114.18103884971515)"><path id="SvgjsPath1553" d="M0 14.233051185431238 41.11566512086273 14.233051185431238 41.11566512086273 0 62.68089418969794 21.565229068835208 41.11566512086273 43.130458137670416 41.11566512086273 28.89740695223918 0 28.89740695223918 0 14.233051185431238Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1554"><text id="SvgjsText1555" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.940229068835208" transform="rotate(0)"></text></g></g><g id="SvgjsG1556" transform="translate(772.4797038210672,373.51776301822576)"><path id="SvgjsPath1557" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1558"><text id="SvgjsText1559" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1560" transform="translate(777.031823438113,384.68565856572957)"><path id="SvgjsPath1561" d="M0 0 35.08464730919109 0 35.08464730919109 21.712336364741102 0 21.712336364741102Z" stroke="none" fill="none"></path><g id="SvgjsG1562"><text id="SvgjsText1563" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="36px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.893831817629449" transform="rotate(0)"><tspan id="SvgjsTspan1564" dy="27" x="18"><tspan id="SvgjsTspan1565">3</tspan></tspan></text></g></g><g id="SvgjsG1566" transform="translate(772.4797038210672,296.42449637052414)"><path id="SvgjsPath1567" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1568"><text id="SvgjsText1569" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1570" transform="translate(768.7189475195112,307.84691089030923)"><path id="SvgjsPath1571" d="M0 0 51.710399146395474 0 51.710399146395474 22.94173305195242 0 22.94173305195242Z" stroke="none" fill="none"></path><g id="SvgjsG1572"><text id="SvgjsText1573" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="52px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.27913347402379" transform="rotate(0)"><tspan id="SvgjsTspan1574" dy="27" x="26"><tspan id="SvgjsTspan1575">1</tspan></tspan></text></g></g><g id="SvgjsG1576" transform="translate(683.2910689773419,374.43543234030403)"><path id="SvgjsPath1577" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1578"><text id="SvgjsText1579" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1580" transform="translate(690.0017198232954,384.070960222124)"><path id="SvgjsPath1581" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1582"><text id="SvgjsText1583" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1584" dy="27" x="19"><tspan id="SvgjsTspan1585">2</tspan></tspan></text></g></g><g id="SvgjsG1586" transform="translate(862.1877007522894,374.4354323403039)"><path id="SvgjsPath1587" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1588"><text id="SvgjsText1589" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1590" transform="translate(864.6182332091903,384.070960222124)"><path id="SvgjsPath1591" d="M0 0 40.09762050154925 0 40.09762050154925 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1592"><text id="SvgjsText1593" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="41px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1594" dy="27" x="20.5"><tspan id="SvgjsTspan1595">4</tspan></tspan></text></g></g><g id="SvgjsG1596" transform="translate(720.7693046746717,457.03355674840236)"><path id="SvgjsPath1597" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1598"><text id="SvgjsText1599" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1600" transform="translate(727.4799555206255,466.6690846302223)"><path id="SvgjsPath1601" d="M0 0 37.22369328360896 0 37.22369328360896 21.106394407796284 0 21.106394407796284Z" stroke="none" fill="none"></path><g id="SvgjsG1602"><text id="SvgjsText1603" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-9.196802796101858" transform="rotate(0)"><tspan id="SvgjsTspan1604" dy="27" x="19"><tspan id="SvgjsTspan1605">5</tspan></tspan></text></g></g><g id="SvgjsG1606" transform="translate(816.6685903643506,456.1158874263243)"><path id="SvgjsPath1607" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1608"><text id="SvgjsText1609" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1610" transform="translate(817.9988142090056,467.58675395230046)"><path id="SvgjsPath1611" d="M0 0 44.18888654328375 0 44.18888654328375 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1612"><text id="SvgjsText1613" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="45px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1614" dy="27" x="22.5"><tspan id="SvgjsTspan1615">6</tspan></tspan></text></g></g><g id="SvgjsG1616"><path id="SvgjsPath1617" d="M773.8677318343327 331.3020513607437 719.5964670003177 378.5202813554931" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1618"><path id="SvgjsPath1619" d="M794.5741470927087 341.4726238302727 794.5741470927087 372.51776301822576" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1620"><path id="SvgjsPath1621" d="M771.4797038210672 395.5418267481001 728.4799555206255 395.5418267481001" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1622"><path id="SvgjsPath1623" d="M705.8986711381867 419.34185342954765 730.2705586583186 460.10551598596464" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1624"><path id="SvgjsPath1625" d="M780.1612594561975 413.7137162345806 757.403373489849 461.476083781091" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1626"><path id="SvgjsPath1627" d="M807.7259302711991 414.57942227527303 827.2853838557221 458.4989347679177" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1628"><path id="SvgjsPath1629" d="M873.3559428545288 415.2839517334445 851.8642680684827 459.60648607356165" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1630"><path id="SvgjsPath1631" d="M765.9581912179551 479.97528980035474 816.9988142090056 479.97528980035474" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1632" transform="translate(713.3360630982886,335.0702204668852)"><path id="SvgjsPath1633" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1634"><text id="SvgjsText1635" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1636" dy="27" x="19"><tspan id="SvgjsTspan1637">6</tspan></tspan></text></g></g><g id="SvgjsG1638" transform="translate(686.6463944003185,443.72735157827015)"><path id="SvgjsPath1639" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1640"><text id="SvgjsText1641" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1642" dy="27" x="19"><tspan id="SvgjsTspan1643">3</tspan></tspan></text></g></g><g id="SvgjsG1644" transform="translate(739.5535877407833,418.4835598000527)"><path id="SvgjsPath1645" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1646"><text id="SvgjsText1647" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1648" dy="27" x="19"><tspan id="SvgjsTspan1649">6</tspan></tspan></text></g></g><g id="SvgjsG1650" transform="translate(735.0014681237371,368.68948985563134)"><path id="SvgjsPath1651" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1652"><text id="SvgjsText1653" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1654" dy="27" x="19"><tspan id="SvgjsTspan1655">5</tspan></tspan></text></g></g><g id="SvgjsG1656" transform="translate(777.031823438113,484.26066543227296)"><path id="SvgjsPath1657" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1658"><text id="SvgjsText1659" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1660" dy="27" x="19"><tspan id="SvgjsTspan1661">6</tspan></tspan></text></g></g><g id="SvgjsG1662" transform="translate(804.9449663260393,420.7856185263179)"><path id="SvgjsPath1663" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1664"><text id="SvgjsText1665" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1666" dy="27" x="19"><tspan id="SvgjsTspan1667">4</tspan></tspan></text></g></g><g id="SvgjsG1668" transform="translate(850.749417939915,434.0918236964502)"><path id="SvgjsPath1669" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1670"><text id="SvgjsText1671" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1672" dy="27" x="19"><tspan id="SvgjsTspan1673">2</tspan></tspan></text></g></g><g id="SvgjsG1674" transform="translate(787.6602676038224,345.74775680367907)"><path id="SvgjsPath1675" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1676"><text id="SvgjsText1677" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1678" dy="27" x="19"><tspan id="SvgjsTspan1679">1</tspan></tspan></text></g></g><g id="SvgjsG1680" transform="translate(442.6641717945761,368.1638116610296)"><path id="SvgjsPath1681" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1682"><text id="SvgjsText1683" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1684" transform="translate(447.2162914116218,379.33170720853343)"><path id="SvgjsPath1685" d="M0 0 35.08464730919109 0 35.08464730919109 21.712336364741102 0 21.712336364741102Z" stroke="none" fill="none"></path><g id="SvgjsG1686"><text id="SvgjsText1687" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="36px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.893831817629449" transform="rotate(0)"><tspan id="SvgjsTspan1688" dy="27" x="18"><tspan id="SvgjsTspan1689">3</tspan></tspan></text></g></g><g id="SvgjsG1690" transform="translate(442.6641717945761,291.070545013328)"><path id="SvgjsPath1691" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1692"><text id="SvgjsText1693" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1694" transform="translate(438.90341549302,302.4929595331131)"><path id="SvgjsPath1695" d="M0 0 51.710399146395474 0 51.710399146395474 22.94173305195242 0 22.94173305195242Z" stroke="none" fill="none"></path><g id="SvgjsG1696"><text id="SvgjsText1697" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="52px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.27913347402379" transform="rotate(0)"><tspan id="SvgjsTspan1698" dy="27" x="26"><tspan id="SvgjsTspan1699">1</tspan></tspan></text></g></g><g id="SvgjsG1700" transform="translate(353.4755369508507,369.0814809831079)"><path id="SvgjsPath1701" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1702"><text id="SvgjsText1703" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1704" transform="translate(360.18618779680423,378.71700886492783)"><path id="SvgjsPath1705" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1706"><text id="SvgjsText1707" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1708" dy="27" x="19"><tspan id="SvgjsTspan1709">2</tspan></tspan></text></g></g><g id="SvgjsG1710" transform="translate(532.3721687257982,369.0814809831078)"><path id="SvgjsPath1711" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1712"><text id="SvgjsText1713" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1714" transform="translate(534.8027011826991,378.71700886492783)"><path id="SvgjsPath1715" d="M0 0 40.09762050154925 0 40.09762050154925 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1716"><text id="SvgjsText1717" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="41px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1718" dy="27" x="20.5"><tspan id="SvgjsTspan1719">4</tspan></tspan></text></g></g><g id="SvgjsG1720" transform="translate(390.9537726481806,451.6796053912062)"><path id="SvgjsPath1721" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1722"><text id="SvgjsText1723" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1724" transform="translate(397.6644234941343,461.31513327302594)"><path id="SvgjsPath1725" d="M0 0 37.22369328360896 0 37.22369328360896 21.106394407796284 0 21.106394407796284Z" stroke="none" fill="none"></path><g id="SvgjsG1726"><text id="SvgjsText1727" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-9.196802796101858" transform="rotate(0)"><tspan id="SvgjsTspan1728" dy="27" x="19"><tspan id="SvgjsTspan1729">5</tspan></tspan></text></g></g><g id="SvgjsG1730" transform="translate(486.85305833785947,450.7619360691282)"><path id="SvgjsPath1731" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1732"><text id="SvgjsText1733" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1734" transform="translate(488.1832821825144,462.2328025951043)"><path id="SvgjsPath1735" d="M0 0 44.18888654328375 0 44.18888654328375 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1736"><text id="SvgjsText1737" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="45px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1738" dy="27" x="22.5"><tspan id="SvgjsTspan1739">6</tspan></tspan></text></g></g><g id="SvgjsG1740"><path id="SvgjsPath1741" d="M464.75861506621754 336.1186724730766 464.75861506621754 367.1638116610296" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1742"><path id="SvgjsPath1743" d="M441.6641717945761 390.18787539090397 398.6644234941343 390.18787539090397" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1744"><path id="SvgjsPath1745" d="M376.0831391116956 413.9879020723515 400.4550266318274 454.7515646287685" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1746"><path id="SvgjsPath1747" d="M450.34572742970636 408.35976487738446 427.5878414633578 456.12213242389487" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1748"><path id="SvgjsPath1749" d="M477.91039824470795 409.2254709180769 497.46985182923095 453.1449834107216" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1750"><path id="SvgjsPath1751" d="M543.5404108280377 409.93000037624836 522.0487360419916 454.2525347163655" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1752"><path id="SvgjsPath1753" d="M436.14265919146396 474.6213384431586 487.1832821825144 474.6213384431586" stroke-dasharray="3,3" stroke="#323232" stroke-width="4" fill="none"></path></g><g id="SvgjsG1754" transform="translate(356.83086237382736,438.373400221074)"><path id="SvgjsPath1755" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1756"><text id="SvgjsText1757" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1758" dy="27" x="19"><tspan id="SvgjsTspan1759">3</tspan></tspan></text></g></g><g id="SvgjsG1760" transform="translate(409.73805571429216,413.1296084428566)"><path id="SvgjsPath1761" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1762"><text id="SvgjsText1763" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1764" dy="27" x="19"><tspan id="SvgjsTspan1765">6</tspan></tspan></text></g></g><g id="SvgjsG1766" transform="translate(405.185936097246,363.3355384984352)"><path id="SvgjsPath1767" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1768"><text id="SvgjsText1769" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1770" dy="27" x="19"><tspan id="SvgjsTspan1771">5</tspan></tspan></text></g></g><g id="SvgjsG1772" transform="translate(447.2162914116218,478.9067140750768)"><path id="SvgjsPath1773" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1774"><text id="SvgjsText1775" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1776" dy="27" x="19"><tspan id="SvgjsTspan1777">6</tspan></tspan></text></g></g><g id="SvgjsG1778" transform="translate(475.12943429954817,415.43166716912174)"><path id="SvgjsPath1779" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1780"><text id="SvgjsText1781" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1782" dy="27" x="19"><tspan id="SvgjsTspan1783">4</tspan></tspan></text></g></g><g id="SvgjsG1784" transform="translate(520.9338859134239,428.73787233925407)"><path id="SvgjsPath1785" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1786"><text id="SvgjsText1787" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1788" dy="27" x="19"><tspan id="SvgjsTspan1789">2</tspan></tspan></text></g></g><g id="SvgjsG1790" transform="translate(457.8447355773312,340.39380544648293)"><path id="SvgjsPath1791" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1792"><text id="SvgjsText1793" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1794" dy="27" x="19"><tspan id="SvgjsTspan1795">1</tspan></tspan></text></g></g><g id="SvgjsG1796" transform="translate(114.19217887810532,365.533827421149)"><path id="SvgjsPath1797" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1798"><text id="SvgjsText1799" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1800" transform="translate(118.74429849515104,376.7017229686528)"><path id="SvgjsPath1801" d="M0 0 35.08464730919109 0 35.08464730919109 21.712336364741102 0 21.712336364741102Z" stroke="none" fill="none"></path><g id="SvgjsG1802"><text id="SvgjsText1803" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="36px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.893831817629449" transform="rotate(0)"><tspan id="SvgjsTspan1804" dy="27" x="18"><tspan id="SvgjsTspan1805">3</tspan></tspan></text></g></g><g id="SvgjsG1806" transform="translate(114.19217887810532,288.4405607734475)"><path id="SvgjsPath1807" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1808"><text id="SvgjsText1809" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1810" transform="translate(110.43142257654927,299.86297529323247)"><path id="SvgjsPath1811" d="M0 0 51.710399146395474 0 51.710399146395474 22.94173305195242 0 22.94173305195242Z" stroke="none" fill="none"></path><g id="SvgjsG1812"><text id="SvgjsText1813" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="52px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.27913347402379" transform="rotate(0)"><tspan id="SvgjsTspan1814" dy="27" x="26"><tspan id="SvgjsTspan1815">1</tspan></tspan></text></g></g><g id="SvgjsG1816" transform="translate(25.003544034379956,366.4514967432274)"><path id="SvgjsPath1817" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1818"><text id="SvgjsText1819" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1820" transform="translate(31.71419488033348,376.0870246250472)"><path id="SvgjsPath1821" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1822"><text id="SvgjsText1823" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1824" dy="27" x="19"><tspan id="SvgjsTspan1825">2</tspan></tspan></text></g></g><g id="SvgjsG1826" transform="translate(203.9001758093275,366.45149674322715)"><path id="SvgjsPath1827" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1828"><text id="SvgjsText1829" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1830" transform="translate(206.33070826622838,376.0870246250472)"><path id="SvgjsPath1831" d="M0 0 40.09762050154925 0 40.09762050154925 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1832"><text id="SvgjsText1833" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="41px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1834" dy="27" x="20.5"><tspan id="SvgjsTspan1835">4</tspan></tspan></text></g></g><g id="SvgjsG1836" transform="translate(62.48177973170982,449.0496211513257)"><path id="SvgjsPath1837" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1838"><text id="SvgjsText1839" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1840" transform="translate(69.19243057766357,458.68514903314554)"><path id="SvgjsPath1841" d="M0 0 37.22369328360896 0 37.22369328360896 21.106394407796284 0 21.106394407796284Z" stroke="none" fill="none"></path><g id="SvgjsG1842"><text id="SvgjsText1843" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-9.196802796101858" transform="rotate(0)"><tspan id="SvgjsTspan1844" dy="27" x="19"><tspan id="SvgjsTspan1845">5</tspan></tspan></text></g></g><g id="SvgjsG1846" transform="translate(158.3810654213887,448.13195182924755)"><path id="SvgjsPath1847" d="M0 22.02406372987432C0-7.341354576624774 44.18888654328341-7.341354576624774 44.18888654328341 22.02406372987432 44.18888654328341 51.389482036373415 0 51.389482036373415 0 22.02406372987432Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#bbdefb"></path><g id="SvgjsG1848"><text id="SvgjsText1849" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="25px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="10.274063729874321" transform="rotate(0)"></text></g></g><g id="SvgjsG1850" transform="translate(159.71128926604365,459.6028183552239)"><path id="SvgjsPath1851" d="M0 0 44.18888654328375 0 44.18888654328375 22.941733051952422 0 22.941733051952422Z" stroke="none" fill="none"></path><g id="SvgjsG1852"><text id="SvgjsText1853" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="45px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023789" transform="rotate(0)"><tspan id="SvgjsTspan1854" dy="27" x="22.5"><tspan id="SvgjsTspan1855">6</tspan></tspan></text></g></g><g id="SvgjsG1856"><path id="SvgjsPath1857" d="M136.2866221497468 333.48868823319594 136.2866221497468 364.533827421149" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1858"><path id="SvgjsPath1859" d="M113.19217887810532 387.55789115102334 70.19243057766357 387.55789115102334" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1860"><path id="SvgjsPath1861" d="M47.611146195224705 411.3579178324709 71.98303371535678 452.121580388888" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1862"><path id="SvgjsPath1863" d="M149.4384053282373 406.5954866781964 168.99785891276008 450.51499917084095" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1864"><path id="SvgjsPath1865" d="M215.06841791156683 407.30001613636784 193.57674312552092 451.6225504764849" stroke="#388e3c" stroke-width="4" fill="none"></path></g><g id="SvgjsG1866" transform="translate(28.358869457356604,435.7434159811935)"><path id="SvgjsPath1867" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1868"><text id="SvgjsText1869" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1870" dy="27" x="19"><tspan id="SvgjsTspan1871">3</tspan></tspan></text></g></g><g id="SvgjsG1872" transform="translate(76.71394318077523,360.7055542585547)"><path id="SvgjsPath1873" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1874"><text id="SvgjsText1875" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1876" dy="27" x="19"><tspan id="SvgjsTspan1877">5</tspan></tspan></text></g></g><g id="SvgjsG1878" transform="translate(129.37274266086047,419.8400665273939)"><path id="SvgjsPath1879" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1880"><text id="SvgjsText1881" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1882" dy="27" x="19"><tspan id="SvgjsTspan1883">4</tspan></tspan></text></g></g><g id="SvgjsG1884" transform="translate(192.4618929969531,426.10788809937344)"><path id="SvgjsPath1885" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1886"><text id="SvgjsText1887" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1888" dy="27" x="19"><tspan id="SvgjsTspan1889">2</tspan></tspan></text></g></g><g id="SvgjsG1890" transform="translate(129.37274266086047,337.7638212066024)"><path id="SvgjsPath1891" d="M0 0 37.47823569732988 0 37.47823569732988 22.941733051952237 0 22.941733051952237Z" stroke="none" fill="none"></path><g id="SvgjsG1892"><text id="SvgjsText1893" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="22px" width="38px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="22px" weight="700" font-style="" opacity="1" y="-8.279133474023881" transform="rotate(0)"><tspan id="SvgjsTspan1894" dy="27" x="19"><tspan id="SvgjsTspan1895">1</tspan></tspan></text></g></g><g id="SvgjsG1896" transform="matrix(6.123233995736766e-17,1,-1,6.123233995736766e-17,720.2055418863404,252.85649584117374)"><path id="SvgjsPath1897" d="M0 14.233051185431238 41.11566512086273 14.233051185431238 41.11566512086273 0 62.68089418969794 21.565229068835208 41.11566512086273 43.130458137670416 41.11566512086273 28.89740695223918 0 28.89740695223918 0 14.233051185431238Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1898"><text id="SvgjsText1899" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.940229068835208" transform="rotate(0)"></text></g></g><g id="SvgjsG1900" transform="matrix(-1,1.2246467991473532e-16,-1.2246467991473532e-16,-1,665.7628644045417,425.9707596513423)"><path id="SvgjsPath1901" d="M0 14.233051185431238 41.11566512086273 14.233051185431238 41.11566512086273 0 62.68089418969794 21.565229068835208 41.11566512086273 43.130458137670416 41.11566512086273 28.89740695223918 0 28.89740695223918 0 14.233051185431238Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1902"><text id="SvgjsText1903" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.940229068835208" transform="rotate(0)"></text></g></g><g id="SvgjsG1904" transform="matrix(-1,1.2246467991473532e-16,-1.2246467991473532e-16,-1,334.8538067873542,412.33437659470167)"><path id="SvgjsPath1905" d="M0 14.233051185431238 41.11566512086273 14.233051185431238 41.11566512086273 0 62.68089418969794 21.565229068835208 41.11566512086273 43.130458137670416 41.11566512086273 28.89740695223918 0 28.89740695223918 0 14.233051185431238Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1906"><text id="SvgjsText1907" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.940229068835208" transform="rotate(0)"></text></g></g></svg></div><p>编写主函数：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    Graph G;</span><br><span class="line">    <span class="type">int</span> u,v;</span><br><span class="line">    G.num = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)&#123;</span><br><span class="line">        G.nodes.<span class="built_in">push_back</span>(i+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        G.edges.<span class="built_in">push_back</span>(&#123;u,v&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> w[<span class="number">10</span>]= &#123;<span class="number">6</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">6</span>&#125;;</span><br><span class="line">    vector&lt;Edge&gt; MST = <span class="built_in">MST_Prim</span>(G,w);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; MST.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; MST[i].u &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; MST[i].v &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">输入(边集):</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br><span class="line">2 3</span><br><span class="line">2 5</span><br><span class="line">3 4</span><br><span class="line">3 5</span><br><span class="line">3 6</span><br><span class="line">4 6</span><br><span class="line">5 6</span><br><span class="line"></span><br><span class="line">输出(边集)：</span><br><span class="line">(3, 1)</span><br><span class="line">(6, 3)</span><br><span class="line">(4, 6)</span><br><span class="line">(2, 3)</span><br><span class="line">(5, 2)</span><br></pre></td></tr></table></figure><p>Prefect！</p><h2 id="Kruskal算法">Kruskal算法</h2><p><strong>Kruskal</strong>算法的核心是与 Prim算法 不同。<br>Kruskal算法并不要求每一步所选<strong>最小权边</strong>都是相互连通的。换言之，Kruskal算法中第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span></span></span></span> 步产生的子集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 不一定是一棵子树，而有可能是森林。当然，即使是森林也不可能出现环。</p><p>不难发现，Prim算法因为每一步仅选取一个点及其轻量级边纳入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span>，所以可以保证<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 中的边一定不构成回路，且是一棵树，而Kruskal算法则需要有一个<strong>判断是否构成回路的策略</strong>。这个策略可以利用<strong>并查集</strong>这种数据结构解决。</p><p>综上，Kruskal算法的思想就是，先对边集进行升序<strong>排列</strong>，然后考察当前最小边纳入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span> 之后是否构成回路，如果构成回路则跳过并寻找下一条边。</p><h4 id="算法伪码-2">算法伪码</h4><ul><li>输入：连通图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span>，边权<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span></li><li>输出：最小生成树的边集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">A</span></span></span></span></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>Algorithm: </mtext><mtext>  </mtext><mtext>MST-Kruskal</mtext><mo stretchy="false">(</mo><mi>G</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>1.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">f</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">r</mi></mrow><mtext>  </mtext><mtext>each </mtext><mi>u</mi><mo>∈</mo><mi>G</mi><mi mathvariant="normal">.</mi><mi>V</mi><mtext>  </mtext><mrow><mi mathvariant="bold">d</mi><mi mathvariant="bold">o</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>2.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mtext>  </mtext><mtext>Make-Set</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>3.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>Q</mi><mo>←</mo><mi>G</mi><mi mathvariant="normal">.</mi><mi>E</mi><mtext>  </mtext><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>Q</mi><mtext>为按权重 </mtext><mi>w</mi><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">)</mo><mtext> 递增的优先队列</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>4.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mi>A</mi><mo>←</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>5.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">p</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">a</mi><mi mathvariant="bold">t</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>6.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>←</mo><mtext>Extract-min</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>7.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mrow><mi mathvariant="bold">i</mi><mi mathvariant="bold">f</mi></mrow><mtext>  </mtext><mtext>Find-Set</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mo mathvariant="normal">≠</mo><mtext>Find-Set</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo><mtext>  </mtext><mrow><mi mathvariant="bold">t</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>8.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mi>A</mi><mo>←</mo><mi>A</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>u</mi><mi mathvariant="normal">.</mi><mi>π</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>9.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mspace width="2em"><mspace width="2em"><mtext>Union</mtext><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>10.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">u</mi><mi mathvariant="bold">n</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">l</mi></mrow><mtext>  </mtext><mi mathvariant="normal">∣</mi><mi>A</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>11.</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mtext>  </mtext><mrow><mi mathvariant="bold">r</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">n</mi></mrow><mtext>  </mtext><mi>A</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} &amp;\text{Algorithm: }\;\text{MST-Kruskal}(G,w)\\\\ 1.&amp;\;\mathbf{for}\;\text{each }u\in G.V\;\mathbf{do}\\ 2.&amp;\;\qquad\;\text{Make-Set}(u)\\ 3.&amp;\;Q\leftarrow G.E\;//Q\text{为按权重 }w(e)\text{ 递增的优先队列}\\ 4.&amp;\;A\leftarrow\varnothing\\ 5.&amp;\;\mathbf{repeat}\\ 6.&amp;\;\qquad (u,v)\leftarrow\text{Extract-min}(Q)\\ 7.&amp;\;\qquad\mathbf{if}\;\text{Find-Set}(u)\neq\text{Find-Set}(u)\;\mathbf{then}\\ 8.&amp;\;\qquad\qquad A\leftarrow A\cup\{(u,u.\pi)\}\\ 9.&amp;\;\qquad\qquad\text{Union}(u,v)\\ 10.&amp;\;\mathbf{until}\;|A|=|V|-1\\ 11.&amp;\;\mathbf{return}\;A \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:19.5em;vertical-align:-9.5em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:10em"><span style="top:-12.16em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-10.66em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1.</span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2.</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">3.</span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">4.</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">5.</span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">6.</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">7.</span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">8.</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">9.</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">10.</span></span></span><span style="top:5.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">11.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.5em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:10em"><span style="top:-12.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mord text"><span class="mord">Algorithm: </span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">MST-Kruskal</span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mclose">)</span></span></span><span style="top:-9.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">for</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">each </span></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">do</span></span></span></span><span style="top:-7.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Make-Set</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span><span style="top:-6.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">G</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">//</span><span class="mord mathnormal">Q</span><span class="mord text"><span class="mord cjk_fallback">为按权重</span><span class="mord"> </span></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mord text"><span class="mord"> </span><span class="mord cjk_fallback">递增的优先队列</span></span></span></span><span style="top:-4.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord amsrm">∅</span></span></span><span style="top:-3.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">repeat</span></span></span></span><span style="top:-1.66em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Extract-min</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span><span style="top:-.16em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord"><span class="mord mathbf" style="margin-right:.10903em">if</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Find-Set</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:.8889em;vertical-align:-.1944em"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord text"><span class="mord">Find-Set</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">then</span></span></span></span><span style="top:1.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span><span class="mopen">{(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal">u</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:.03588em">π</span><span class="mclose">)}</span></span></span><span style="top:2.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mspace" style="margin-right:2em"></span><span class="mspace" style="margin-right:2em"></span><span class="mord text"><span class="mord">Union</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span><span style="top:4.34em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">until</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span><span class="mord">1</span></span></span><span style="top:5.84em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord"><span class="mord mathbf">return</span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:9.5em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>其中：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Make-Set</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Make-Set}(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Make-Set</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span> 用于创建集合，第 1到2 行用于为每一个结点单独创建一个集合（树）</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Find-Set</mtext><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Find-Set}(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Find-Set</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span> 返回用于表示元素<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">u</span></span></span></span> 所在的集合的元素，第 7 行 用于判断加入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span> 后是否构成环，即合并两颗树后是否仍是树</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Union</mtext><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Union}(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord text"><span class="mord">Union</span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span> 用于将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo separator="true">,</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">u,v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.1944em"></span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span></span></span></span> 所在集合进行合并</li></ul><p>分析得知，一共循环<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|E|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span> 次，每个循环下，生成集合、取出最小元、合并集合都在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log |E|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span> 下完成。因此该算法的时间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|E|\log |E|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>，如果注意到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi mathvariant="normal">∣</mi><mi>V</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">|E|\leq|V|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>，则还可以表示为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>E</mi><mi mathvariant="normal">∣</mi><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|E|\log|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord">∣</span><span class="mspace" style="margin-right:.1667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>。<br>空间复杂度为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(|V|)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span>。</p><h3 id="正确性证明-3">正确性证明</h3><p>利用<strong>数学归纳法</strong>.<br>证明 对于任意结点数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>V</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">|V|=n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 的无向图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span>，贪心算法都能得到一棵最小生成树.</p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">2</span></span></span></span> 时，算法能够直接从连接图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的两个端点中找到一条<strong>最小权边</strong>，显然能够得到最小生成树；</li><li><strong>假设</strong> 对于任意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 阶图，算法都能得到MST，下面说明对于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 阶图也能得出.</li></ol><p>对于任意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6667em;vertical-align:-.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:.6444em"></span><span class="mord">1</span></span></span></span> 阶图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> ，将其最小权边<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e=(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span> <strong>短接</strong>，如下图所示，将图化为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 阶图<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>。根据归纳假设，算法能够给出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的一棵 MST 记为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>。</p><div width="100%" style="overflow-x:auto"><svg id="SvgjsSvg1006" width="819.1624755859375" height="490.387451171875" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1086" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1087" d="M0 0 14 5 0 10 0 0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1318" markerWidth="14" markerHeight="10" refX="4" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1319" d="M14 0 0 5 14 10 14 0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker></defs><g id="SvgjsG1008" transform="translate(59.58735695799345,25.0081520353242)"><path id="SvgjsPath1009" d="M0 4Q0 0 4 0L329.8274461350437 0Q333.8274461350437 0 333.8274461350437 4L333.8274461350437 202.83797886708675Q333.8274461350437 206.83797886708675 329.8274461350437 206.83797886708675L4 206.83797886708675Q0 206.83797886708675 0 202.83797886708675Z" stroke-dasharray="10,6" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="314px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="92.79398943354337" transform="rotate(0)"></text></g></g><g id="SvgjsG1012" transform="translate(99.83481792154231,74.95948384625854)"><path id="SvgjsPath1013" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1014"><text id="SvgjsText1015" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1016" transform="translate(96.46790955601784,84.37792002665105)"><path id="SvgjsPath1017" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1018"><text id="SvgjsText1019" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1020" dy="17" x="23.5"><tspan id="SvgjsTspan1021">1</tspan></tspan></text></g></g><g id="SvgjsG1022" transform="translate(160.9794911316946,126.04933613316166)"><path id="SvgjsPath1023" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1024"><text id="SvgjsText1025" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1026" transform="translate(157.6125827661702,135.46777231355395)"><path id="SvgjsPath1027" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1028"><text id="SvgjsText1029" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1030" dy="17" x="23.5"><tspan id="SvgjsTspan1031">3</tspan></tspan></text></g></g><g id="SvgjsG1032"><path id="SvgjsPath1033" d="M135.54437563428218 110.78967504708726 164.72324075651312 134.82906917353898" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1034" transform="translate(96.46790955601784,157.89262036210744)"><path id="SvgjsPath1035" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1036"><text id="SvgjsText1037" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1038" transform="translate(93.10100119049338,167.31105654249973)"><path id="SvgjsPath1039" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1040"><text id="SvgjsText1041" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1042" dy="17" x="23.5"><tspan id="SvgjsTspan1043">2</tspan></tspan></text></g></g><g id="SvgjsG1044"><path id="SvgjsPath1045" d="M119.53127247945952 119.01164671034417 116.33262829301316 156.89616575124455" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1046" transform="translate(321.2200699472394,79.74915749815591)"><path id="SvgjsPath1047" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1048"><text id="SvgjsText1049" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1050" transform="translate(316.69900303720124,89.16759367854843)"><path id="SvgjsPath1051" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1052"><text id="SvgjsText1053" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1054" dy="17" x="23.5"><tspan id="SvgjsTspan1055">4</tspan></tspan></text></g></g><g id="SvgjsG1056" transform="translate(317.85316158171486,152.56572495642877)"><path id="SvgjsPath1057" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1058"><text id="SvgjsText1059" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1060" transform="translate(314.48625321619056,161.98416113682129)"><path id="SvgjsPath1061" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1062"><text id="SvgjsText1063" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1064" dy="17" x="23.5"><tspan id="SvgjsTspan1065">5</tspan></tspan></text></g></g><g id="SvgjsG1066"><path id="SvgjsPath1067" d="M339.86556378635146 123.80186909578902 337.71110668853055 151.5687216120184" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1068" transform="translate(256.64416424885894,116.53361605765008)"><path id="SvgjsPath1069" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1070"><text id="SvgjsText1071" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1072"><path id="SvgjsPath1073" d="M324.04586273661835 114.1798878377258 293.0354188819831 126.3504281392004" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1074"><path id="SvgjsPath1075" d="M198.9392791288143 157.4975415563706 255.69647645550413 138.38066894103554" stroke="#000000" stroke-width="2" fill="none"></path></g><g id="SvgjsG1076"><path id="SvgjsPath1077" d="M133.99817074466188 188.92404729211125 319.2408324609456 184.18551715694412" stroke="#000000" stroke-width="2" fill="none"></path></g><g id="SvgjsG1078" transform="translate(252.1230973388208,126.04933613316166)"><path id="SvgjsPath1079" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1080"><text id="SvgjsText1081" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="16px" weight="700" font-style="" opacity="1" y="-2.7875759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1082" dy="20" x="23.5"><tspan id="SvgjsTspan1083">6</tspan></tspan></text></g></g><g id="SvgjsG1084"><path id="SvgjsPath1085" d="M253.22837556047915 64.04642533876495C294.00001525878906 67.58746337890625 306.00001525878906 86.58746337890625 302.41209809416443 108.64323748348534" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1086)"></path></g><g id="SvgjsG1088" transform="translate(184.0781937103876,47.81799981884183)"><path id="SvgjsPath1089" d="M0 0 92.84727654273802 0 92.84727654273802 31.931157679314218 0 31.931157679314218Z" stroke="none" fill="none"></path><g id="SvgjsG1090"><text id="SvgjsText1091" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="15px" width="93px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="15px" weight="700" font-style="" opacity="1" y="3.590578839657109" transform="rotate(0)"><tspan id="SvgjsTspan1092" dy="18" x="46.5"><tspan id="SvgjsTspan1093">短接</tspan></tspan></text></g></g><g id="SvgjsG1094" transform="translate(90.30284335874296,296.0341308465877)"><path id="SvgjsPath1095" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1096"><text id="SvgjsText1097" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1098" transform="translate(86.9359349932185,305.4525670269802)"><path id="SvgjsPath1099" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1100"><text id="SvgjsText1101" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1102" dy="17" x="23.5"><tspan id="SvgjsTspan1103">1</tspan></tspan></text></g></g><g id="SvgjsG1104" transform="translate(151.44751656889525,347.1239831334906)"><path id="SvgjsPath1105" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1106"><text id="SvgjsText1107" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1108" transform="translate(148.08060820337096,356.5424193138829)"><path id="SvgjsPath1109" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1110"><text id="SvgjsText1111" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1112" dy="17" x="23.5"><tspan id="SvgjsTspan1113">3</tspan></tspan></text></g></g><g id="SvgjsG1114"><path id="SvgjsPath1115" d="M126.01240107148294 331.8643220474164 155.1912661937139 355.9037161738679" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1116" transform="translate(86.93593499321838,378.9672673624366)"><path id="SvgjsPath1117" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1118"><text id="SvgjsText1119" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1120" transform="translate(83.56902662769397,388.3857035428289)"><path id="SvgjsPath1121" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1122"><text id="SvgjsText1123" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1124" dy="17" x="23.5"><tspan id="SvgjsTspan1125">2</tspan></tspan></text></g></g><g id="SvgjsG1126"><path id="SvgjsPath1127" d="M109.99929791666017 340.0862937106733 106.80065373021375 377.9708127515737" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1128" transform="translate(308.3211870189158,373.6403719567579)"><path id="SvgjsPath1129" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1130"><text id="SvgjsText1131" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1132" transform="translate(304.9542786533914,383.0588081371502)"><path id="SvgjsPath1133" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1134"><text id="SvgjsText1135" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1136" dy="17" x="23.5"><tspan id="SvgjsTspan1137">5</tspan></tspan></text></g></g><g id="SvgjsG1138" transform="translate(247.11218968605988,337.60826305797923)"><path id="SvgjsPath1139" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1140"><text id="SvgjsText1141" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1142"><path id="SvgjsPath1143" d="M189.4073045660151 378.57218855669953 246.16450189270506 359.4553159413647" stroke="#000000" stroke-width="2" fill="none"></path></g><g id="SvgjsG1144"><path id="SvgjsPath1145" d="M124.46619618186259 409.9986942924404 309.7088578981464 405.26016415727304" stroke="#000000" stroke-width="2" fill="none"></path></g><g id="SvgjsG1146" transform="translate(242.59112277602173,347.1239831334906)"><path id="SvgjsPath1147" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1148"><text id="SvgjsText1149" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="16px" weight="700" font-style="" opacity="1" y="-2.7875759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1150" dy="20" x="23.5"><tspan id="SvgjsTspan1151">4-6</tspan></tspan></text></g></g><g id="SvgjsG1152"><path id="SvgjsPath1153" d="M286.4858557588728 369.37904025424564 311.15327407805967 382.6210284026665" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1154" transform="translate(28.379204828386804,26.816917167779366)"><path id="SvgjsPath1155" d="M0 0 114.3836947535925 0 114.3836947535925 37.0134401144552 0 37.0134401144552Z" stroke="none" fill="none"></path><g id="SvgjsG1156"><text id="SvgjsText1157" font-family="Georgia" text-anchor="middle" font-size="23px" width="115px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="23px" weight="700" font-style="italic" opacity="1" y="-1.8682799427724" transform="rotate(0)"><tspan id="SvgjsTspan1158" dy="28" x="57.5"><tspan id="SvgjsTspan1159">G</tspan></tspan></text></g></g><g id="SvgjsG1160" transform="translate(59.58735695799345,256.35538128537723)"><path id="SvgjsPath1161" d="M0 4Q0 0 4 0L329.8274461350437 0Q333.8274461350437 0 333.8274461350437 4L333.8274461350437 202.83797886708675Q333.8274461350437 206.83797886708675 329.8274461350437 206.83797886708675L4 206.83797886708675Q0 206.83797886708675 0 202.83797886708675Z" stroke-dasharray="10,6" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1162"><text id="SvgjsText1163" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="314px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="92.79398943354337" transform="rotate(0)"></text></g></g><g id="SvgjsG1164" transform="translate(25.012296462862338,264.10822201365045)"><path id="SvgjsPath1165" d="M0 0 114.3836947535925 0 114.3836947535925 37.0134401144552 0 37.0134401144552Z" stroke="none" fill="none"></path><g id="SvgjsG1166"><text id="SvgjsText1167" font-family="Georgia" text-anchor="middle" font-size="23px" width="115px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="23px" weight="700" font-style="italic" opacity="1" y="-1.8682799427724" transform="rotate(0)"><tspan id="SvgjsTspan1168" dy="28" x="57.5"><tspan id="SvgjsTspan1169">G'</tspan></tspan></text></g></g><g id="SvgjsG1170" transform="translate(195.52975677384592,215.40522302138902)"><path id="SvgjsPath1171" d="M17.022202861030596 0 34.56023005118333 0 34.56023005118333 34.14134862888167 51.582432912213925 34.14134862888167 25.791216456106962 59.93256508498864 0 34.14134862888167 17.022202861030596 34.14134862888167 17.022202861030596 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1172"><text id="SvgjsText1173" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="73px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.344654288244886" transform="rotate(0)"></text></g></g><g id="SvgjsG1174" transform="translate(490.8876508049822,298.07824322830334)"><path id="SvgjsPath1175" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1176"><text id="SvgjsText1177" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1178" transform="translate(487.52074243945776,307.49667940869585)"><path id="SvgjsPath1179" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1180"><text id="SvgjsText1181" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1182" dy="17" x="23.5"><tspan id="SvgjsTspan1183">1</tspan></tspan></text></g></g><g id="SvgjsG1184" transform="translate(552.0323240151345,349.16809551520623)"><path id="SvgjsPath1185" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1186"><text id="SvgjsText1187" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1188" transform="translate(548.66541564961,358.5865316955985)"><path id="SvgjsPath1189" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1190"><text id="SvgjsText1191" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1192" dy="17" x="23.5"><tspan id="SvgjsTspan1193">3</tspan></tspan></text></g></g><g id="SvgjsG1194"><path id="SvgjsPath1195" d="M526.597208517722 333.90843442913206 555.7760736399531 357.94782855558356" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1196" transform="translate(487.5207424394574,381.01137974415224)"><path id="SvgjsPath1197" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1198"><text id="SvgjsText1199" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1200" transform="translate(484.153834073933,390.4298159245445)"><path id="SvgjsPath1201" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1202"><text id="SvgjsText1203" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1204" dy="17" x="23.5"><tspan id="SvgjsTspan1205">2</tspan></tspan></text></g></g><g id="SvgjsG1206"><path id="SvgjsPath1207" d="M510.5841053628993 342.13040609238897 507.38546117645285 380.01492513328935" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1208" transform="translate(708.905994465155,375.68448433847334)"><path id="SvgjsPath1209" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1210"><text id="SvgjsText1211" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1212" transform="translate(705.5390860996306,385.1029205188661)"><path id="SvgjsPath1213" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1214"><text id="SvgjsText1215" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1216" dy="17" x="23.5"><tspan id="SvgjsTspan1217">5</tspan></tspan></text></g></g><g id="SvgjsG1218" transform="translate(647.6969971322992,339.6523754396949)"><path id="SvgjsPath1219" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffe0b2"></path><g id="SvgjsG1220"><text id="SvgjsText1221" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1222"><path id="SvgjsPath1223" d="M589.9921120122542 380.6163009384152 646.7493093389444 361.49942832308034" stroke="#000000" stroke-width="2" fill="none"></path></g><g id="SvgjsG1224" transform="translate(643.175930222261,349.16809551520623)"><path id="SvgjsPath1225" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1226"><text id="SvgjsText1227" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="16px" weight="700" font-style="" opacity="1" y="-2.7875759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1228" dy="20" x="23.5"><tspan id="SvgjsTspan1229">4-6</tspan></tspan></text></g></g><g id="SvgjsG1230"><path id="SvgjsPath1231" d="M687.0706632051119 371.4231526359613 711.7380815242989 384.6651407843824" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1232" transform="translate(460.1721644042325,258.3994936670929)"><path id="SvgjsPath1233" d="M0 4Q0 0 4 0L329.8274461350437 0Q333.8274461350437 0 333.8274461350437 4L333.8274461350437 202.83797886708675Q333.8274461350437 206.83797886708675 329.8274461350437 206.83797886708675L4 206.83797886708675Q0 206.83797886708675 0 202.83797886708675Z" stroke-dasharray="10,6" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1234"><text id="SvgjsText1235" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="314px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="92.79398943354337" transform="rotate(0)"></text></g></g><g id="SvgjsG1236" transform="translate(425.5971039091015,266.1523343953661)"><path id="SvgjsPath1237" d="M0 0 114.3836947535925 0 114.3836947535925 37.0134401144552 0 37.0134401144552Z" stroke="none" fill="none"></path><g id="SvgjsG1238"><text id="SvgjsText1239" font-family="Georgia" text-anchor="middle" font-size="23px" width="115px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="23px" weight="700" font-style="italic" opacity="1" y="-1.8682799427724" transform="rotate(0)"><tspan id="SvgjsTspan1240" dy="28" x="57.5"><tspan id="SvgjsTspan1241">T'</tspan></tspan></text></g></g><g id="SvgjsG1242" transform="translate(460.17216440423283,25.0081520353242)"><path id="SvgjsPath1243" d="M0 4Q0 0 4 0L329.8274461350437 0Q333.8274461350437 0 333.8274461350437 4L333.8274461350437 202.83797886708675Q333.8274461350437 206.83797886708675 329.8274461350437 206.83797886708675L4 206.83797886708675Q0 206.83797886708675 0 202.83797886708675Z" stroke-dasharray="10,6" stroke="rgba(50,50,50,1)" stroke-width="2" fill="none"></path><g id="SvgjsG1244"><text id="SvgjsText1245" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="314px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="92.79398943354337" transform="rotate(0)"></text></g></g><g id="SvgjsG1246" transform="translate(500.41962536778146,74.95948384625854)"><path id="SvgjsPath1247" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1248"><text id="SvgjsText1249" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1250" transform="translate(497.05271700225705,84.37792002665105)"><path id="SvgjsPath1251" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1252"><text id="SvgjsText1253" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1254" dy="17" x="23.5"><tspan id="SvgjsTspan1255">1</tspan></tspan></text></g></g><g id="SvgjsG1256" transform="translate(561.5642985779336,126.04933613316166)"><path id="SvgjsPath1257" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1258"><text id="SvgjsText1259" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1260" transform="translate(558.1973902124092,135.46777231355395)"><path id="SvgjsPath1261" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1262"><text id="SvgjsText1263" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1264" dy="17" x="23.5"><tspan id="SvgjsTspan1265">3</tspan></tspan></text></g></g><g id="SvgjsG1266"><path id="SvgjsPath1267" d="M536.1291830805213 110.78967504708726 565.3080482027523 134.82906917353898" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1268" transform="translate(497.05271700225705,157.89262036210744)"><path id="SvgjsPath1269" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1270"><text id="SvgjsText1271" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1272" transform="translate(493.68580863673265,167.31105654249973)"><path id="SvgjsPath1273" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1274"><text id="SvgjsText1275" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1276" dy="17" x="23.5"><tspan id="SvgjsTspan1277">2</tspan></tspan></text></g></g><g id="SvgjsG1278"><path id="SvgjsPath1279" d="M520.1160799256985 119.01164671034417 516.9174357392521 156.89616575124455" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1280" transform="translate(721.8048773934786,79.74915749815591)"><path id="SvgjsPath1281" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1282"><text id="SvgjsText1283" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1284" transform="translate(717.2838104834404,89.16759367854843)"><path id="SvgjsPath1285" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1286"><text id="SvgjsText1287" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1288" dy="17" x="23.5"><tspan id="SvgjsTspan1289">4</tspan></tspan></text></g></g><g id="SvgjsG1290" transform="translate(718.437969027954,152.56572495642877)"><path id="SvgjsPath1291" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1292"><text id="SvgjsText1293" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1294" transform="translate(715.0710606624298,161.98416113682129)"><path id="SvgjsPath1295" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1296"><text id="SvgjsText1297" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="14px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="14px" weight="700" font-style="" opacity="1" y="-0.5375759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1298" dy="17" x="23.5"><tspan id="SvgjsTspan1299">5</tspan></tspan></text></g></g><g id="SvgjsG1300"><path id="SvgjsPath1301" d="M740.4503712325907 123.80186909578902 738.2959141347695 151.5687216120184" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1302" transform="translate(657.228971695098,116.53361605765008)"><path id="SvgjsPath1303" d="M0 21.52785412661127C0-7.17595137553709 39.56117329491248-7.17595137553709 39.56117329491248 21.52785412661127 39.56117329491248 50.23165962875963 0 50.23165962875963 0 21.52785412661127Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#fff9c4"></path><g id="SvgjsG1304"><text id="SvgjsText1305" font-family="微软雅黑" text-anchor="middle" font-size="14px" width="20px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="14px" weight="400" font-style="" opacity="1" y="9.77785412661127" transform="rotate(0)"></text></g></g><g id="SvgjsG1306"><path id="SvgjsPath1307" d="M724.6306701828573 114.1798878377258 693.6202263282223 126.3504281392004" stroke="#323232" stroke-width="2" fill="none"></path></g><g id="SvgjsG1308"><path id="SvgjsPath1309" d="M599.5240865750534 157.4975415563706 656.2812839017432 138.38066894103554" stroke="#000000" stroke-width="2" fill="none"></path></g><g id="SvgjsG1310" transform="translate(652.7079047850599,126.04933613316166)"><path id="SvgjsPath1311" d="M0 0 46.29499002596141 0 46.29499002596141 22.424848048553407 0 22.424848048553407Z" stroke="none" fill="none"></path><g id="SvgjsG1312"><text id="SvgjsText1313" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="16px" width="47px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="16px" weight="700" font-style="" opacity="1" y="-2.7875759757232963" transform="rotate(0)"><tspan id="SvgjsTspan1314" dy="20" x="23.5"><tspan id="SvgjsTspan1315">6</tspan></tspan></text></g></g><g id="SvgjsG1316"><path id="SvgjsPath1317" d="M653.8131830067183 64.04642533876495C684.0000152587891 61.58746337890625 710.0000152587891 80.58746337890625 702.9969055404036 108.64323748348534" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#SvgjsMarker1318)"></path></g><g id="SvgjsG1320" transform="translate(584.6630011566268,47.81799981884183)"><path id="SvgjsPath1321" d="M0 0 92.84727654273802 0 92.84727654273802 31.931157679314218 0 31.931157679314218Z" stroke="none" fill="none"></path><g id="SvgjsG1322"><text id="SvgjsText1323" font-family="&quot;Times New Roman&quot;" text-anchor="middle" font-size="15px" width="93px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="&quot;Times New Roman&quot;" size="15px" weight="700" font-style="" opacity="1" y="3.590578839657109" transform="rotate(0)"><tspan id="SvgjsTspan1324" dy="18" x="46.5"><tspan id="SvgjsTspan1325">恢复</tspan></tspan></text></g></g><g id="SvgjsG1326" transform="translate(428.96401227462604,26.816917167779366)"><path id="SvgjsPath1327" d="M0 0 114.3836947535925 0 114.3836947535925 37.0134401144552 0 37.0134401144552Z" stroke="none" fill="none"></path><g id="SvgjsG1328"><text id="SvgjsText1329" font-family="Georgia" text-anchor="middle" font-size="23px" width="115px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="23px" weight="700" font-style="italic" opacity="1" y="-1.8682799427724" transform="rotate(0)"><tspan id="SvgjsTspan1330" dy="28" x="57.5"><tspan id="SvgjsTspan1331">T</tspan></tspan></text></g></g><g id="SvgjsG1332" transform="matrix(-1,1.2246467991473532e-16,-1.2246467991473532e-16,-1,661.2844592794015,274.5729612031527)"><path id="SvgjsPath1333" d="M17.022202861030596 0 34.56023005118333 0 34.56023005118333 34.14134862888167 51.582432912213925 34.14134862888167 25.791216456106962 59.93256508498864 0 34.14134862888167 17.022202861030596 34.14134862888167 17.022202861030596 0Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1334"><text id="SvgjsText1335" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="73px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.344654288244886" transform="rotate(0)"></text></g></g><g id="SvgjsG1336" transform="translate(384.6367828127587,334.9096557528617)"><path id="SvgjsPath1337" d="M0 18.321652856655327 58.02769097935296 18.321652856655327 58.02769097935296 0 85.78777106519436 27.760080085841402 58.02769097935296 55.520160171682804 58.02769097935296 37.19850731502748 0 37.19850731502748 0 18.321652856655327Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1338"><text id="SvgjsText1339" font-family="Georgia" text-anchor="middle" font-size="16px" width="86px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="middle" family="Georgia" size="16px" weight="700" font-style="italic" opacity="1" y="13.760080085841402" transform="rotate(0)"><tspan id="SvgjsTspan1340" dy="20" x="43"><tspan id="SvgjsTspan1341">MST</tspan></tspan></text></g></g></svg></div><p>则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∪</mo><mo stretchy="false">{</mo><mi>e</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">T=T&#x27;\cup\{e\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">e</span><span class="mclose">}</span></span></span></span> 就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的一棵 MST，若不然，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∃</mi><msup><mi>T</mi><mo>∗</mo></msup><mo>∋</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">\exists T^*\ni e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7335em;vertical-align:-.0391em"></span><span class="mord">∃</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">∋</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> 为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6833em"></span><span class="mord mathnormal">G</span></span></span></span> 的 MST.</p><blockquote><p>注：就算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo mathvariant="normal">∉</mo><msup><mi>T</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">e\notin T^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:.0556em"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:.6887em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> 也可以通过加边再减边的方式得到包含<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">e</span></span></span></span> 的 MST.<br>（这部分更详细的解释已在Prim算法的正确性证明时给出）</p></blockquote><p>此时，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo>∗</mo><mo stretchy="false">)</mo><mo>&lt;</mo><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">)</mo><mo>⇒</mo><mi>w</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo>∗</mo></msup><mo>−</mo><mo stretchy="false">{</mo><mi>e</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo>&lt;</mo><mi>w</mi><mo stretchy="false">(</mo><mi>T</mi><mo>−</mo><mo stretchy="false">{</mo><mi>e</mi><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mo stretchy="false">(</mo><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(T*)\lt w(T)\Rightarrow w(T^*-\{e\})\lt w(T-\{e\})=w(T&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord">∗</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.6887em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">e</span><span class="mclose">})</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord mathnormal">e</span><span class="mclose">})</span><span class="mspace" style="margin-right:.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2778em"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>这与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7519em"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7519em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的最小生成树矛盾.</p><p>综上所述，Kruskal 算法能够给出任意<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.4306em"></span><span class="mord mathnormal">n</span></span></span></span> 阶图的MST.</p><h3 id="编程实现-3">编程实现</h3><p>采用 <code>C++</code> 进行编程实现.</p><p>首先声明必要的结构体以及以边权大小排序的优先队列：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">EDGE</span>&#123;</span><br><span class="line">    <span class="type">int</span> u,v;</span><br><span class="line">    <span class="type">int</span> w;</span><br><span class="line">&#125;Edge;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">GRAPH</span>&#123;</span><br><span class="line">    <span class="type">int</span> num; <span class="comment">//图结点个数</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; nodes</span><br><span class="line">    vector&lt;Edge&gt; edges;</span><br><span class="line">&#125;Graph;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span>&#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(Edge a, Edge b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.w &gt; b.w; <span class="comment">//小的优先级高 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> priority_queue&lt;Edge,vector&lt;Edge&gt;,cmp&gt; EdgeQue;</span><br></pre></td></tr></table></figure><p>利用 <code>vector</code> 自建并查集及其相关的合并查找函数：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">SET</span>&#123;</span><br><span class="line">    <span class="type">int</span> root;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">&#125;Set;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;Set&gt; <span class="title">MakeSet</span><span class="params">(vector&lt;<span class="type">int</span>&gt; a)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;Set&gt; <span class="title">set</span><span class="params">(a.size())</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        set[i].root = a[i];</span><br><span class="line">        set[i].value = a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> set;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SetUnion</span><span class="params">(vector&lt;Set&gt; &amp;set, <span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="built_in">max</span>(set[a].root, set[b].root);</span><br><span class="line">    <span class="type">int</span> j = <span class="built_in">min</span>(set[a].root, set[b].root);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; set.<span class="built_in">size</span>(); k++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(set[k].root == i)&#123;</span><br><span class="line">            set[k].root = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后是 Kruskal算法的实现：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;Edge&gt; <span class="title">MST_Kruskal</span><span class="params">(Graph G)</span></span>&#123;</span><br><span class="line">    vector&lt;Edge&gt; A;</span><br><span class="line">    vector&lt;Set&gt; set = <span class="built_in">MakeSet</span>(G.nodes);</span><br><span class="line">    EdgeQue Q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; G.edges.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        Q.<span class="built_in">push</span>(&#123;G.edges[i].u, G.edges[i].v, G.edges[i].w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        Edge e = Q.<span class="built_in">top</span>(); Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(set[e.u].root != set[e.v].root)&#123;</span><br><span class="line">            A.<span class="built_in">push_back</span>(&#123;e.u, e.v&#125;);</span><br><span class="line">            <span class="built_in">SetUnion</span>(set, e.u, e.v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (A.<span class="built_in">size</span>() &lt; G.num<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>利用和 Prim进行演示时相同的实例，编写主函数：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    Graph G;</span><br><span class="line">    <span class="type">int</span> u,v;</span><br><span class="line">    G.num = <span class="number">6</span>;</span><br><span class="line">    <span class="type">int</span> w[<span class="number">10</span>]= &#123;<span class="number">6</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">6</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)&#123;</span><br><span class="line">        G.nodes.<span class="built_in">push_back</span>(i+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        G.edges.<span class="built_in">push_back</span>(&#123;u,v,w[i]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;Edge&gt; MST = <span class="built_in">MST_Kruskal</span>(G);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; MST.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; MST[i].u &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; MST[i].v &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">输入(边集):</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br><span class="line">2 3</span><br><span class="line">2 5</span><br><span class="line">3 4</span><br><span class="line">3 5</span><br><span class="line">3 6</span><br><span class="line">4 6</span><br><span class="line">5 6</span><br><span class="line"></span><br><span class="line">输出(边集)：</span><br><span class="line">(1, 3)</span><br><span class="line">(4, 6)</span><br><span class="line">(2, 5)</span><br><span class="line">(3, 6)</span><br><span class="line">(2, 3)</span><br></pre></td></tr></table></figure><p>Prefect！</p><h2 id="参考">参考</h2><ol><li>《<strong>算法导论</strong>(原书第三版)》</li><li><a target="_blank" rel="noopener" href="https://www.icourse163.org/course/PKU-1002525003?tid=1464342452">算法设计与分析|中国大学MOOC</a></li><li><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/3398.html">哈夫曼树（赫夫曼树、最优树）详解</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40691051/article/details/102874220">C++优先队列自定义排序总结|CSDN</a></li></ol></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Huffman、Optimal-BST &amp; MST| 算法之于树</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://qslie.top/posts/900eb6a6/">https://qslie.top/posts/900eb6a6/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Slie</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2022-01-06</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-03-11</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><a class="post-meta__tags" href="/tags/%E8%B4%AA%E5%BF%83/">贪心</a></div><div class="post_share"><div class="social-share" data-image="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/MST_Sample.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload='this.media="all"'><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">打赏</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png"></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/alipay.png"></a><div class="post-qr-code-desc"></div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3"></audio><script defer src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/8802cff8/" title="记忆博物馆|2022.2"><img class="cover" src="https://z3.ax1x.com/2021/04/17/c5iSpj.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">记忆博物馆|2022.2</div></div></a></div><div class="next-post pull-right"><a href="/posts/509c7111/" title="一曲仙剑|2022.1"><img class="cover" src="https://z3.ax1x.com/2021/04/17/c5P76I.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">一曲仙剑|2022.1</div></div></a></div></nav><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s1.ax1x.com/2022/04/09/Likong.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Slie</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">182</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">98</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">45</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sliefamily"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=1hPHFQqPhpkbBVYbFjRC4q8YQ-A72EFL&amp;noverify=0" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://github.com/SlieFamily" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:sliewdyinwhite@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">秘密基地被发现啦！QAQ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">哈夫曼树|Huffman Tree</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E8%A7%A3%E7%A0%81"><span class="toc-number">1.1.</span> <span class="toc-text">字符解码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E4%B8%8E%E5%BD%A2%E5%BC%8F%E5%8C%96"><span class="toc-number">1.2.</span> <span class="toc-text">编码与形式化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E6%80%A7%E8%AF%81%E6%98%8E"><span class="toc-number">1.3.</span> <span class="toc-text">正确性证明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%AA%E5%BF%83%E9%80%89%E6%8B%A9%E6%80%A7%E8%B4%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">贪心选择性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E4%BC%98%E5%AD%90%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.2.</span> <span class="toc-text">最优子结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.4.</span> <span class="toc-text">编程实现</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">最优二叉检索树|Optimal Binary Search Tree</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A2%E5%BC%8F%E5%8C%96%E8%A1%A8%E8%BE%BE"><span class="toc-number">2.1.</span> <span class="toc-text">形式化表达</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">问题分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BB%E6%96%B9%E7%A8%8B"><span class="toc-number">2.3.</span> <span class="toc-text">状态转移方程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%AA%E4%BB%A3%E7%A0%81%E4%B8%8E%E5%A4%8D%E6%9D%82%E5%BA%A6"><span class="toc-number">2.4.</span> <span class="toc-text">伪代码与复杂度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%8E%E7%BC%96%E7%A8%8B"><span class="toc-number">2.5.</span> <span class="toc-text">实例与编程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">最小生成树|Minimum Spanning Tree,MST</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="toc-number">3.1.</span> <span class="toc-text">生成树的性质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prim%E7%AE%97%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text">Prim算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BC%AA%E7%A0%81"><span class="toc-number">3.2.1.</span> <span class="toc-text">算法伪码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E6%80%A7%E8%AF%81%E6%98%8E-2"><span class="toc-number">3.2.2.</span> <span class="toc-text">正确性证明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0-2"><span class="toc-number">3.2.3.</span> <span class="toc-text">编程实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kruskal%E7%AE%97%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text">Kruskal算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BC%AA%E7%A0%81-2"><span class="toc-number">3.3.0.1.</span> <span class="toc-text">算法伪码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E7%A1%AE%E6%80%A7%E8%AF%81%E6%98%8E-3"><span class="toc-number">3.3.1.</span> <span class="toc-text">正确性证明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0-3"><span class="toc-number">3.3.2.</span> <span class="toc-text">编程实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">3.4.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/d3d469f8/" title="Docker - 一步到位的应用部署与上线"><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/docker.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Docker - 一步到位的应用部署与上线"></a><div class="content"><a class="title" href="/posts/d3d469f8/" title="Docker - 一步到位的应用部署与上线">Docker - 一步到位的应用部署与上线</a><time datetime="2024-03-05T07:11:45.000Z" title="发表于 2024-03-05 15:11:45">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c1bb1ae1/" title="GFS - 谷歌的分布式文件存储系统"><img src="http://img.49you.com/20170303/58b8d6f32d651.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="GFS - 谷歌的分布式文件存储系统"></a><div class="content"><a class="title" href="/posts/c1bb1ae1/" title="GFS - 谷歌的分布式文件存储系统">GFS - 谷歌的分布式文件存储系统</a><time datetime="2024-03-05T04:04:07.000Z" title="发表于 2024-03-05 12:04:07">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f21b6bc8/" title="HuskyLab Servers 0x519 操作指南【自用】"><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/husklab_bg.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="HuskyLab Servers 0x519 操作指南【自用】"></a><div class="content"><a class="title" href="/posts/f21b6bc8/" title="HuskyLab Servers 0x519 操作指南【自用】">HuskyLab Servers 0x519 操作指南【自用】</a><time datetime="2024-03-04T13:29:31.000Z" title="发表于 2024-03-04 21:29:31">2024-03-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f7dae821/" title="【快速入门】集群资源管理调度系统 - Slurm"><img src="https://gitee.com/sliewdy/ImageURL-slie/raw/master/imagesNoT/QQ%E5%9B%BE%E7%89%8720210414005713.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="【快速入门】集群资源管理调度系统 - Slurm"></a><div class="content"><a class="title" href="/posts/f7dae821/" title="【快速入门】集群资源管理调度系统 - Slurm">【快速入门】集群资源管理调度系统 - Slurm</a><time datetime="2024-03-04T12:50:38.000Z" title="发表于 2024-03-04 20:50:38">2024-03-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/8cb817a9/" title="【最优化】Levenberg-Marquardt 算法"><img src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/202401051550627.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="【最优化】Levenberg-Marquardt 算法"></a><div class="content"><a class="title" href="/posts/8cb817a9/" title="【最优化】Levenberg-Marquardt 算法">【最优化】Levenberg-Marquardt 算法</a><time datetime="2023-12-22T03:07:39.000Z" title="发表于 2023-12-22 11:07:39">2023-12-22</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url('https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/MST_Sample.png')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By Slie</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Welcome to Chaos World!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/pluginsSrc/medium-zoom/dist/medium-zoom.min.js"></script><script src="/pluginsSrc/instant.page/instantpage.js" type="module"></script><script src="/pluginsSrc/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("/pluginsSrc/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><link rel="stylesheet" href="/pluginsSrc/katex/dist/katex.min.css"><script src="/pluginsSrc/katex/dist/contrib/copy-tex.min.js"></script><script>document.querySelectorAll("#article-container span.katex-display").forEach((a=>{btf.wrap(a,"div",{class:"katex-wrap"})}))</script><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then((({svg:e})=>{d.insertAdjacentHTML("afterend",e)}))}))},n=()=>{window.loadMermaid?t():getScript("/pluginsSrc/mermaid/dist/mermaid.min.js").then(t)};btf.addModeChange("mermaid",t),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.qslie.top/",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://twikoo.qslie.top/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.textContent=o[0].count})).catch((function(t){console.error(t)}))})()},o=()=>{"object"!=typeof twikoo?getScript("/pluginsSrc/twikoo/dist/twikoo.all.min.js").then(t):setTimeout(t,0)};btf.loadComment(document.getElementById("twikoo-wrap"),o)})()</script></div><script async src="/js/diytitle.js"></script><script async src="//at.alicdn.com/t/font_2264842_3izu8i5eoc2.js"></script><script async src="/js/diytitle.js"></script><script data-pjax defer src="/js/fixed_comment.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="/pluginsSrc/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="/pluginsSrc/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"===location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/算法/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 算法相关，编程实现 (60)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/故事/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 杂谈日志，光影记录 (6)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/日常/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">💡 记忆碎片，梦境显影 (36)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://qslie.top/tags/机器学习/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">💻 机器学习，数学规划 (35)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://qslie.top/tags" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';console.log("已挂载magnet"),parent.insertAdjacentHTML("afterbegin",child)}</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(50% - 5px);background:#f2f2f2;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:#b30070}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style><script data-pjax>function butterfly_swiper_injector_config(){var s=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),s.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/4f5fd499/" alt=""><img width="48" height="48" src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main//Auto/20231030204417.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/4f5fd499/" alt="">Deep Neural Net | 多层感知机与神经网络入门</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="posts/4f5fd499/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/9a95977b/" alt=""><img width="48" height="48" src="math-cover.jfif" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/9a95977b/" alt="">SLie的&quot;数学基础&quot;集装箱|Perhaps.Ver1.04</a><div class="blog-slider__text">好了，你已经学会1+1=2了，下面来证明一下广义黎曼猜想吧~</div><a class="blog-slider__button" href="posts/9a95977b/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/4ea9ab3c/" alt=""><img width="48" height="48" src="https://jsd.onmicrosoft.cn/gh/SlieFamily/TempImages@main/Auto/202202232045587.jpeg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/4ea9ab3c/" alt="">算法分析与设计 &amp; 本站算法综述</a><div class="blog-slider__text">本文罗列了常见的经典问题和算法，以及主要的算法分析方法和设计方法</div><a class="blog-slider__button" href="posts/4ea9ab3c/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/5ebaa4d9/" alt=""><img width="48" height="48" src="https://gitee.com/sliewdy/ImageURL-slie/raw/master/imagesNoT/QQ%E5%9B%BE%E7%89%8720210414005713.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-11</span><a class="blog-slider__title" href="posts/5ebaa4d9/" alt="">捣鼓程序时的各种【踩坑】【报错】全收录</a><div class="blog-slider__text">配置环境、安装库包等网上冲浪时遇见到的各式各样奇奇怪怪的Warning和Error，以及各种治标不治本或者又治标又治本的解决方案全记录（个人向）</div><a class="blog-slider__button" href="posts/5ebaa4d9/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="/",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script></body></html>